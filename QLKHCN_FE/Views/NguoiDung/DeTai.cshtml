@{
  ViewBag.Title = "Đề Tài";
  Layout = "~/Views/Shared/_LayoutUserPage.cshtml";
}

@{
  // Xác định năm học bắt đầu và năm học hiện tại
  int startYear = 2022;
  int currentYear = DateTime.Now.Year;

  // Tạo danh sách năm học
  var years = new List<dynamic>();
  for (int year = startYear; year <= currentYear; year++)
  {
    string nextYear = (year + 1).ToString();
    // add list
    years.Add(new
    {
      Year = $"{year}-07-01 00:00:00.0000000",
      YearOption = $"{year} - {nextYear}"
    });
  }

  // Đảo ngược danh sách
  years.Reverse();

  // Xác định năm học hiện tại
  string currentYearOption = DateTime.Now.Month < 9 ? $"{currentYear - 1} - {currentYear}" : $"{currentYear} - {currentYear + 1}";
}

<head>
  <link href="~/Content/toastr.min.css" rel="stylesheet" />
  <link href="~/Content/toastr.css" rel="stylesheet" />
  <style>
    #timeline {
      width: 200px;
      padding: 10px;
      border: none;
      background-color: #f2f2f2;
      color: #333;
      font-size: 16px;
      border-radius: 5px;
      outline: none;
      transition: box-shadow 0.3s;
      margin-left: 5%;
    }

      #timeline:hover {
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
      }

      #timeline:focus {
        box-shadow: 0 0 8px rgba(0, 0, 0, 0.5);
      }

      #timeline::after {
        content: "";
        position: absolute;
        top: 50%;
        right: 10px;
        width: 0;
        height: 0;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-top: 5px solid #333;
        transform: translateY(-50%);
        pointer-events: none;
      }

    .notification {
      display: flex;
      align-items: center;
      background-color: #f8f8f8;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
      padding: 12px;
      box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
    }

    .notification-icon {
      margin-right: 12px;
      font-size: 24px;
      color: #3276b1;
    }

    .notification-content {
      flex: 1;
    }

    .notification-title {
      margin: 0;
      font-size: 16px;
      font-weight: bold;
      color: #333;
    }

    .notification-message {
      margin: 0;
      font-size: 14px;
      color: #777;
    }
  </style>
</head>


<style>
  input[readonly] {
    background-color: #f8f8f8; /* Màu nền chỉ đọc */
    cursor: not-allowed; /* Biểu tượng con trỏ chỉ đọc */
  }
</style>

<div class="all">
  <div class="card">
    <div class="card-header">
      <h3 class="card-title">SẢN PHẨM KHOA HỌC CÔNG NGHỆ</h3>
    </div>

    <!-- /.card-header -->
    <div class="card-header">
      <div class="col-md-12 d-flex justify-content-between">
        @*<input class="btn btn-success btn-sm " id="signdt" type="submit" value="KÊ KHAI KHỐI LƯỢNG NCKH" onclick="location.href='/Article/Index'">*@
        <button type="button" class="btn btn btn-success" id="create" data-toggle="modal" data-target="#modal-xl-create" data-backdrop="static">THÊM MỚI</button>
        <select id="timeline">
          @foreach (var year in years)
          {
            <option value="@year.Year" @(year.YearOption == currentYearOption ? "selected" : "")>@year.YearOption</option>
          }
        </select>
        <input id="iddmxd" type="hidden" />
        <div class="btn-group">
          <button type="button" class="btn btn btn-warning dropdown-toggle dropdown-icon" data-toggle="dropdown" aria-expanded="false">
            <span>EXPORT EXCEL</span>
          </button>

          <div class="dropdown-menu" role="menu" style="">
            <a class="dropdown-item" onclick="ExportToExcelDeTaiUser(1)" href="#">Nhóm Nghiên Cứu Mạnh</a>
            <a class="dropdown-item" onclick="ExportToExcelDeTaiUser(2)" href="#">Khoa/Viện</a>
            <a class="dropdown-item" onclick="ExportToExcelDeTaiUser(3)" href="#">Trường</a>
            <a class="dropdown-item" onclick="ExportToExcelDeTaiUser(4)" href="#">Nghiên Cứu Viên</a>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-12">
      <p class="text-danger mb-0 "></p>
    </div>

    <div class="card-body">
      <table id="example1" class="table table-bordered table-striped ">
        <thead style="background-color: #007bff; color: white">
          <tr>
            <th>STT</th>
            <th>Tên công trình</th>
            <th>Tên tạp chí/NXB</th>
            <th>Đóng góp</th>
            <th>Thù lao</th>
            <th>Tiết Chuẩn</th>
            <th>Điểm</th>
            <th>Ghi chú</th>
            <th>Trạng thái</th>
            <th colspan="2"></th>
          </tr>
        </thead>
        <tbody>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="4" style="text-align:right">
              Tổng
            </td>
            <td id="tongTien"></td>
            <td id="tongTietChuan"></td>
            <td id="tongDiem"></td>
            <td colspan="4"></td>
          </tr>
        </tfoot>
      </table>
    </div>
    <!-- /.card-body -->
  </div>
</div>

<div class="modal fade" id="modal-xl" data-backdrop="static">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-body">
        <ul class="nav nav-tabs" id="custom-content-above-tab" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="custom-content-above-home-tab" data-toggle="pill" href="#custom-content-above-home" role="tab" aria-controls="custom-content-above-home" aria-selected="true">Thông tin</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="custom-content-above-profile-tab" data-toggle="pill" href="#custom-content-above-profile" role="tab" aria-controls="custom-content-above-profile" aria-selected="false">Tác giả</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="custom-content-above-messages-tab" data-toggle="pill" href="#custom-content-above-messages" role="tab" aria-controls="custom-content-above-messages" aria-selected="false">Minh Chứng</a>
          </li>
        </ul>
        <div class="tab-content" id="custom-content-above-tabContent">
          <div class="tab-pane fade show active" id="custom-content-above-home" role="tabpanel" aria-labelledby="custom-content-above-home-tab">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">THÔNG TIN ĐĂNG KÝ BÀI BÁO</h3>
              </div>
              <form>
                <div class="card-body">
                  <div class="row">
                    <div class="col-6">
                      <input type="hidden" class="form-control" id="idDanhMuc">
                      <div class="form-group">
                        <label for="tenBaiBao">Tên bài báo</label>
                        <input type="text" class="form-control" disabled id="tenBaiBao">
                      </div>
                      <div class="form-group">
                        <label for="type">type</label>
                        <input type="text" class="form-control" disabled id="type">
                      </div>
                      <div class="form-group">
                        <label for="issn">issn</label>
                        <input type="text" class="form-control" disabled id="issn">
                      </div>
                      <div class="form-group">
                        <label for="eissn">eissn</label>
                        <input type="text" class="form-control" disabled id="eissn">
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="form-group">
                        <label for="rank">rank</label>
                        <select class="custom-select" id="rank" disabled>
                          <option value="GV">Giảng viên</option>
                          <option value="NCV">Nghiên cứu viên</option>
                        </select>
                      </div>
                      <div class="form-group">
                        <label for="total">total</label>
                        <input type="text" class="form-control" disabled id="total2">
                      </div>
                      <div class="form-group">
                        <label for="dateSubmit">Ngày gửi</label>
                        <input type="datetime" class="form-control" id="dateSubmit" disabled>
                      </div>
                      <div class="form-group" id="status-quyen">
                        <label for="status">Status</label>
                        <input type="text" class="form-control" disabled id="status">
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-12">
                      <div class="form-group">
                        <label for="ghiChu">Ghi chú</label>
                        <textarea type="text" class="form-control" disabled id="ghiChu"></textarea>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
          <div class="tab-pane fade" id="custom-content-above-profile" role="tabpanel" aria-labelledby="custom-content-above-profile-tab">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">KÊ KHAI TÁC GIẢ</h3>
              </div>
              <div class="card-body">
                <table id="tbtacgia" class="table table-bordered table-striped">
                  <thead>
                    <tr>
                      <th>Stt</th>
                      <th>MaNV - Họ tên</th>
                      <th>Cơ quan công tác</th>
                      <th>Loại tác giả</th>
                      <th>Tổng nhận trước thuế</th>
                      <th>Thực nhận</th>
                      <th>Điểm</th>
                      <th>Tiết chuẩn</th>
                    </tr>
                  </thead>
                  <tbody>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="custom-content-above-messages" role="tabpanel" aria-labelledby="custom-content-above-messages-tab">
            <div class="card">
              <div class="card-header">
                <h3 class="card-title">MINH CHỨNG</h3>
              </div>
              <form>
                <div class="card-body">
                  <div class="form-group">
                    <label>Số DOI: </label>
                    <a href="#" target="_blank" id="link">#</a>
                  </div>

                  <div class="form-group">
                    <label for="image">Ảnh: </label>
                    <div id="image"></div>
                    <div id="file"></div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer justify-content-between">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="modal-xl-create">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-body">
        <div class="card card-default">
          <div class="card-header">
            <h3 class="card-title">KÊ KHAI KHỐI LƯỢNG NGHIÊN CỨU KHOA HỌC</h3>
          </div>
          <div class="card-body p-0">
            <div class="bs-stepper" id="myStepper">
              <div class="bs-stepper-header" role="tablist">
                <!-- your steps here -->
                <div class="step" data-target="#logins-part">
                  <button type="button" class="step-trigger" role="tab" aria-controls="logins-part" id="logins-part-trigger">
                    <span class="bs-stepper-circle">1</span>
                    <span class="bs-stepper-label">Thông tin sản phẩm</span>
                  </button>
                </div>
                <div class="line"></div>
                <div class="step" data-target="#information-part">
                  <button type="button" class="step-trigger" role="tab" aria-controls="information-part" id="information-part-trigger">
                    <span class="bs-stepper-circle">2</span>
                    <span class="bs-stepper-label">Nhập thông tin tác giả</span>
                  </button>
                </div>
              </div>
              <div class="bs-stepper-content">
                <!-- your steps content here -->
                <div id="logins-part" class="content" role="tabpanel" aria-labelledby="logins-part-trigger">
                  <div class="form-group row">
                    <label class="col-form-label" for="tenSanPhamKHCN">Tên sản phẩm KHCN*:</label>
                    <input type="text" class="form-control col" id="tenSanPhamKHCN" placeholder="Tạp chí, bài báo, sách, kỷ yếu..." style="margin-left:2%">
                  </div>
                  <div class="row">
                    <div class="form-group col row">
                      <label class="col-form-label" for="ngayCongBo">Ngày công bố*</label>
                      <input id="datesubmit" type="date" placeholder="Ngày đăng bài" class="form-control col" style="margin-left:6%" />
                    </div>
                    <div class="form-group col row" style="margin-left:2%">
                      <label class="col-form-label" for="sodoi">Số DOI:</label>
                      <input type="text" class="form-control col" id="sodoi" placeholder="Nhập số DOI" style="margin-left:6%">
                    </div>
                    <div class="form-group col row" style="margin-left:2%">
                      <input type="file" class="form-control col-7" id="fileInput" multiple onchange="handleFileSelect(event)" />
                    </div>
                  </div>
                  <div id="uploadedFiles" class="row mt-1">
                    <!-- Danh sách các file đã upload thành công sẽ hiển thị tại đây -->
                  </div>
                  <div class="row">
                    <div class="form-group col-10 row">
                      <div class="form-check col">
                        <input class="form-check-input" type="radio" id="btn_Cissn" name="radioIssn" value="Cissn" onclick="click_radioIssn()">
                        <label for="btn_Cissn" class="form-check-label">Bài báo thuộc WoS, Scopus và HĐCDGSNN</label>
                      </div>
                      <div class="form-check col">
                        <input class="form-check-input" type="radio" id="btn_Kissn" name="radioIssn" value="Kissn" onclick="click_radioIssn()">
                        <label for="btn_Kissn" class="form-check-label">Các loại sản phẩm khác (sách, kỷ yếu, giải thưởng, seminar...)</label>
                      </div>
                    </div>
                  </div>
                  <div class="form-group row" id="input_issn" style="display:none">
                    <label class="col-form-label" for="traCuuIssn">Tra cứu danh mục tạp chí*</label>
                    <input type="text" class="form-control col" onblur="clickinp()" id="traCuuIssn" placeholder="Nhập mã ISSN để tra cứu" style="margin-left:2%">

                  </div>
                  <div id="isIssn" style="display:none;font-weight: bold;">
                  </div>

                  <div class="row" id="choose_lh" style="display:none">
                    <div class="form-group col row">
                      <label class="col-form-label" for="traCuuIssn">Chọn loại hình kê khai</label>
                      <select class="custom-select col-4" id="loaiHinhKeKhai" style="margin-left:4%">
                        <option value="KKKL" selected>Kê khai khối lượng</option>
                        <option value="NCM">Nghiên cứu mạnh</option>
                        <option value="DT">Đề tài</option>
                      </select>
                    </div>
                    <div class="col" id="chonLoaiCongTrinh" style="display:none">
                    </div>
                    <div class="col" id="trangthaithanhtoan"></div>
                  </div>

                  <div id="noIssn" style="display:none">
                  </div>
                  <div id="ketqua" style="display:none">
                  </div>
                  <div class="row" style="display: flex; justify-content: flex-end;">
                    <button class="btn btn-success" onclick="check_result()">TIẾP TỤC</button>
                  </div>
                </div>

                <div id="information-part" class="content" role="tabpanel" aria-labelledby="information-part-trigger">
                  <div class="row">
                    <div class="form-group col-3 row">
                      <label class="col-form-label" for="sltgc">Tác giả đầu</label>
                      <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng tác giả chính" id="sltgc" disabled value="1" min="1" max="1" oninput="clear_hinhthuc()" />
                    </div>
                    <div class="form-group col row" style="margin-left:2%">
                      <label class="col-form-label" for="sltgp">Số lượng tác giả phụ</label>
                      <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng tác giả phụ" id="sltgp" min="1" oninput="clear_hinhthuc()" />
                    </div>
                    <div class="form-group col row" style="margin-left:2%">
                      <label class="col-form-label" for="sltglh">Số lượng tác giả liên hệ</label>
                      <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng tác giả liên hệ" id="sltglh" min="1" oninput="clear_hinhthuc()" />
                    </div>
                  </div>

                  <div class="form-group col-2" id="tongtacgia">
                  </div>
                  <div class="card">
                    <div class="card-header">
                      <h3 class="card-title">THÔNG TIN TÁC GIẢ</h3>
                    </div>
                    @*Ban dt*@
                    <div class="table-container">

                      <table class="table table-bordered table-striped" style="width:100%" id="tbtacgiasl">
                        <tbody id="addtacgiasl2" onchange="loadtable()">
                        </tbody>
                      </table>
                    </div>
                    <div class="table-container">
                      <table class="table table-bordered table-striped" style="width:100%" id="tbtacgia2">
                        <tbody id="addtacgia" onchange="loadtable()">
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <button class="btn btn-success" onclick="stepperPrevious()">VỀ TRƯỚC</button>
                  <!--<input class="btn btn-info" id="inpsearchs" type="submit" value="Xác nhận gửi" onclick="handleSend()" style="margin-left:2%">-->
                </div>
              </div>
            </div>
          </div>
          <!-- /.card-body -->
        </div>
        <div class="modal-footer justify-content-between">
          @*<a class="btn btn-outline-danger" href="@Url.Action("DeTai","NguoiDung")">THOÁT</a>*@
          @* Sử dụng sự kiện đóng modal và reset form thay vì reload lại trang *@
          <button class="btn btn-outline-danger" data-dismiss="modal">ĐÓNG</button>
          <button type="button" class="btn btn btn-primary" id="btn-lvt" style="display: none; margin-left:-62%" onclick="handleSend('lvt')">LƯU VÀ ĐÓNG</button>
          <button type="button" class="btn btn btn-primary" id="btn-lvtm" style="display: none" onclick="luuVaThemMoi()">LƯU VÀ THÊM MỚI</button>
        </div>
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>

<style>
  div[class^="col"].file-item {
    position: relative;
    padding: 10px;
    background: #f5f5f5;
    border: 2px solid white;
  }

  .table-container {
    max-height: 300px; /* Đặt chiều cao tối đa của khu vực cuộn */
    overflow-y: auto; /* Cho phép cuộn dọc khi nội dung vượt quá kích thước */
    overflow-x: auto;
  }

  #tbtacgiasl {
    width: 100%; /* Đảm bảo bảng rộng 100% trong khu vực cuộn */
    /* Thêm các định dạng CSS khác cho bảng */
  }
</style>
<script>
    function loadtable() {
        var sltgc = Number(document.querySelector('#sltgc').value);
        var sltgp = Number(document.querySelector('#sltgp').value);
        var sltglh = Number(document.querySelector('#sltglh').value);

        var sltg = sltgc + sltgp + sltglh;
        try {
            var tietchuan = Number(document.querySelector('#tietchuan').textContent);

        } catch {
            toastr.warning("Chọn hình thức thanh toán!");
        }
        try {
            var diem = Number(document.querySelector('#diem').textContent);
        } catch { }
        var table = document.getElementById("tablethanhtoan");
        var trtable = ``;
        try {
            var optionshdsv = document.querySelector('#loaiCongTrinh');
            var hdsv = optionshdsv.options[optionshdsv.selectedIndex].value;
        } catch { }
        try {
            var total = Number(document.querySelector('#totaltien').textContent);

        } catch {
            var total = 0;
        }
        var tongdonggop = 0;
        var valuerank = _ngach;
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
        for (let j = 0; j < sltg; j++) {
            try {
                var donggop = Number(document.querySelector('#donggop-' + j).value);

            } catch { }
            tongdonggop += donggop;
            if (tongdonggop > 100) {

                try { document.querySelector('#donggop-' + j).value = 0; } catch { }
            }

        }
        if (tongdonggop > 100) {
            toastr.warning('Đóng góp quá 100%!');
        } else {
            if (valuerank.includes("GV") && valueloaihinh.includes("Kê khai khối lượng")) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltgc == 1 && sltgp > 0 && sltglh == 0) {
                    if (sltgc == 1 && sltgp > 0 && sltglh == 0) {
                        for (let i = 0; i < sltg; i++) {
                            var coquan = table.rows[0].cells[2].textContent;
                            try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }
                            if (sltg > 1) {
                                if (coquan.includes("Quốc tế - Hutech (0%)") || coquan.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || coquan.includes(" --Chọn cơ quan công tác--")) {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `0`;
                                    table.rows[0].cells[7].innerHTML = `0`;
                                    if (table.rows[i].cells[2].textContent.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;

                                        }

                                    } if (table.rows[i].cells[2].textContent.includes("Hutech-Quốc tế (50%)")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent.includes("Quốc tế - Hutech (0%)") || table.rows[i].cells[2].textContent.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || table.rows[i].cells[2].textContent.includes(" --Chọn cơ quan công tác--")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                } if (coquan.includes("Hutech-Quốc tế (50%)")) {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[0].cells[7].innerHTML = `${tietchuan / 2 * 0.8}`;
                                    }
                                    if (table.rows[i].cells[2].textContent.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent.includes("Hutech-Quốc tế (50%)")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent.includes("Quốc tế - Hutech (0%)") || table.rows[i].cells[2].textContent.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || table.rows[i].cells[2].textContent.includes(" --Chọn cơ quan công tác--")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                } else if (coquan.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[0].cells[7].innerHTML = `${tietchuan * 0.8}`;
                                    }
                                    if (table.rows[i].cells[2].textContent.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent.includes("Hutech-Quốc tế (50%)")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent.includes("Quốc tế - Hutech (0%)") || table.rows[i].cells[2].textContent.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || table.rows[i].cells[2].textContent.includes(" --Chọn cơ quan công tác--")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                }
                            }
                        }

                    }
                }
                if (sltgc == 1 && sltgp == 0 && sltglh > 0) {
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[0].cells[2].textContent;
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }
                        if (sltg > 1) {
                            if (coquan.includes("Quốc tế - Hutech (0%)") || coquan.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || coquan.includes(" --Chọn cơ quan công tác--")) {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                if (table.rows[i].cells[2].textContent.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent.includes("Hutech-Quốc tế (50%)")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent.includes("Quốc tế - Hutech (0%)") || table.rows[i].cells[2].textContent.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || table.rows[i].cells[2].textContent.includes(" --Chọn cơ quan công tác--")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            } if (coquan.includes("Hutech-Quốc tế (50%)")) {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan / sltg * 0.5}`;
                                }
                                if (table.rows[i].cells[2].textContent.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    }
                                } if (table.rows[i].cells[2].textContent.includes("Hutech-Quốc tế (50%)")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    }
                                } if (table.rows[i].cells[2].textContent.includes("Quốc tế - Hutech (0%)") || table.rows[i].cells[2].textContent.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || table.rows[i].cells[2].textContent.includes(" --Chọn cơ quan công tác--")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            } else if (coquan.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan / sltg}`;
                                }
                                if (table.rows[i].cells[2].textContent.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    }
                                } if (table.rows[i].cells[2].textContent.includes("Hutech-Quốc tế (50%)")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    }
                                } if (table.rows[i].cells[2].textContent.includes("Quốc tế - Hutech (0%)") || table.rows[i].cells[2].textContent.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || table.rows[i].cells[2].textContent.includes(" --Chọn cơ quan công tác--")) {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            }
                        }
                    }
                }

                else if (sltg > 2 && (sltgc + sltglh) > 1 && sltgp > 0) {
                    for (let i = 0; i < sltg; i++) {
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }

                        var coquan = table.rows[i].cells[2].textContent;
                        var optionstg1 = document.querySelector('#tg-' + i);
                        try { var texttg1 = optionstg1.options[optionstg1.selectedIndex].textContent; } catch { }

                        if (coquan.includes("Quốc tế - Hutech (0%)") || coquan.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || coquan.includes(" --Chọn cơ quan công tác--")) {
                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            table.rows[i].cells[6].innerHTML = `0`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        } else if (coquan.includes("Hutech-Quốc tế (50%)")) {
                            if (texttg1 == ("Tác giả chính") || texttg1 == ("Chủ nhiệm") || texttg1 == ("Báo cáo viên") || texttg1 == ("GVHD")) {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${(((tietchuan * 0.8) / (sltgc + sltglh))) / 2}`;
                                }

                            } else if (texttg1 == ("Tác giả phụ") || texttg1 == ("Thành viên") || texttg1 == ("Sinh viên")) {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${(tietchuan * 0.2) / 2 / sltgp}`;
                                }
                            } else if (texttg1 == ("Tác giả liên hệ") || texttg1 == ("Đồng chủ nhiệm") || texttg1 == ("Đồng GVHD")) {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${(tietchuan * 0.8) / 2 / (sltgc + sltglh)}`;
                                }
                            }

                        } else if (coquan.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                            if (texttg1 == ("Tác giả chính") || texttg1 == ("Chủ nhiệm") || texttg1 == ("Báo cáo viên") || texttg1 == ("GVHD")) {
                                table.rows[i].cells[4].innerHTML = `${(((total * 0.75) / (sltgc + sltglh)))}`;
                                table.rows[i].cells[5].innerHTML = `${(((total * 0.75) / (sltgc + sltglh))) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${(((tietchuan * 0.8) / (sltgc + sltglh)))}`;
                                }
                            } else if (texttg1 == ("Tác giả phụ") || texttg1 == ("Thành viên") || texttg1 == ("Sinh viên")) {
                                table.rows[i].cells[4].innerHTML = `${total * 0.25 / sltgp}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.25) / sltgp) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`; if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;
                                }
                            } else if (texttg1 == ("Tác giả liên hệ") || texttg1 == ("Đồng chủ nhiệm") || texttg1 == ("Đồng GVHD")) {
                                table.rows[i].cells[4].innerHTML = `${((total * 0.75) / (sltgc + sltglh))}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.75) / (sltgc + sltglh)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${((tietchuan * 0.8) / (sltgc + sltglh))}`;
                                }
                            }
                        }

                    }
                }

                if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan.includes("Quốc tế - Hutech (0%)") || coquan.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || coquan.includes(" --Chọn cơ quan công tác--")) {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan.includes("Hutech-Quốc tế (50%)")) {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        if (hdsv == "HDSV") {
                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                        } else {
                            table.rows[0].cells[7].innerHTML = `${tietchuan / 2}`;
                        }
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        if (hdsv == "HDSV") {
                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                        } else {
                            table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                        }
                    }
                }
            }
            if (valuerank.includes("NCV") && valueloaihinh.includes("Kê khai khối lượng")) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltgc == 1 && sltgp > 0 && sltglh == 0) {
                    if (sltgc == 1 && sltgp > 0 && sltglh == 0) {
                        for (let i = 0; i < sltg; i++) {
                            var coquan = table.rows[0].cells[2].textContent;
                            try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }
                            if (sltg > 1) {
                                if (coquan.includes("Quốc tế - Hutech (0%)") || coquan.includes("Cơ quan công tác trong nước - ngoài Hutech (0%)") || coquan.includes(" --Chọn cơ quan công tác--")) {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `0`;
                                    table.rows[0].cells[7].innerHTML = `0`;
                                    if (table.rows[i].cells[2].textContent.includes("Cơ quan công tác duy nhất Hutech (100%)")) {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.25 / sltgp}`;

                                        }

                                    } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.25 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                } if (coquan == "Hutech-Quốc tế (50%)") {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[0].cells[7].innerHTML = `${tietchuan / 2 * 0.8}`;
                                    }
                                    if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[0].cells[7].innerHTML = `${tietchuan * 0.8}`;
                                    }
                                    if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                }
                            }
                        }

                    }
                }
                if (sltgc == 1 && sltgp == 0 && sltglh > 0) {
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[0].cells[2].textContent;
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }
                        if (sltg > 1) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan / 2 * 0.5}`;
                                }
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan * 0.5}`;
                                }
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            }
                        }
                    }
                }
                else if (sltg == 3 && sltgp == 1 && sltglh == 1) {
                    for (let i = 0; i < sltg; i++) {
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }

                        var coquan = table.rows[0].cells[2].textContent;
                        var optionstg1 = document.querySelector('#tg-' + i);
                        try { var texttg1 = optionstg1.options[optionstg1.selectedIndex].textContent; } catch { }

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            table.rows[0].cells[6].innerHTML = `0`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[1].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            }
                            else if (table.rows[1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[1].cells[7].innerHTML = `${tietchuan * 0.25 / 2}`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            } else if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[1].cells[7].innerHTML = `${tietchuan * 0.25}`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            }

                        }
                        else if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `${tietchuan / 2 / 2}`;
                            if (table.rows[1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[1].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2 / 2}`;
                                    break;
                                } else {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[0].cells[7].innerHTML = `${tietchuan / 2}`;

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            }
                            else if (table.rows[1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[1].cells[7].innerHTML = `${tietchuan * 0.25 / 2}`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2 / 2}`;
                                    break;
                                } else {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            } else if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[1].cells[7].innerHTML = `${tietchuan * 0.25}`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2 / 2}`;
                                    break;
                                } else {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            }

                        }
                        else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `${tietchuan / 2}`;
                            if (table.rows[1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[1].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2 / 2}`;
                                    break;
                                } else {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[0].cells[7].innerHTML = `${tietchuan}`;

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            }
                            else if (table.rows[1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[1].cells[7].innerHTML = `${tietchuan * 0.25 / 2}`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2 / 2}`;
                                    break;
                                } else {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[0].cells[7].innerHTML = `${tietchuan}`;

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            }
                            else if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[1].cells[7].innerHTML = `${tietchuan * 0.25}`;
                                if (table.rows[2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else if (table.rows[2].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[2].cells[7].innerHTML = `${tietchuan / 2}`;
                                    break;
                                } else {

                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                                    table.rows[2].cells[4].innerHTML = `0`;
                                    table.rows[2].cells[5].innerHTML = `0`;
                                    table.rows[2].cells[6].innerHTML = `0`;
                                    table.rows[2].cells[7].innerHTML = `0`;
                                    break;
                                }
                            }
                        }

                    }
                }
                else if (sltg > 3 && sltgp > 1 && sltglh == 1) {

                    for (let i = 0; i < sltg; i++) {
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }

                        var coquan = table.rows[0].cells[2].textContent;
                        var optionstg1 = document.querySelector('#tg-' + i);
                        try { var texttg1 = optionstg1.options[optionstg1.selectedIndex].textContent; } catch { }

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            table.rows[0].cells[6].innerHTML = `0`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var sltgphutech = 0;
                            for (let j = 1; j < (sltgp + 1); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    sltgphutech += 1;
                                }
                            }
                            for (let k = 1; k < (sltgp + 1); k++) {
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[k].cells[7].innerHTML = `${tietchuan * 0.25 / sltgphutech}`;
                                } else if (table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[k].cells[7].innerHTML = `${tietchuan * 0.25 / 2 / sltgphutech}`;
                                } else {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `0`;
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                            }
                            if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[sltg - 1].cells[7].innerHTML = `${tietchuan}`;
                            } else if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[sltg - 1].cells[7].innerHTML = `${tietchuan / 2}`;
                            } else if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `0`;
                                table.rows[sltg - 1].cells[7].innerHTML = `0`;
                            }

                        }
                        else if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `${tietchuan / 2 / (sltgc + sltglh)}`;
                            var sltgphutech = 0;
                            for (let j = 1; j < (sltgp + 1); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    sltgphutech += 1;
                                }
                            }
                            for (let k = 1; k < (sltgp + 1); k++) {
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[k].cells[7].innerHTML = `${tietchuan * 0.25 / sltgphutech}`;
                                } else if (table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[k].cells[7].innerHTML = `${tietchuan * 0.25 / 2 / sltgphutech}`;
                                } else {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `0`;
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                            }
                            if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[sltg - 1].cells[7].innerHTML = `${tietchuan / (sltgc + sltglh)}`;
                            } else if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[sltg - 1].cells[7].innerHTML = `${tietchuan / 2 / (sltgc + sltglh)}`;
                            } else if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `${tietchuan / 2}`;
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `0`;
                                table.rows[sltg - 1].cells[7].innerHTML = `0`;
                            }

                        }
                        else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `${tietchuan / (sltgc + sltglh)}`;
                            var sltgphutech = 0;
                            for (let j = 1; j < (sltgp + 1); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    sltgphutech += 1;
                                }
                            }
                            for (let k = 1; k < (sltgp + 1); k++) {
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[k].cells[7].innerHTML = `${tietchuan * 0.25 / sltgphutech}`;
                                } else if (table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    table.rows[k].cells[7].innerHTML = `${tietchuan * 0.25 / 2 / sltgphutech}`;
                                } else {
                                    table.rows[k].cells[4].innerHTML = `0`;
                                    table.rows[k].cells[5].innerHTML = `0`;
                                    table.rows[k].cells[6].innerHTML = `0`;
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                            }
                            if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[sltg - 1].cells[7].innerHTML = `${tietchuan / (sltgc + sltglh)}`;
                            } else if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[sltg - 1].cells[7].innerHTML = `${tietchuan / 2 / (sltgc + sltglh)}`;
                            } else if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                                table.rows[sltg - 1].cells[4].innerHTML = `0`;
                                table.rows[sltg - 1].cells[5].innerHTML = `0`;
                                table.rows[sltg - 1].cells[6].innerHTML = `0`;
                                table.rows[sltg - 1].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }

                if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        if (hdsv == "HDSV") {
                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                        } else {
                            table.rows[0].cells[7].innerHTML = `${tietchuan / 2}`;
                        }
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        if (hdsv == "HDSV") {
                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                        } else {
                            table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, 1 tác giả liên hệ , 1 phụ
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc == 1 && sltglh == 1 && sltgp == 1 && sltg == 3) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                                    <td>${i + 1}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    /// tgc 0%
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[sltg - 1].cells[2].textContent != "Hutech-Quốc tế (50%)") {

                            // tgc 0, tglh 0, tgp 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 8 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 8 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;

                            }
                            // tgc 0, tglh 0, tgp 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            // tgc 0, tglh 0, tgp 0
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `0`;
                                table.rows[2].cells[5].innerHTML = `0`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            // tgc 0 tgp 50 tglh 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 100 thlh 50
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 0 thlh 50
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 0 tgp 50 thlh 100
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 100 thlh 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 0 thlh 100
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                    }
                    //tgc 50
                    if (texttgc == "Hutech-Quốc tế (50%)") {

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            // tgc 50, tglh 0, tgp 50
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `0`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            // tgc 50, tglh 0, tgp 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            // tgc 0, tglh 0, tgp 0
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            // tgc 0 tgp 50 tglh 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 100 thlh 50
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 0 thlh 50
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 0 tgp 50 thlh 100
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            }
                            //tgc 0 tgp 100 thlh 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 0 thlh 100
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                    }
                    //////tgc 100
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {

                        var donggop = document.querySelector('#donggop-' + i).value;
                        var donggoptgc = document.querySelector('#donggop-0').value;
                        table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[i].cells[7].innerHTML = `0`;
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[2].cells[7].innerHTML = `0`;
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            // tgc 100, tglh 0, tgp 50
                            table.rows[2].cells[6].innerHTML = `0`;
                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 100 tgp 50 thlh 100
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                        }
                        //// kiểm tra cơ quan tác giả phụ
                        if (table.rows[sltg - 2].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            table.rows[1].cells[6].innerHTML = `0`;
                        }
                        if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                        }
                        if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, 1 tác giả liên hệ
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc == 1 && sltglh == 1 && sltgp == 0 && sltg == 2) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                                    <td>${i + 1}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;

                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[1].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, >1 tác giả phụ
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 2 && sltgc == 1 && sltgp > 1 && sltglh == 0) {

                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltgp > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltgp > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltgp > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        var donggop = document.querySelector('#donggop-' + i).value;
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        if (sltgp > 1) {
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        } else {
                            table.rows[0].cells[6].innerHTML = `${diem}`;
                        }
                        table.rows[0].cells[7].innerHTML = `0`;

                        document.querySelector('#donggop-' + i).disabled = false;
                        var donggop = document.querySelector('#donggop-' + i).value;
                        table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;


                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggop = document.querySelector('#donggop-' + i).value;

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }

            ////// 1 tác giả chính, >1 tác giả phụ

            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 2 && sltgc == 1 && sltgp > 1 && sltglh == 0) {

                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltgp > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltgp > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltgp > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        var donggop = document.querySelector('#donggop-' + i).value;
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        if (sltgp > 1) {
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        } else {
                            table.rows[0].cells[6].innerHTML = `${diem}`;
                        }
                        table.rows[0].cells[7].innerHTML = `0`;

                        document.querySelector('#donggop-' + i).disabled = false;
                        var donggop = document.querySelector('#donggop-' + i).value;
                        table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;


                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggop = document.querySelector('#donggop-' + i).value;

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltgp > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }



            ////// 1 tác giả chính, >1 tác giả liên hệ


            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 2 && sltgc == 1 && sltgp == 0 && sltglh > 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }

                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;

                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 3 && sltgc == 1 && sltgp == 1 && sltglh > 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;

                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////// có 1 tác giả chính
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg == 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }

                for (let i = 0; i < sltg; i++) {

                    if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        table.rows[0].cells[4].innerHTML = `${((total))}`;
                        table.rows[0].cells[5].innerHTML = `${(((total))) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } else if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${((total / 2))}`;
                        table.rows[0].cells[5].innerHTML = `${(((total / 2))) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    }

                }

            }
            ///// 1 chính, 1 phụ
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg == 2 && sltgc == 1 && sltgp == 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltg == 2) {
                    for (let i = 0; i < sltg; i++) {

                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        var optionscongtac = document.querySelector('#coquancongtac-' + 0);
                        var coquan = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[0].cells[4].innerHTML = `${((total)) * 0.25 * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total)) * 0.25 * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `${((total)) * 0.25 * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total)) * 0.25 * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[1].cells[7].innerHTML = `0`;
                            } else if (table.rows[1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[0].cells[4].innerHTML = `${((total / 2)) * 0.25 * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total / 2)) * 0.25 * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `${((total / 2)) * 0.25 * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total / 2)) * 0.25 * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[1].cells[7].innerHTML = `0`;
                            } else if (table.rows[1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;

                            }

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[i].cells[4].innerHTML = `${((total / 2)) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${(((total / 2)) * (donggop / 100)) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            var donggoptgc = Number(document.querySelector('#donggop-0').value);

                            if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[4].innerHTML = `${((total)) * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total)) * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${((total)) * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total)) * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }

                        } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${((total)) * (donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }

                }
            }
            ///// nhiều hơn 3 tác giả: 1 chính, 1 phụ, 1 liên hệ

            ////
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc > 0 && sltglh == 1 && sltgp > 1 && sltg > 2) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                    for (let j = 0; j < sltg; j++) {
                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let k = 0; k < sltg; k++) {
                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                } else {
                                    table.rows[k].cells[6].innerHTML = `0`;
                                }
                                table.rows[k].cells[7].innerHTML = `0`;
                            }
                            break;
                        }
                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var coquanhutech = 0;
                            for (let g = (j + 1); g < sltg; g++) {
                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    coquanhutech += 1;
                                }
                            }
                            if (coquanhutech < 1) {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                        } else {
                            for (let j = 1; j < (sltg - sltglh); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 2; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let k = 0; k < sltg; k++) {

                                                table.rows[k].cells[4].innerHTML = `0`;
                                                table.rows[k].cells[5].innerHTML = `0`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                        }
                                    }
                                    break;
                                }

                            }
                        }
                    }
                }
                ////////////
                if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                    if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        for (let j = 0; j < sltg; j++) {
                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var coquanhutech = 0;
                                for (let g = (j + 1); g < sltg; g++) {
                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        coquanhutech += 1;
                                    }
                                }
                                if (coquanhutech < 1) {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                            } else {
                                for (let j = 1; j < (sltg - sltglh); j++) {
                                    if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                    if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        var coquanhutech = 0;
                                        for (let g = (j); g < sltg; g++) {
                                            if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                coquanhutech += 1;
                                            }
                                        }
                                        if (coquanhutech < 1) {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                    } else {
                                        for (let j = 2; j < (sltg - sltglh); j++) {
                                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                var coquanhutech = 0;
                                                for (let g = (j); g < sltg; g++) {
                                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                        coquanhutech += 1;
                                                    }
                                                }
                                                if (coquanhutech < 1) {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                            } else {
                                                for (let k = 0; k < sltg; k++) {

                                                    table.rows[k].cells[4].innerHTML = `0`;
                                                    table.rows[k].cells[5].innerHTML = `0`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                        if (table.rows[0].cells[sltg - 1].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let j = 0; j < sltg; j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j + 1); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 1; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let j = 2; j < (sltg - sltglh); j++) {
                                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    var coquanhutech = 0;
                                                    for (let g = (j); g < sltg; g++) {
                                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                            coquanhutech += 1;
                                                        }
                                                    }
                                                    if (coquanhutech < 1) {
                                                        for (let k = 0; k < sltg; k++) {
                                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                            } else {
                                                                table.rows[k].cells[6].innerHTML = `0`;
                                                            }
                                                            table.rows[k].cells[7].innerHTML = `0`;
                                                        }
                                                        break;
                                                    }
                                                } else {
                                                    for (let k = 0; k < sltg; k++) {

                                                        table.rows[k].cells[4].innerHTML = `0`;
                                                        table.rows[k].cells[5].innerHTML = `0`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                }
                                            }
                                            break;
                                        }

                                    }
                                }
                            }
                        }
                    }
                }

                ////////////
                if (table.rows[0].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[0].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                    if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        for (let j = 0; j < sltg; j++) {
                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var coquanhutech = 0;
                                for (let g = (j + 1); g < sltg; g++) {
                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        coquanhutech += 1;
                                    }
                                }
                                if (coquanhutech < 1) {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                            } else {
                                for (let j = 1; j < (sltg - sltglh); j++) {
                                    if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                    if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        var coquanhutech = 0;
                                        for (let g = (j); g < sltg; g++) {
                                            if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                coquanhutech += 1;
                                            }
                                        }
                                        if (coquanhutech < 1) {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                    } else {
                                        for (let j = 2; j < (sltg - sltglh); j++) {
                                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                var coquanhutech = 0;
                                                for (let g = (j); g < sltg; g++) {
                                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                        coquanhutech += 1;
                                                    }
                                                }
                                                if (coquanhutech < 1) {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                            } else {
                                                for (let k = 0; k < sltg; k++) {

                                                    table.rows[k].cells[4].innerHTML = `0`;
                                                    table.rows[k].cells[5].innerHTML = `0`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                        if (table.rows[0].cells[sltg - 1].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let j = 0; j < sltg; j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j + 1); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 1; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let j = 2; j < (sltg - sltglh); j++) {
                                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    var coquanhutech = 0;
                                                    for (let g = (j); g < sltg; g++) {
                                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                            coquanhutech += 1;
                                                        }
                                                    }
                                                    if (coquanhutech < 1) {
                                                        for (let k = 0; k < sltg; k++) {
                                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                            } else {
                                                                table.rows[k].cells[6].innerHTML = `0`;
                                                            }
                                                            table.rows[k].cells[7].innerHTML = `0`;
                                                        }
                                                        break;
                                                    }
                                                } else {
                                                    for (let k = 0; k < sltg; k++) {

                                                        table.rows[k].cells[4].innerHTML = `0`;
                                                        table.rows[k].cells[5].innerHTML = `0`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                }
                                            }
                                            break;
                                        }

                                    }
                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                        var hutech = 0;
                        var qt = 0;
                        var ngoai = 0;
                        for (let k = 1; k < sltg; k++) {
                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                hutech += 1;
                            }
                            if (table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                qt += 1;

                            } else {
                                ngoai += 1;
                            }

                        }
                        if (hutech > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[n].cells[5].innerHTML = `${total / 4 * donggop / 100 * 0.9}`;
                                table.rows[n].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        } else if (hutech == 0 && qt > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[n].cells[5].innerHTML = `${total / 8 * donggop / 100 * 0.9}`;
                                table.rows[n].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        } else if (hutech == 0 && qt == 0 && ngoai > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `0`;
                                table.rows[n].cells[5].innerHTML = `0`;
                                table.rows[n].cells[6].innerHTML = `0`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        }
                    }

                }
                ////////////
                else if (sltgc > 2 && sltgp > 0 && sltglh > 0) {
                    var tsltlh = 0;
                    var tglh = 0;
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var coquantgc = table.rows[0].cells[2].textContent;
                        if (coquantgc == "Hutech-Quốc tế (50%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tsltlh += 1;
                                }
                                if (tsltlh > 1 || tsltlh == 1) {
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                break;
                            }
                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)" || table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }
                        }
                        ////////
                        else if (coquantgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquantgc == "Quốc tế - Hutech (0%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 1000}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;

                                break;
                            }

                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            } if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tglh += 1;
                                }
                                if (tglh < 1) {
                                    if (table.rows[i].cells[2].textContent == "Tác giả phụ" && table.rows[i].cells[3].textContent == "Tác giả phụ") {

                                    }
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }

                                break;
                            }

                        }
                        ///////
                        else if (coquantgc == "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }
                else if (sltg == 2 && valuerank != "Nghiên cứu mạnh") {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg) * (donggop / 100)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }
                    }
                }

                else if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }

            ///////////////////
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc > 0 && sltglh > 1 && sltgp > 1 && sltg > 4) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                    for (let j = 0; j < sltg; j++) {
                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let k = 0; k < sltg; k++) {
                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                table.rows[k].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[k].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                } else {
                                    table.rows[k].cells[6].innerHTML = `0`;
                                }
                                table.rows[k].cells[7].innerHTML = `0`;
                            }
                            break;
                        }
                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var coquanhutech = 0;
                            for (let g = (j + 1); g < sltg; g++) {
                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    coquanhutech += 1;
                                }
                            }
                            if (coquanhutech < 1) {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                        } else {
                            for (let j = 1; j < (sltg - sltglh); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 2; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let k = 0; k < sltg; k++) {

                                                table.rows[k].cells[4].innerHTML = `0`;
                                                table.rows[k].cells[5].innerHTML = `0`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                        }
                                    }
                                    break;
                                }

                            }
                        }
                    }
                }
                ////////////
                if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                    for (let j = 0; j < sltg; j++) {
                        for (let k = 0; k < sltg; k++) {
                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[k].cells[6].innerHTML = `0`;
                            }
                            table.rows[k].cells[7].innerHTML = `0`;
                        }
                    }
                }

                ////////////
                if (table.rows[0].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[0].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                    var tglh100 = 0;
                    var tglh50 = 0;
                    var tglh0 = 0;
                    for (let i = (sltg - sltglh); i < sltg; i++) {
                        if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            tglh100 += 1;
                        } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            tglh50 += 1;
                        } if (table.rows[i].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[i].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                            tglh0 += 1;
                        }
                    }
                    if (tglh100 > 0) {
                        for (let j = 0; j < sltg; j++) {
                            var donggop = document.querySelector('#donggop-' + j).value;
                            table.rows[j].cells[4].innerHTML = `${total / sltglh * donggop / 100}`;
                            table.rows[j].cells[5].innerHTML = `${total / sltglh * donggop / 100 * 0.9}`;
                            if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                table.rows[j].cells[6].innerHTML = `0`;

                            } else {
                                table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                            }
                            table.rows[j].cells[7].innerHTML = `0`;
                        }
                    } if (tglh50 > 0 && tglh100 == 0) {
                        for (let j = 0; j < sltg; j++) {
                            var donggop = document.querySelector('#donggop-' + j).value;
                            table.rows[j].cells[4].innerHTML = `${total / 2 / sltglh * donggop / 100}`;
                            table.rows[j].cells[5].innerHTML = `${total / 2 / sltglh * donggop / 100 * 0.9}`;
                            if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                table.rows[j].cells[6].innerHTML = `0`;

                            } else {
                                table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                            }
                            table.rows[j].cells[7].innerHTML = `0`;
                        }
                    } if (tglh0 > 0 && tglh100 == 0 && tglh50 == 0) {
                        var tgp100 = 0;
                        var tgp50 = 0;
                        var tgp0 = 0;
                        for (let i = 1; i < (sltg - sltglh); i++) {
                            if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                tgp100 += 1;
                            } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                tgp50 += 1;
                            } if (table.rows[i].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[i].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                tgp0 += 1;
                            }
                        } if (tgp100 > 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `${total * 0.25 * donggop / 100}`;
                                table.rows[j].cells[5].innerHTML = `${total * 0.25 * donggop / 100 * 0.9}`;
                                if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                    table.rows[j].cells[6].innerHTML = `0`;

                                } else {
                                    table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                                }
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        } if (tgp50 == 0 && tglh50 > 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `${total * 0.25 / 2 * donggop / 100}`;
                                table.rows[j].cells[5].innerHTML = `${total * 0.25 / 2 * donggop / 100 * 0.9}`;
                                if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                    table.rows[j].cells[6].innerHTML = `0`;

                                } else {
                                    table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                                }
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        } if (tgp0 > 0 && tgp100 == 0 && tgp50 == 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `0`;
                                table.rows[j].cells[5].innerHTML = `0`;
                                table.rows[j].cells[6].innerHTML = `0`;
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        }

                    }

                }
                ////////////
                else if (sltgc > 2 && sltgp > 0 && sltglh > 0) {
                    var tsltlh = 0;
                    var tglh = 0;
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var coquantgc = table.rows[0].cells[2].textContent;
                        if (coquantgc == "Hutech-Quốc tế (50%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tsltlh += 1;
                                }
                                if (tsltlh > 1 || tsltlh == 1) {
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                break;
                            }
                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)" || table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }
                        }
                        ////////
                        else if (coquantgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquantgc == "Quốc tế - Hutech (0%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 1000}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;

                                break;
                            }

                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            } if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tglh += 1;
                                }
                                if (tglh < 1) {
                                    if (table.rows[i].cells[2].textContent == "Tác giả phụ" && table.rows[i].cells[3].textContent == "Tác giả phụ") {

                                    }
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }

                                break;
                            }

                        }
                        ///////
                        else if (coquantgc == "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }
                else if (sltg == 2 && valuerank != "Nghiên cứu mạnh") {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg) * (donggop / 100)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }
                    }
                }

                else if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }
            ///4
            if (valuerank.includes("GV") && valueloaihinh == "Đề tài") {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltg == 2) {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }
                        }
                    }
                }
                else if (sltg > 2 && (sltgc + sltglh) < sltg) {
                    for (let i = 0; i < sltg; i++) {

                        var coquan = table.rows[i].cells[2].textContent;
                        var optionstg1 = document.querySelector('#tg-' + i);
                        try { var texttg1 = optionstg1.options[optionstg1.selectedIndex].textContent; } catch { }

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            table.rows[i].cells[6].innerHTML = `0`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        } else if (coquan == "Hutech-Quốc tế (50%)") {
                            if (texttg1 == "Chủ nhiệm" || texttg1 == "Báo cáo viên" || texttg1 == "GVHD") {
                                table.rows[i].cells[4].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) / 2}`;
                                table.rows[i].cells[5].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) / 2 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;

                            } else if (texttg1 == "Thành viên" || texttg1 == "Sinh viên") {
                                table.rows[i].cells[4].innerHTML = `${(total * 0.2) / 2 / sltgp}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.2) / 2 / sltgp) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }

                        } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            if (texttg1 == "Chủ nhiệm" || texttg1 == "Báo cáo viên" || texttg1 == "GVHD") {

                                table.rows[i].cells[4].innerHTML = `${(((total * 0.8) / (sltgc + sltglh)))}`;
                                table.rows[i].cells[5].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;

                            } else if (texttg1 == "Thành viên" || texttg1 == "Sinh viên") {
                                table.rows[i].cells[4].innerHTML = `${((total * 0.2) / sltgp)}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.2) / sltgp) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }
                        }

                    }
                }

                if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }
            //////////////////
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc == 1 && sltglh == 1 && sltgp == 1 && sltg == 3) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                                    <td>${i + 1}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    /// tgc 0%
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[sltg - 1].cells[2].textContent != "Hutech-Quốc tế (50%)") {

                            // tgc 0, tglh 0, tgp 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 8 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 8 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;

                            }
                            // tgc 0, tglh 0, tgp 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            // tgc 0, tglh 0, tgp 0
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `0`;
                                table.rows[2].cells[5].innerHTML = `0`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            // tgc 0 tgp 50 tglh 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 100 thlh 50
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 0 thlh 50
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 0 tgp 50 thlh 100
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 100 thlh 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 0 thlh 100
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                    }
                    //tgc 50
                    if (texttgc == "Hutech-Quốc tế (50%)") {

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            // tgc 50, tglh 0, tgp 50
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `0`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            // tgc 50, tglh 0, tgp 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            // tgc 0, tglh 0, tgp 0
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            // tgc 0 tgp 50 tglh 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 100 thlh 50
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 0 thlh 50
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 0 tgp 50 thlh 100
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            }
                            //tgc 0 tgp 100 thlh 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 0 thlh 100
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                    }
                    //////tgc 100
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {

                        var donggop = document.querySelector('#donggop-' + i).value;
                        var donggoptgc = document.querySelector('#donggop-0').value;
                        table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[i].cells[7].innerHTML = `0`;
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[2].cells[7].innerHTML = `0`;
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            // tgc 100, tglh 0, tgp 50
                            table.rows[2].cells[6].innerHTML = `0`;
                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 100 tgp 50 thlh 100
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                        }
                        //// kiểm tra cơ quan tác giả phụ
                        if (table.rows[sltg - 2].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            table.rows[1].cells[6].innerHTML = `0`;
                        }
                        if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                        }
                        if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, 1 tác giả liên hệ
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc == 1 && sltglh == 1 && sltgp == 0 && sltg == 2) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                                    <td>${i + 1}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;

                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[1].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, >1 tác giả liên hệ
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 2 && sltgc == 1 && sltgp == 0 && sltglh > 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                alert("a");
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;

                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                        table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                        table.rows[i].cells[5].innerHTML = `${((total)) * (donggop / 100) * 0.9}`;
                        table.rows[i].cells[6].innerHTML = `0`;
                        table.rows[i].cells[7].innerHTML = `0`;
                    }
                }
            }
            ////
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 3 && sltgc == 1 && sltgp == 1 && sltglh > 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;

                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                        table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                        table.rows[i].cells[5].innerHTML = `${((total)) * (donggop / 100) * 0.9}`;
                        table.rows[i].cells[6].innerHTML = `0`;
                        table.rows[i].cells[7].innerHTML = `0`;
                    }
                }
            }
            ////// có 1 tác giả chính
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg == 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }

                for (let i = 0; i < sltg; i++) {

                    if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        table.rows[0].cells[4].innerHTML = `${((total))}`;
                        table.rows[0].cells[5].innerHTML = `${(((total))) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } else if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${((total / 2))}`;
                        table.rows[0].cells[5].innerHTML = `${(((total / 2))) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                        table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                        table.rows[i].cells[5].innerHTML = `${((total)) * (donggop / 100) * 0.9}`;
                        table.rows[i].cells[6].innerHTML = `0`;
                        table.rows[i].cells[7].innerHTML = `0`;
                    }

                }

            }
            ///// 1 chính, 1 phụ hoặc 1 chính 1 liên hệ

            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg == 2 && sltgc == 1 && sltgp == 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltg == 2) {
                    for (let i = 0; i < sltg; i++) {

                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        var optionscongtac = document.querySelector('#coquancongtac-' + 0);
                        var coquan = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[0].cells[4].innerHTML = `${((total)) * 0.25 * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total)) * 0.25 * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `${((total)) * 0.25 * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total)) * 0.25 * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                            } else if (table.rows[1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[0].cells[4].innerHTML = `${((total / 2)) * 0.25 * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total / 2)) * 0.25 * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `${((total / 2)) * 0.25 * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total / 2)) * 0.25 * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                            } else if (table.rows[1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;

                            }

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[i].cells[4].innerHTML = `${((total / 2)) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${(((total / 2)) * (donggop / 100)) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            var donggoptgc = Number(document.querySelector('#donggop-0').value);

                            if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[4].innerHTML = `${((total)) * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total)) * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${((total)) * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total)) * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }

                        } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${((total)) * (donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                        if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${((total)) * (donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `0`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }

                }
            }
            ///// nhiều hơn 3 tác giả: 1 chính, 1 phụ, 1 liên hệ

            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc > 0 && sltglh == 1 && sltgp > 1 && sltg > 2) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                    for (let j = 0; j < sltg; j++) {
                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let k = 0; k < sltg; k++) {
                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                } else {
                                    table.rows[k].cells[6].innerHTML = `0`;
                                }
                                table.rows[k].cells[7].innerHTML = `0`;
                            }
                            break;
                        }
                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var coquanhutech = 0;
                            for (let g = (j + 1); g < sltg; g++) {
                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    coquanhutech += 1;
                                }
                            }
                            if (coquanhutech < 1) {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                        } else {
                            for (let j = 1; j < (sltg - sltglh); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 2; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let k = 0; k < sltg; k++) {

                                                table.rows[k].cells[4].innerHTML = `0`;
                                                table.rows[k].cells[5].innerHTML = `0`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                        }
                                    }
                                    break;
                                }

                            }
                        }
                    }
                }
                ////////////
                if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                    if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        for (let j = 0; j < sltg; j++) {
                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var coquanhutech = 0;
                                for (let g = (j + 1); g < sltg; g++) {
                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        coquanhutech += 1;
                                    }
                                }
                                if (coquanhutech < 1) {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                            } else {
                                for (let j = 1; j < (sltg - sltglh); j++) {
                                    if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                    if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        var coquanhutech = 0;
                                        for (let g = (j); g < sltg; g++) {
                                            if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                coquanhutech += 1;
                                            }
                                        }
                                        if (coquanhutech < 1) {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                    } else {
                                        for (let j = 2; j < (sltg - sltglh); j++) {
                                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                var coquanhutech = 0;
                                                for (let g = (j); g < sltg; g++) {
                                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                        coquanhutech += 1;
                                                    }
                                                }
                                                if (coquanhutech < 1) {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                            } else {
                                                for (let k = 0; k < sltg; k++) {

                                                    table.rows[k].cells[4].innerHTML = `0`;
                                                    table.rows[k].cells[5].innerHTML = `0`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                        if (table.rows[0].cells[sltg - 1].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let j = 0; j < sltg; j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j + 1); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 1; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let j = 2; j < (sltg - sltglh); j++) {
                                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    var coquanhutech = 0;
                                                    for (let g = (j); g < sltg; g++) {
                                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                            coquanhutech += 1;
                                                        }
                                                    }
                                                    if (coquanhutech < 1) {
                                                        for (let k = 0; k < sltg; k++) {
                                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                            } else {
                                                                table.rows[k].cells[6].innerHTML = `0`;
                                                            }
                                                            table.rows[k].cells[7].innerHTML = `0`;
                                                        }
                                                        break;
                                                    }
                                                } else {
                                                    for (let k = 0; k < sltg; k++) {

                                                        table.rows[k].cells[4].innerHTML = `0`;
                                                        table.rows[k].cells[5].innerHTML = `0`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                }
                                            }
                                            break;
                                        }

                                    }
                                }
                            }
                        }
                    }
                }

                ////////////
                if (table.rows[0].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[0].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                    if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        for (let j = 0; j < sltg; j++) {
                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var coquanhutech = 0;
                                for (let g = (j + 1); g < sltg; g++) {
                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        coquanhutech += 1;
                                    }
                                }
                                if (coquanhutech < 1) {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                            } else {
                                for (let j = 1; j < (sltg - sltglh); j++) {
                                    if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                    if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        var coquanhutech = 0;
                                        for (let g = (j); g < sltg; g++) {
                                            if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                coquanhutech += 1;
                                            }
                                        }
                                        if (coquanhutech < 1) {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                    } else {
                                        for (let j = 2; j < (sltg - sltglh); j++) {
                                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                var coquanhutech = 0;
                                                for (let g = (j); g < sltg; g++) {
                                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                        coquanhutech += 1;
                                                    }
                                                }
                                                if (coquanhutech < 1) {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                            } else {
                                                for (let k = 0; k < sltg; k++) {

                                                    table.rows[k].cells[4].innerHTML = `0`;
                                                    table.rows[k].cells[5].innerHTML = `0`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                        if (table.rows[0].cells[sltg - 1].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let j = 0; j < sltg; j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j + 1); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 1; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let j = 2; j < (sltg - sltglh); j++) {
                                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    var coquanhutech = 0;
                                                    for (let g = (j); g < sltg; g++) {
                                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                            coquanhutech += 1;
                                                        }
                                                    }
                                                    if (coquanhutech < 1) {
                                                        for (let k = 0; k < sltg; k++) {
                                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                            } else {
                                                                table.rows[k].cells[6].innerHTML = `0`;
                                                            }
                                                            table.rows[k].cells[7].innerHTML = `0`;
                                                        }
                                                        break;
                                                    }
                                                } else {
                                                    for (let k = 0; k < sltg; k++) {

                                                        table.rows[k].cells[4].innerHTML = `0`;
                                                        table.rows[k].cells[5].innerHTML = `0`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                }
                                            }
                                            break;
                                        }

                                    }
                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                        var hutech = 0;
                        var qt = 0;
                        var ngoai = 0;
                        for (let k = 1; k < sltg; k++) {
                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                hutech += 1;
                            }
                            if (table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                qt += 1;

                            } else {
                                ngoai += 1;
                            }

                        }
                        if (hutech > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[n].cells[5].innerHTML = `${total / 4 * donggop / 100 * 0.9}`;
                                table.rows[n].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        } else if (hutech == 0 && qt > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[n].cells[5].innerHTML = `${total / 8 * donggop / 100 * 0.9}`;
                                table.rows[n].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        } else if (hutech == 0 && qt == 0 && ngoai > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `0`;
                                table.rows[n].cells[5].innerHTML = `0`;
                                table.rows[n].cells[6].innerHTML = `0`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        }
                    }

                }
                ////////////
                else if (sltgc > 2 && sltgp > 0 && sltglh > 0) {
                    var tsltlh = 0;
                    var tglh = 0;
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var coquantgc = table.rows[0].cells[2].textContent;
                        if (coquantgc == "Hutech-Quốc tế (50%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tsltlh += 1;
                                }
                                if (tsltlh > 1 || tsltlh == 1) {
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                break;
                            }
                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)" || table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }
                        }
                        ////////
                        else if (coquantgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquantgc == "Quốc tế - Hutech (0%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 1000}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;

                                break;
                            }

                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            } if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tglh += 1;
                                }
                                if (tglh < 1) {
                                    if (table.rows[i].cells[2].textContent == "Tác giả phụ" && table.rows[i].cells[3].textContent == "Tác giả phụ") {

                                    }
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }

                                break;
                            }

                        }
                        ///////
                        else if (coquantgc == "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }
                else if (sltg == 2 && valuerank != "Nghiên cứu mạnh") {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg) * (donggop / 100)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }
                    }
                }

                else if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }

            ///////////////////
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc > 0 && sltglh > 1 && sltgp > 1 && sltg > 4) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    try { var tacgia = document.querySelector('#inp-username-id-mail-' + i).value; } catch { }
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    try { var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    try { var texttg = optionstg.options[optionstg.selectedIndex].textContent; } catch { }
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                    for (let j = 0; j < sltg; j++) {
                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let k = 0; k < sltg; k++) {
                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                table.rows[k].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[k].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                } else {
                                    table.rows[k].cells[6].innerHTML = `0`;
                                }
                                table.rows[k].cells[7].innerHTML = `0`;
                            }
                            break;
                        }
                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var coquanhutech = 0;
                            for (let g = (j + 1); g < sltg; g++) {
                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    coquanhutech += 1;
                                }
                            }
                            if (coquanhutech < 1) {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                        } else {
                            for (let j = 1; j < (sltg - sltglh); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 2; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let k = 0; k < sltg; k++) {

                                                table.rows[k].cells[4].innerHTML = `0`;
                                                table.rows[k].cells[5].innerHTML = `0`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                        }
                                    }
                                    break;
                                }

                            }
                        }
                    }
                }
                ////////////
                if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                    for (let j = 0; j < sltg; j++) {
                        for (let k = 0; k < sltg; k++) {
                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[k].cells[6].innerHTML = `0`;
                            }
                            table.rows[k].cells[7].innerHTML = `0`;
                        }
                    }
                }

                ////////////
                if (table.rows[0].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[0].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                    var tglh100 = 0;
                    var tglh50 = 0;
                    var tglh0 = 0;
                    for (let i = (sltg - sltglh); i < sltg; i++) {
                        if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            tglh100 += 1;
                        } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            tglh50 += 1;
                        } if (table.rows[i].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[i].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                            tglh0 += 1;
                        }
                    }
                    if (tglh100 > 0) {
                        for (let j = 0; j < sltg; j++) {
                            var donggop = document.querySelector('#donggop-' + j).value;
                            table.rows[j].cells[4].innerHTML = `${total / sltglh * donggop / 100}`;
                            table.rows[j].cells[5].innerHTML = `${total / sltglh * donggop / 100 * 0.9}`;
                            if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                table.rows[j].cells[6].innerHTML = `0`;

                            } else {
                                table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                            }
                            table.rows[j].cells[7].innerHTML = `0`;
                        }
                    } if (tglh50 > 0 && tglh100 == 0) {
                        for (let j = 0; j < sltg; j++) {
                            var donggop = document.querySelector('#donggop-' + j).value;
                            table.rows[j].cells[4].innerHTML = `${total / 2 / sltglh * donggop / 100}`;
                            table.rows[j].cells[5].innerHTML = `${total / 2 / sltglh * donggop / 100 * 0.9}`;
                            if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                table.rows[j].cells[6].innerHTML = `0`;

                            } else {
                                table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                            }
                            table.rows[j].cells[7].innerHTML = `0`;
                        }
                    } if (tglh0 > 0 && tglh100 == 0 && tglh50 == 0) {
                        var tgp100 = 0;
                        var tgp50 = 0;
                        var tgp0 = 0;
                        for (let i = 1; i < (sltg - sltglh); i++) {
                            if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                tgp100 += 1;
                            } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                tgp50 += 1;
                            } if (table.rows[i].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[i].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                tgp0 += 1;
                            }
                        } if (tgp100 > 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `${total * 0.25 * donggop / 100}`;
                                table.rows[j].cells[5].innerHTML = `${total * 0.25 * donggop / 100 * 0.9}`;
                                if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                    table.rows[j].cells[6].innerHTML = `0`;

                                } else {
                                    table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                                }
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        } if (tgp50 == 0 && tglh50 > 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `${total * 0.25 / 2 * donggop / 100}`;
                                table.rows[j].cells[5].innerHTML = `${total * 0.25 / 2 * donggop / 100 * 0.9}`;
                                if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                    table.rows[j].cells[6].innerHTML = `0`;

                                } else {
                                    table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                                }
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        } if (tgp0 > 0 && tgp100 == 0 && tgp50 == 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `0`;
                                table.rows[j].cells[5].innerHTML = `0`;
                                table.rows[j].cells[6].innerHTML = `0`;
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        }

                    }

                }
                ////////////
                else if (sltgc > 2 && sltgp > 0 && sltglh > 0) {
                    var tsltlh = 0;
                    var tglh = 0;
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var coquantgc = table.rows[0].cells[2].textContent;
                        if (coquantgc == "Hutech-Quốc tế (50%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tsltlh += 1;
                                }
                                if (tsltlh > 1 || tsltlh == 1) {
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                break;
                            }
                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)" || table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }
                        }
                        ////////
                        else if (coquantgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquantgc == "Quốc tế - Hutech (0%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 1000}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;

                                break;
                            }

                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            } if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tglh += 1;
                                }
                                if (tglh < 1) {
                                    if (table.rows[i].cells[2].textContent == "Tác giả phụ" && table.rows[i].cells[3].textContent == "Tác giả phụ") {

                                    }
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }

                                break;
                            }

                        }
                        ///////
                        else if (coquantgc == "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || table.rows[i].cells[2].textContent == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }
                else if (sltg == 2 && valuerank != "Nghiên cứu mạnh") {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg) * (donggop / 100)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }
                    }
                }

                else if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }
            ////////
        }
  }

    ////////alert("https://localhost:44364/api/NguoiDung/Get-user-id?input=" + _idUser);
    function Get_DonVi(callback) {
      fetch(`https://localhost:44364/api/NguoiDung/Get-user-id?input=${_idUser}`, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })
            .then(function (response) {
                return response.json();
            })
            .then(callback)
    }
    /////////
    var tenuser = "";

    function render_dv(dv) {
        var htmls = dv.map(function (dv) {
            khoa1 = dv.donViCongTac;
            //sessionStorage.clear();
            return sessionStorage.setItem("Khoa", dv.donViCongTac);
        });
        if (!sessionStorage.getItem("Khoa").includes("NCM")) {
           // //alert("a");
            document.getElementById("loaiHinhKeKhai").innerHTML =
                `<option value="KKKL" selected>Kê khai khối lượng</option>
                                                <option value="DT">Đề tài</option>`
                ;
        } else {
            //alert(_ngach);
            document.getElementById("loaiHinhKeKhai").innerHTML =
                `<option value="KKKL" selected>Kê khai khối lượng</option>
                                                <option value = "DT" >Đề tài</option>
                                                <option value = "NCM" >Nghiên cứu mạnh</option>`
                                                ;
        }

        //tenuser = document.querySelector('#xinchao').textContent;
    }
    Get_DonVi(render_dv);
    ////alert(_idUser);
    ////alert(sessionStorage.getItem("Khoa"));
    ////////alert(sessionStorage.getItem('Khoa'));
    var articleId = "";
    function clear() {
        document.getElementById("tenSanPhamKHCN").value = "";
        document.getElementById('datesubmit').value = document.getElementById('datesubmit').defaultValue;
        document.getElementById("sodoi").value = "";
        document.getElementById("fileInput").value = "";
        document.getElementById("uploadedFiles").innerHTML = "";
        document.getElementById('btn_Cissn').checked = false;
        document.getElementById('btn_Kissn').checked = false;
        document.querySelector('#isIssn').innerHTML = ``;
        document.querySelector('#noIssn').innerHTML = ``;
        document.querySelector('#ketqua').innerHTML = ``;
        document.querySelector('#traCuuIssn').value = "";
        var input_issn = document.getElementById("input_issn");
        var choose_lh = document.querySelector('#choose_lh');
        var chonLoaiCongTrinh = document.querySelector('#chonLoaiCongTrinh');
        input_issn.style.display = "none";
        choose_lh.style.display = "none";
        chonLoaiCongTrinh.style.display = "none";
        document.getElementById("btn-lvt").style.display = "none";
        document.getElementById("btn-lvtm").style.display = "none";
        stepperPrevious();
    }
    function luuVaThemMoi() {
        handleSend("lvtm");
        clear();
    }
    function check_result() {
        var categoryedit = sessionStorage.getItem("cate");
        var date = document.querySelector('#datesubmit').value;
        var tenspkhcn = document.querySelector('#tenSanPhamKHCN').value;
        var link = document.querySelector('#sodoi').value;
        //var linkimage = document.querySelector('#fileInput').value;
        var selectElement = document.getElementById("loaiCongTrinh");
        var selectedValue = selectElement.value;
        try {
            var selectedValue2 = document.querySelector('input[name="yc"]:checked').value;
        } catch { }
        if (selectedValue == "DeTai" || selectedValue == "HDNCKH") {
            if (selectedValue2.includes("Seminar cấp Khoa, báo cáo chuyên đề cấp đơn vị")) {
                document.querySelector('.form-group .col-form-label[for="sltgc"]').innerHTML = `Báo cáo viên`;
                document.querySelector('.form-group .col-form-label[for="sltgp"]').innerHTML = `Thành viên`;
                document.querySelector('.form-group .col-form-label[for="sltglh"]').style.display = 'none';
                document.getElementById('sltglh').style.display = 'none';

            } else if (selectedValue2.includes("Giảng viên đang học nghiên cứu sinh trong thời gian quy định, có báo cáo kết quả học tập và nghiên cứu trong năm học")) {
                document.querySelector('.form-group .col-form-label[for="sltgc"]').innerHTML = `GVHD`;
                document.querySelector('.form-group .col-form-label[for="sltgp"]').innerHTML = `Sinh viên`;
                document.querySelector('.form-group .col-form-label[for="sltglh"]').innerHTML = `Đồng GVHD`;
             } else {
                document.getElementById("information-part").innerHTML = `<div class="row">
                                        <div class="form-group col-3 row">
                                            <label class="col-form-label" for="sltgc">Chủ nhiệm</label>
                                            <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng chủ nhiệm" id="sltgc" disabled value="1" min="1" max="1" oninput="clear_hinhthuc()" />
                                        </div>
                                        <div class="form-group col row" style="margin-left:2%">
                                            <label class="col-form-label" for="sltgp">Thành viên</label>
                                            <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng thành viên" id="sltgp" min="1" oninput="clear_hinhthuc()" />
                                        </div>
                                        <div class="form-group col row" style="margin-left:2%">
                                            <label class="col-form-label" for="sltglh">Đồng chủ nhiệm</label>
                                            <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng đồng chủ nhiệm" id="sltglh" min="1" oninput="clear_hinhthuc()" />
                                        </div>
                                    </div>

                                    <div class="form-group col-2" id="tongtacgia">
                                    </div>
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">THÔNG TIN TÁC GIẢ</h3>
                                        </div>
                                        @*Ban dt*@
                                        <div class="table-container">

                                            <table class="table table-bordered table-striped" style="width:100%" id="tbtacgiasl">
                                                <tbody id="addtacgiasl2" onchange="loadtable()">
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="table-container">
                                            <table class="table table-bordered table-striped" style="width:100%" id="tbtacgia2">
                                                <tbody id="addtacgia" onchange="loadtable()">
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <button class="btn btn-success" onclick="stepperPrevious()">VỀ TRƯỚC</button>`;
            }
        }
        else {
            document.querySelector('.form-group .col-form-label[for="sltgc"]').innerHTML = `Tác giả đầu`;
            document.querySelector('.form-group .col-form-label[for="sltgp"]').innerHTML = `Số lượng tác giả phụ`;
            document.querySelector('.form-group .col-form-label[for="sltglh"]').innerHTML = `Số lượng tác giả liên hệ`;

         }
        try {
            var valuecategory = document.querySelector('input[id="category-1"]:checked').value;
        } catch
        {
            try {
                var valuecategory = document.querySelector('input[name="category"]:checked').value;
            }
            catch {
                try {
                    var valuecategory = document.querySelector('input[name="yc"]:checked').value;

                } catch {
                    var valuecategory = "";
                }
            }
        }
        try {
            var kinhphi = document.querySelector('#totaltien').textContent;

        } catch {
            var kinhphi = "";
        }
        if (tenspkhcn == "") {
            return toastr.warning("Vui lòng nhập tên sản phẩm!");
        }
        if (date == "") {
            return toastr.warning("Vui lòng chọn ngày công bố sản phẩm!");
        }
        // TODO: refactor to check file input
        //if (linkimage == "") {
        //    return toastr.warning("Vui lòng nhập minh chứng!");
        //}

        if (valuecategory == "") {
            return toastr.warning("Vui lòng tra cứu hoặc chọn loại hình sản phẩm!");

        } else {
          stepper.next()

          document.getElementById("btn-lvt").style.display = "unset";
          document.getElementById("btn-lvtm").style.display = "unset";

          try { } catch { }
       }
    }
    function stepperPrevious() {
      stepper.previous();

      document.getElementById("btn-lvt").style.display = "none";
      document.getElementById("btn-lvtm").style.display = "none";
    }
    function click_radioIssn() {
        document.querySelector('#isIssn').innerHTML = ``;
        document.querySelector('#noIssn').innerHTML = ``;
        document.querySelector('#ketqua').innerHTML = ``;
        document.querySelector('#traCuuIssn').value = "";
        var input_issn = document.getElementById("input_issn");
        var choose_lh = document.querySelector('#choose_lh');
        var chonLoaiCongTrinh = document.querySelector('#chonLoaiCongTrinh');
        var issn = document.querySelector('input[name="radioIssn"]:checked').value;
        if (issn == "Cissn") {
            input_issn.style.display = "flex";
            choose_lh.style.display = "flex";
            chonLoaiCongTrinh.style.display = "none";

        } if (issn == "Kissn") {
            input_issn.style.display = "none";
            choose_lh.style.display = "flex";
            chonLoaiCongTrinh.style.display = "flex";
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        // BS-Stepper Init
        window.stepper = new Stepper(document.querySelector('.bs-stepper'))
        // Khi modal mở
        $('#modal-xl-create').on('shown.bs.modal', function () {
            // hiện thị chọn loại hình kê khai

            var selectLoaiHinhKeKhai = document.getElementById("loaiHinhKeKhai");
            var rank = _ngach;
            var options = selectLoaiHinhKeKhai.options;
            for (var i = 0; i < options.length; i++) {
                var option = options[i];
                if (rank === "GV") {
                    option.style.display = "block";
                } else if (rank === "NCV" && option.value !== "DT") {
                    option.style.display = "block";
                } else {
                    option.style.display = "none";
                }
            }
        });
      // Khi modal đóng
      $('#modal-xl-create').on('hidden.bs.modal', function () {
        clear();
      })
    })
  //xử lý tìm issn
  async function Get_issn(callback) {
    const inputSearch = document.getElementById("traCuuIssn").value;
    const valueDatetime1 = document.getElementById("datesubmit").value;
    const valueDatetimePicker = new Date(valueDatetime1);
    const thang6 = new Date('2023-05-06');

    if (!valueDatetime1) {
      toastr.warning("Vui lòng nhập ngày công bố để tra cứu!");
      return;
    }

    const scopusUrl = valueDatetimePicker > thang6
      ? "https://localhost:44364/api/DanhMucScimago2023"
      : "https://localhost:44364/api/DanhMuc";

    const headers = {
      'Authorization': 'Bearer ' + _token,
      'Content-Type': 'application/json'
    };

    try {
      let res = await fetch(`${scopusUrl}/Get-issn?issn=${inputSearch}`, { headers });

      if (res.status === 404) {
        res = await fetch(`${scopusUrl}/Get-eissn?eissn=${inputSearch}`, { headers });
      }

      if (res.status === 404) {
        res = await fetch(`https://localhost:44364/api/DanhMucScimago/Get-issn?issn=${inputSearch}`, { headers });
      }

      if (res.status === 404) {
        res = await fetch(`https://localhost:44364/api/DanhMucScimago/Get-eissn?eissn=${inputSearch}`, { headers });
      }

      if (res.status === 404) {
        res = await fetch(`https://localhost:44364/api/DanhMucTrongNuoc/Get-DanhMucTrongNuoc?issn=${inputSearch}`, { headers });
      }

      if (res.status === 404) {
        toastr.warning("Không tìm thấy sản phẩm trong ISI, Scopus, HĐCDGSNN!");
        document.querySelector('#ketqua').innerHTML = '';
        document.querySelector('#btn_Kissn').checked = true;
        click_radioIssn();
      } else {
        const data = await res.json();
        callback(data);
      }
    } catch (error) {
      console.error("Error fetching ISSN data:", error);
      toastr.error("Có lỗi xảy ra khi tìm kiếm!");
    }
  }

  function renderGet_issn(issns) {
    if (!issns) return;

    let htmls = issns.map(issn => {
      if (!issn) return "";

      const { hoidongnganh, journal_name, issn: issnCode, eissn, category_1, category_2, category_3, category_4, category_5, category_6 } = issn;

      if (hoidongnganh != undefined) {
        let diem = Number(issn.diem);
        let isIssn = document.getElementById("isIssn");
        isIssn.style.display = "block";
        isIssn.style.pointerEvents = "unset";
        return `
          <input onclick="render_kinhphi('${diem}')" type="radio" class="radio-result" id="category-${issn.id}" name="category" value="${issn.tentapchi} (${hoidongnganh})" />
          ${issn.tentapchi} (${hoidongnganh}) (${diem} điểm)</br>
        `;
      }

      const categories = [category_1, category_2, category_3, category_4, category_5, category_6];
      let categoryHTML = categories
        .map((cat, index) => cat ? `
          <input type="radio" class="radio-result" id="category-${index + 1}" name="category" onclick="render_kinhphi('${cat}')" value="${cat}" />
          <label for="category-${index + 1}">${cat}</label><br />` : '')
        .join('');

      return `
        <label>Tên danh mục: <label id="lbname">${journal_name}</label></label>
        <label>Issn: <label id="lbissn">${issnCode}</label></label>
        <label>Eissn: <label id="lbeissn">${eissn}</label></label><br />
        ${categoryHTML}
      `;
    });

    let isIssn = document.getElementById("isIssn");
    isIssn.style.display = "block";
    isIssn.innerHTML = htmls.join('');

    try {
      document.getElementById("category-1").checked = true;
    } catch (e) { }

    try {
      let selectedValue = document.querySelector('input[name="category"]:checked').value;
      render_kinhphi(selectedValue);
    } catch (e) { }
  }

    var input = document.getElementById("traCuuIssn");
    input.addEventListener("keypress", async function (event) {
        if (event.key === "Enter") {
            var isIssn = document.getElementById("isIssn");
            isIssn.innerHTML = ``;
            await Get_issn(renderGet_issn);
        }
    });

    //
    /*var radios = document.getElementsByName("category");
    for (var i = 0; i < radios.length; i++) {
        radios[i].addEventListener("change", function () {
            render_kinhphi(Event.value);
        });
    }*/

  async function Get_issnscopus(callback) {
    const inputSearch = document.getElementById("traCuuIssn").value;
    const valueDatetimePicker = new Date(document.getElementById("datesubmit").value);
    const thang6 = new Date('2023-05-06');
    const scopusUrl = valueDatetimePicker > thang6
      ? "https://localhost:44364/api/DanhMucScimago2023"
      : "https://localhost:44364/api/DanhMucScimago";

    const headers = {
      'Authorization': 'Bearer ' + _token,
      'Content-Type': 'application/json'
    }

    if (!inputSearch) return;

    try {
      let res = await fetch(`${scopusUrl}/Get-issn?issn=${inputSearch}`, { headers });
      if (res.status === 404) {
        res = await fetch(`${scopusUrl}/Get-eissn?eissn=${inputSearch}`, { headers });
      }
      if (res.status === 404) {
        res = await fetch(`https://localhost:44364/api/DanhMucTrongNuoc/Get-DanhMucTrongNuoc?issn=${inputSearch}`, { headers });
      }

      if (res.status === 404) {
        toastr.warning("Không tim thấy sản phẩm trong ISI, Scopus, HĐCDGSNN!");
        document.querySelector('#ketqua').innerHTML = ``;
        document.querySelector('#btn_Kissn').checked = true;
        click_radioIssn();
      } else {
        const data = await res.json();
        callback(data);
      }
    } catch (error) {
      console.error("Error fetching ISSN data:", error);
      toastr.error("Có lỗi xảy ra khi tìm kiếm!");
    }
  }

    async function render_kinhphi(q) {
        var valuerank = _ngach;
        var noIssn = document.getElementById("noIssn");
        var chonLoaiCongTrinh = document.getElementById("chonLoaiCongTrinh");
        noIssn.style.display = "none";

        var ketqua = document.getElementById("ketqua");
        ketqua.innerHTML = ``;
        var valueloaihinh = document.getElementById("loaiHinhKeKhai").value;
        if (valuerank.includes("GV") && valueloaihinh == "KKKL") {
            if (q.includes("N/A")) {
                await Get_issnscopus(renderGet_issn);

            } else if (q == "Q1" || q == "Q2" || q == "Q3") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:  </label ><label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">60</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            } else if (q == "Q4") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">60</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            }
            else if (q.includes("Q1")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">120</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">30</label>`;
            } else if (q.includes("Q2")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">110</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">27.5</label>`;
            } else if (q.includes("Q3")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">100</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">25</label>`;
            } else if (q.includes("Q4")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">90</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">22.5</label>`;
            } else {
                ketqua.style.display = "block";
                ketqua.innerHTML = `
                            <label>Kinh phí bài báo:</label> <label id="totaltien">0</label>
                            <label>Tiết chuẩn:</label> <label id="tietchuan">${q * 60}</label>
                            <label>Điểm hoàn thành:</label><label id="diem">${q * 15}</label>`;
            }
        }
        if (valuerank.includes("GV") && valueloaihinh == "NCM") {
            if (q.includes("N/A")) {

                await Get_issnscopus(renderGet_issn);

            } else if (q == "Q1" || q == "Q2" || q == "Q3") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">${formatCurrency(24000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            } else if (q == "Q4") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            }
            else if (q.includes("Q1")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label>Kinh phí bài báo:</label><label id="totaltien">${formatCurrency(100000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">30</label>`;
            } else if (q.includes("Q2")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">${formatCurrency(80000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">27.5</label>`;
            } else if (q.includes("Q3")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">${formatCurrency(60000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">25</label>`;
            } else if (q.includes("Q4")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label ><label id="totaltien">${formatCurrency(40000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">22.5</label>`;
            } else {
                var tien = 0;
                if (1 == 1) {
                    tien = 15000000;
                } else if (q < 1) {
                    tien = 10000000;
                } else {
                    tien = 18000000;
                }
                ketqua.style.display = "block";
                ketqua.innerHTML = `
                            <label>Kinh phí bài báo:</label> <label id="totaltien">${formatCurrency(tien)}</label>
                            <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                            <label>Điểm hoàn thành:</label><label id="diem">${q * 15}</label>`;
            }

        }
        if (valuerank.includes("GV") && valueloaihinh == "DT") {
            if (q.includes("N/A")) {

                await Get_issnscopus(renderGet_issn);


            } else if (q == "Q1" || q == "Q2" || q == "Q3") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">${formatCurrency(24000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            } else if (q == "Q4") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">${formatCurrency(24000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            }
            else if (q.includes("Q1")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label>Kinh phí bài báo:</label><label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">30</label>`;
            } else if (q.includes("Q2")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">27.5</label>`;
            } else if (q.includes("Q3")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">25</label>`;
            } else if (q.includes("Q4")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label ><label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">22.5</label>`;
            } else {
                var tien = 0;
                if (1 == 1) {
                    tien = 15000000;
                } else if (q < 1) {
                    tien = 10000000;
                } else {
                    tien = 18000000;
                }
                ketqua.style.display = "block";
                ketqua.innerHTML = `
                            <label>Kinh phí bài báo:</label> <label id="totaltien">${formatCurrency(tien)}</label>
                            <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                            <label>Điểm hoàn thành:</label><label id="diem">${q * 15}</label>`;
            }

        }
        if (valuerank.includes("NCV") && valueloaihinh == "KKKL") {
            if (q.includes("N/A")) {
                await Get_issnscopus(renderGet_issn);

            } else if (q == "Q1" || q == "Q2" || q == "Q3") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">160</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            } else if (q == "Q4") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">0</label>`;
            }
            else if (q.includes("Q1")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">625</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">30</label>`;
            } else if (q.includes("Q2")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">500</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">27.5</label>`;
            } else if (q.includes("Q3")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">375</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">25</label>`;
            } else if (q.includes("Q4")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">250</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">22.5</label>`;
            } else {
                ketqua.style.display = "block";
                ketqua.innerHTML = `
                            <label>Kinh phí bài báo:</label> <label id="totaltien">0</label>
                            <label>Tiết chuẩn:</label> <label id="tietchuan">${q * 60}</label>
                            <label>Điểm hoàn thành:</label><label id="diem">${q * 15}</label>`;
            }
        }
        if (valuerank.includes("NCV") && valueloaihinh == "NCM") {
            if (q.includes("N/A")) {

                await Get_issnscopus(renderGet_issn);



            } else if (q == "Q1" || q == "Q2" || q == "Q3") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">${formatCurrency(24000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            } else if (q == "Q4") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">0</label>`;
            }
            else if (q.includes("Q1")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label>Kinh phí bài báo:</label><label id="totaltien">${formatCurrency(100000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">30</label>`;
            } else if (q.includes("Q2")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">${formatCurrency(80000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">27.5</label>`;
            } else if (q.includes("Q3")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">${formatCurrency(60000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">25</label>`;
            } else if (q.includes("Q4")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label ><label id="totaltien">${formatCurrency(40000000)}</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">22.5</label>`;
            } else {
                var tien = 0;
                if (1 == 1) {
                    tien = 15000000;
                } else if (q < 1) {
                    tien = 10000000;
                } else {
                    tien = 18000000;
                }
                ketqua.style.display = "block";
                ketqua.innerHTML = `
                            <label>Kinh phí bài báo:</label> <label id="totaltien">${formatCurrency(tien)}</label>
                            <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                            <label>Điểm hoàn thành:</label><label id="diem">${q * 15}</label>`;
            }

        }
    }

    //hiển thị chọn loại công trình
    var selectLoaiHinhKeKhai = document.getElementById("loaiHinhKeKhai");
    var chonLoaiCongTrinh = document.getElementById("chonLoaiCongTrinh");
    loadLoaiCongTrinh({ target: selectLoaiHinhKeKhai })
    selectLoaiHinhKeKhai.addEventListener("change", loadLoaiCongTrinh);
    async function loadLoaiCongTrinh(event) {
        document.getElementById("ketqua").innerHTML = ``;
        try {
            clear_hinhthuc();
            themtacgia();
        } catch { }
        var inputIssn = document.getElementById("traCuuIssn").value;
        if (inputIssn != null) {
            try {
                var lbname = document.getElementById("lbname").textContent;
            } catch {
                var lbname = "";
            }
            if (lbname == "") {
                try {
                    var selectTrongNuoc = document.querySelector('input[name="category"]:checked').value;
                    render_kinhphi(selectTrongNuoc);
                }
                catch { }

            } else {
                try {
                    await Get_issn(renderGet_issn);
                } catch {

                }

            }

        }
        try {
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;

            var category = (document.querySelector('input[id="category-1"]:checked').value);
            if (valueloaihinh == "Kê khai khối lượng") {
                if (category.includes("Q1")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">120</label>
                                    <label>Điểm:</label><label id="diem">30</label>
                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;
                }
                if (category.includes("Q2")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">110</label>
                                    <label>Điểm:</label><label id="diem">27.5</label>
                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category.includes("Q3")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">100</label>
                                    <label>Điểm:</label><label id="diem">25</label>
                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category.includes("Q4")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">90</label>
                                    <label>Điểm:</label><label id="diem">22.5</label>
                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category == "Q1" || category == "Q2" || category == "Q3") {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">60</label>
                                    <label>Điểm:</label><label id="diem">15</label>
                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
            }
        } catch { }

        document.getElementById("noIssn").innerHTML = ``;
        //document.getElementById("ketqua").innerHTML = ``;
        var lhkk = event.target.value;
        var rank = _ngach;
        if (rank === "GV") {
            if (lhkk === "KKKL") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="Sach">Sách</option>
                                        <option value="DeTai">Đề tài NCKH/ Seminar</option>
                                        <option value="TapChi">Hội nghị/ Tạp chí</option>
                                        <option value="HDNCKH">Hướng dẫn sinh viên</option>
                                        <option value="SHTT">Sở hữu trí tuệ</option>
                                        <option value="NgheThuat">Sản phẩm nghệ thuật</option>
                                        <option value="DanhMucKhac">Danh mục khác</option>
                                    </select>
                                </div>`;
                document.querySelector('#trangthaithanhtoan').innerHTML = ``;

            } else if (lhkk === "NCM") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="BaiBao">Bài báo</option>
                                        <option value="SPK">Sản phẩm khác</option>
                                        <option value="DanhMucKhac">Danh mục khác</option>
                                    </select>
                                </div>`;
                document.querySelector('#trangthaithanhtoan').innerHTML = `
                  <input type="checkbox" id="tickthanhtoan" name="tickthanhtoan" onclick="testst()" value="Chưa thanh toán">
                  <label for="tickthanhtoan">Sản phẩm xét thanh toán đợt tháng 06/2024</label>`;
            }
            else if (lhkk === "DT") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="BaiBaoQT">Bài báo quốc tế</option>
                                        <option value="BaiBao_CSP">Bài báo trong nước</option>
                                        <option value="SPUD">Sản phẩm ứng dụng</option>
                                    </select>
                                </div>`;
                document.querySelector('#trangthaithanhtoan').innerHTML = ``;
            }

        } else if (rank === "NCV") {
            if (lhkk === "KKKL") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="BaiBao">Bài báo</option>
                                        <option value="Sach">Sách/chương sách</option>
                                        <option value="SPK">Sản phẩm khác</option>
                                        <option value="DanhMucKhac">Danh mục khác</option>

                                    </select>
                                </div>`;
            } else if (lhkk === "NCM") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="BaiBao">Bài báo</option>
                                        <option value="SPK">Sản phẩm khác</option>
                                        <option value="DanhMucKhac">Danh mục khác</option>

                                    </select>
                                </div>`;
            }
        }
        //render_kinhphi();
    }
    ///

    //chọn loại công trình

    function changeLoaiCongTrinh() {
        document.getElementById("ketqua").innerHTML = ``;
        var selectLoaiCongTrinh = document.getElementById("loaiCongTrinh");
        var loaiCongTrinh = selectLoaiCongTrinh.value;
        // //////alert(loaiCongTrinh);
        var valuerank = _ngach;
        var valueloaihinh = document.getElementById("loaiHinhKeKhai").value;
        if (valuerank.includes("NCV") && valueloaihinh == "NCM") {
            Get_thanhtoanncv(loaiCongTrinh, render_spkhcn);
        }
        if (valuerank.includes("NCV") && valueloaihinh == "KKKL") {
            Get_thanhtoanncv(loaiCongTrinh, render_spkhcn);
        }
        if (valuerank.includes("GV") && valueloaihinh == "NCM") {//
            Get_thanhtoanncv(loaiCongTrinh, render_spkhcn);
        }
        else if (valuerank.includes("GV") && valueloaihinh == "KKKL") {//
            Get_spkhcn(loaiCongTrinh, render_spkhcn);
        }
        else if (valuerank.includes("GV") && valueloaihinh == "HDNCKH") {
            Get_spkhcn(loaiCongTrinh, render_spkhcn);
        }
        else if (valuerank.includes("GV") && valueloaihinh == "DT") {
            Get_thanhtoanncv(loaiCongTrinh, render_spkhcn);
        }

    }

    //kê khai khối lượng gv
    var apiQDGV = "https://localhost:44364/api/QuyDoiGV/Get-spkhcn?spkhcn=";
    function Get_spkhcn(a, callback) {
        fetch(apiQDGV + a, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })
            .then(function (response) {
                return response.json();
            })
            .then(callback)
    }
    function render_spkhcn(khcns) {
        var checkbox = document.getElementById("noIssn");
        checkbox.style.display = 'block';
        checkbox.innerHTML = "";
        var valuerank = _ngach;
        var valueloaihinh = document.getElementById("loaiHinhKeKhai").value;
        if (valuerank.includes("GV") && valueloaihinh == "DT") {
            loadloaibaibao(); // where this function???
        }
        try {
            if (valuerank != "GV") {
                if (valueloaihinh == "NCM") {
                    var htmls = khcns.map(function (khcn) {
                        return `<div class="custom-control custom-radio">
                                   <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.moTaSanPhamKHCN}" onclick="checkcheckncv(${khcn.id}, render_checkncv(${khcn.kinhPhi}, ${khcn.tcnckh}))">
                                    <label for="${khcn.id}" class="custom-control-label">${khcn.moTaSanPhamKHCN}</label>
                                </div>`;
                    });
                } else {
                    var htmls = khcns.map(function (khcn) {
                        return `<div class="custom-control custom-radio">
                                    <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.moTaLoaiSanPham}" onclick="checkcheckncv(${khcn.id}, render_checkncv(${khcn.tietChuan}, ${khcn.diem}))">
                                    <label for="${khcn.id}" class="custom-control-label">${khcn.moTaLoaiSanPham}</label>
                                </div>`;
                    });
                }
            } else if (valuerank == "GV") {
                if (valueloaihinh == "NCM") {
                    var htmls = khcns.map(function (khcn) {
                        return `<div class="custom-control custom-radio">
                                        <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.moTaSanPhamKHCN}" onclick="checkcheckncv(${khcn.id}, render_checkncv(${khcn.kinhPhi}, ${khcn.tcnckh}))">
                                        <label for="${khcn.id}" class="custom-control-label">${khcn.moTaSanPhamKHCN}</label>
                                    </div>`;
                    });
                } else if (valueloaihinh == "DT") {
                    var htmls = khcns.map(function (khcn) {
                        return `<div class="custom-control custom-radio">
                                        <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.yeuCauChatLuong}" onclick="checkcheckncv(${khcn.id}, render_checkncv(${khcn.kinhPhi}, 0))">
                                        <label for="${khcn.id}" class="custom-control-label">${khcn.yeuCauChatLuong}</label>
                                    </div>`;
                    });
                } else if (valueloaihinh == "KKKL") {
                    var htmls = khcns.map(function (khcn) {
                        return `<div class="custom-control custom-radio">
                                        <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.moTaLoaiSanPham}" onclick="checkcheckncv(${khcn.id}, render_checkncv(${khcn.tietChuan}, ${khcn.diem}))">
                                        <label for="${khcn.id}" class="custom-control-label">${khcn.moTaLoaiSanPham}</label>
                                    </div>`;
                    });
                }
            }
            checkbox.innerHTML = htmls.join('');
        } catch { }
    }

    //kê khai khối lượng ncv
    function Get_thanhtoanncv(a, callback) {
        var valuerank = _ngach;
        var valueloaihinh = document.getElementById("loaiHinhKeKhai").value;
        var apiQDNCV = "https://localhost:44364/api/QuyDoiNCV/Get-spkhcn?spkhcn=";
        var apiTTGV = "https://localhost:44364/api/ThanhToanGV/Get-LSP?lsp=";
        var apiTTNCV = "https://localhost:44364/api/ThanhToanNCV/Get-spkhcn?spkhcn=";
        // //////alert(a);
        if (valuerank.includes("GV") && valueloaihinh == "NCM") {
            fetch("https://localhost:44364/api/ThanhToanNCV/Get-spkhcn?spkhcn=" + a, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (response) {
                    return response.json();
                })
                .then(callback)
        } else if (valuerank.includes("GV") && valueloaihinh == "DT") {
            fetch(apiTTGV + a, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (response) {
                    return response.json();
                })
                .then(callback)
        } else if (valuerank.includes("NCV") && valueloaihinh == "NCM") {
            fetch(apiTTNCV + a, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (response) {
                    return response.json();
                })
                .then(callback)
        }
        else {
            fetch(apiQDNCV + a, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (response) {
                    return response.json();
                })
                .then(callback)
        }
    }
    //
    linkapiID2 = "https://localhost:44364/api/QuyDoiGV/Get-id?id=";
    linkapiID3NCV = "https://localhost:44364/api/ThanhToanNCV/Get-id?id=";
    var valuerank = _ngach;
    function checkcheckncv(a, callback) {
        if (valuerank.includes("GV")) {

            fetch(linkapiID2 + a, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (res) {
                    return res.json();
                })
                .then(callback);
        }
        if (valuerank.includes("NCV")) {

            fetch(linkapiID3NCV + a, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (res) {
                    return res.json();
                })
                .then(callback);
        }
    }

    function render_checkncv(tietchuan, diem, lsps) {
        /*show_yc();*/
        try {
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;

            var category = document.querySelector('input[id="category-1"]').value;
        } catch { }
        try {
            if (valueloaihinh == "Kê khai khối lượng") {
                var ketqua = document.getElementById("ketqua");
                ketqua.style.display = 'block';
                ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">${tietchuan}</label>
                                    <label>Điểm:</label><label id="diem">${diem}</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;
                if (category.includes("Q1")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">120</label>
                                        <label>Điểm:</label><label id="diem">30</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;
                }
                if (category.includes("Q2")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">110</label>
                                        <label>Điểm:</label><label id="diem">27.5</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category.includes("Q3")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">100</label>
                                        <label>Điểm:</label><label id="diem">25</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category.includes("Q4")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">90</label>
                                       <label>Điểm:</label><label id="diem">22.5</label>
                                       <label>Kinh phí:</label><label id="totaltien">0</label>`;
                }
                if (category == "Q1" || category == "Q2" || category == "Q3") {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">60</label>
                                        <label>Điểm:</label><label id="diem">15</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;
                } else {
                }
            }
            else if (valueloaihinh == "Nghiên cứu mạnh") {
                var ketqua = document.getElementById("ketqua");
                ketqua.style.display = 'block';
                ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm:</label><label id="diem">${diem}</label>
                                        <label>Kinh phí:</label><label id="totaltien">${tietchuan}</label>`;
            } else if (valueloaihinh == "Nghiên cứu mạnh") {
                var ketqua = document.getElementById("ketqua");
                ketqua.style.display = 'block';
                ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm:</label><label id="diem">${diem}</label>
                                        <label>Kinh phí:</label><label id="totaltien">${tietchuan}</label>`;
            }
        } catch { }
  }

  var selectedFilesArray = []; // Mảng chứa danh sách file đã chọn

  // Hàm rút gọn tên file
  function shortenFileName(fileName, maxLength = 15) {
    // Kiểm tra độ dài fileName, nếu nhỏ hơn hoặc bằng maxLength thì không cần rút gọn
    if (fileName.length <= maxLength) return fileName;

    const extIndex = fileName.lastIndexOf('.'); // Lấy vị trí dấu chấm cuối cùng (phần mở rộng file)
    const extension = extIndex !== -1 ? fileName.slice(extIndex) : ''; // Phần mở rộng file (nếu có)
    const baseName = fileName.slice(0, extIndex); // Phần tên trước dấu chấm

    // Giữ lại 7 ký tự đầu và 4 ký tự cuối, giữa là '...'
    const start = baseName.slice(0, 7);
    const end = baseName.slice(-4);

    return `${start}...${end}${extension}`;
  }

  // Hàm xử lý khi chọn file
  function handleFileSelect(event) {
    //const files = event.target.files;
    //selectedFilesArray = Array.from(files);
    uploadFiles();
  }

  // Hàm upload file
  function uploadFiles() {
      var fileInput = document.getElementById('fileInput');
      var files = fileInput.files;
      const userId = _idUser;
      const valuetenbaibao = document.querySelector('#tenSanPhamKHCN').value;
  
      const maxFileSize = 10 * 1024 * 1024; // Giới hạn dung lượng là 10MB
  
      if (files.length === 0) {
        toastr.warning('Vui lòng chọn tệp tin để tải lên.');
        return;
      }
  
      let uploadPromises = []; // Mảng chứa các Promise upload file
  
      Array.from(files).forEach(file => {
        // Kiểm tra dung lượng file
        if (file.size > maxFileSize) {
          toastr.error(`Tệp tin ${file.name} vượt quá giới hạn dung lượng 10MB.`);
          return;
        }
  
        // Tạo FormData để upload file dạng binary
        let formData = new FormData();
        formData.append('file', file);
        formData.append('fileName', file.name);
        formData.append('userId', userId);
        formData.append('valuetenbaibao', valuetenbaibao);
  
        let uploadPromise = new Promise((resolve, reject) => {
          $.ajax({
            url: '/Article/SaveFile',
            type: 'POST',
            data: formData,
            processData: false, // Không xử lý dữ liệu
            contentType: false, // Không thiết lập tiêu đề content-type
            success: function (result) {
              if (result.success) {
                resolve(result.filePath);
              } else {
                reject('Tải lên thất bại.');
              }
            },
            error: function () {
              reject('Đã xảy ra lỗi khi tải lên.');
            }
          });
        });
  
        uploadPromises.push(uploadPromise); // Thêm Promise vào mảng
      });
  
      // Khi tất cả các file đã upload xong
      Promise.all(uploadPromises)
        .then(filePaths => {
          toastr.success('Tải lên thành công.');
          displayUploadedFiles(filePaths); // Hiển thị danh sách file đã upload thành công
        })
        .catch(error => {
          toastr.error(error);
        });
    }

  // Hàm load hiển thị danh sách file đã upload dùng xem chi tiết
  function loadUploadedFiles(fileList) {
    const uploadedFilesContainer = document.getElementById('uploadedFiles');
    uploadedFilesContainer.innerHTML = ''; // Xóa nội dung cũ

    fileList.forEach((fileUrl) => {
      const fileDiv = document.createElement('div');
      fileDiv.className = 'col-4 file-item';

      const fileLink = document.createElement('a');
      fileLink.href = fileUrl;
      fileLink.textContent = shortenFileName(fileUrl.split('/').pop()); // Hiển thị tên file đã rút gọn
      fileLink.target = '_blank';
      fileLink.className = 'd-block';

      fileDiv.appendChild(fileLink);
      uploadedFilesContainer.appendChild(fileDiv);
    });
  }

  // Hàm load hiển thị file upload cũ dùng xem chi tiết
  function loadOldUploadedFile(fileUrl) {
    const uploadedFilesContainer = document.getElementById('uploadedFiles');
    uploadedFilesContainer.innerHTML = ''; // Xóa nội dung cũ

    const fileDiv = document.createElement('div');
    fileDiv.className = 'col-4 file-item';

    const fileLink = document.createElement('a');
    fileLink.href = fileUrl;
    fileLink.textContent = shortenFileName(fileUrl.split('/').pop()); // Hiển thị tên file đã rút gọn
    fileLink.target = '_blank';
    fileLink.className = 'd-block';

    fileDiv.appendChild(fileLink);
    uploadedFilesContainer.appendChild(fileDiv);
  }

  // Hàm hiển thị danh sách file đã upload
  function displayUploadedFiles(files) {
    const uploadedFilesContainer = document.getElementById('uploadedFiles');
    uploadedFilesContainer.innerHTML = ''; // Xóa nội dung cũ

    files.forEach((fileUrl) => {
      const fileDiv = document.createElement('div');
      fileDiv.className = 'col-4 file-item';

      const fileLink = document.createElement('a');
      fileLink.href = fileUrl;
      fileLink.textContent = shortenFileName(fileUrl.split('/').pop()); // Hiển thị tên file đã rút gọn
      fileLink.target = '_blank';
      fileLink.className = 'd-block';

      const removeButton = document.createElement('button');
      removeButton.textContent = 'Xóa';
      removeButton.className = 'btn btn-danger btn-sm';
      removeButton.style.position = 'absolute';
      removeButton.style.top = '5px';
      removeButton.style.right = '5px';
      removeButton.onclick = function () {
        deleteUploadedFile(fileUrl, fileDiv);
      };

      fileDiv.appendChild(fileLink);
      fileDiv.appendChild(removeButton);
      uploadedFilesContainer.appendChild(fileDiv);
    });
  }

  // Hàm xóa file đã upload
  function deleteUploadedFile(fileUrl, fileDiv) {
    if (confirm("Bạn có chắc chắn muốn xóa tệp này không?")) {
      $.ajax({
        url: '/Article/DeleteFile',
        type: 'POST',
        data: JSON.stringify({ fileUrl: fileUrl }),
        contentType: 'application/json',
        success: function (result) {
          if (result.success) {
            toastr.success('Xóa tệp thành công.');
            // Xóa phần tử của file đã xóa khỏi giao diện
            fileDiv.remove();
          } else {
            toastr.error('Xóa tệp thất bại.');
          }
        },
        error: function () {
          toastr.error('Đã xảy ra lỗi khi xóa tệp.');
        }
      });
    }
  }

    document.addEventListener("DOMContentLoaded", function () {


        if (_ngach.includes("GV")) {
            //document.getElementById("create").disabled = true;
        } else {
            //document.getElementById("create").disabled = false;
        }
        ////////
        var timeline = document.getElementById("timeline");
        timeline.addEventListener("change", function () {
            ////alert("a");
            $(function () {
                $('#example1').DataTable().clear().destroy();

            });
            getData();

        });
        ////alert(_idUser);
        function getData() {
            var timeline = document.getElementById("timeline").value;
          fetch('https://localhost:44364/api/DanhMucXetDuyet/Get-by-userid?userid=' + _idUser + "&startTimes=" + timeline, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(response => response.json())
                .then(data => {
                    var tongTien = 0;
                    var tongTietChuan = 0;
                    var tongDiem = 0;
                    var stt = 1;
                    const tbody = document.querySelector('#example1 tbody');
                    tbody.innerHTML = "";
                    data.forEach(function (row) {
                        ////////alert(row.groupUser);
                        if (row.status == "Đang đợi duyệt") {
                            txtcolor = "rgba(77, 77, 79, 1)";
                            bgcolor = "rgba(77, 77, 79, 0.07)";
                        } else if (row.status == "Duyệt lần 1") {
                            txtcolor = "rgba(27, 162, 180, 1)";
                            bgcolor = "rgba(27, 162, 180, 0.07)";
                        } else if (row.status == "Duyệt lần 2") {
                            txtcolor = "rgba(16, 117, 187, 1)";
                            bgcolor = "rgba(16, 117, 187, 0.07)";
                        } else if (row.status == "Từ chối") {
                            txtcolor = "rgba(200, 16, 47, 1)";
                            bgcolor = "rgba(200, 16, 47, 0.07)";
                        } else {
                            txtcolor = "rgba(42, 148, 70, 1)";
                            bgcolor = "rgba(42, 148, 70, 0.07)";
                        };
                        var grtg = row.groupUser;

                        var tacgia = getOneAuthor(grtg, _idUser);
                        ////////alert(tacgia + "/// " + _idUser);
                        var tr = document.createElement('tr');
                        var ccs = "";
                        if (row.status == "Từ chối") {
                            ccs = "Yêu cầu chỉnh sửa";
                        } else {
                            ccs = row.status;
                        }
                        try {
                            tr.innerHTML =
                                "<td>" + stt + "</td>" +
                                "<td>" + row.tenBaiBao + "</td>" +
                                "<td>" + row.journal_name + "  " + row.category + "</td>" +
                                "<td>" + tacgia[3] + "</td>" +
                                "<td>" + formatCurrency(tacgia[4]) + "</td>" +
                                "<td>" + tacgia[7] + "</td>" +
                                "<td>" + tacgia[6] + "</td>" +
                                "<td width='15%' align='center'>" + row.ghiChu + "</td>" +
                                "<td><span class='badge' style='color:" + txtcolor + "!important; background-color:" + bgcolor + "!important;'>" + ccs + "</span></td>" +
                                "<td width='3%'><a type='button' data-toggle='modal' data-target='#modal-xl-create' data-backdrop='static' onclick='xemchitiet(" + row.idDanhMuc + ")'><i class='fas fa-edit' style='color: #3276b1;'></i></a></td>" +
                                "<td width='3%'><a type='button' onclick='deleteItem(" + row.idDanhMuc + ")'><i class='fas fa-trash-alt' style='color: #c82333;'></i></a></td>";
                            if (row.dateSubmit_now) {
                                var date = new Date(row.dateSubmit_now);
                                var day = date.getDate().toString().padStart(2, "0");
                                var month = (date.getMonth() + 1).toString().padStart(2, "0");
                                var year = date.getFullYear();
                                tr.setAttribute("title", `Dữ liệu bài báo này được cập nhật vào lúc ${day}/${month}/${year}`);
                            }
                            tbody.appendChild(tr);
                            stt += 1;
                            tongTien += tacgia[4] ? parseFloat(tacgia[4]) : 0;
                            tongTietChuan += tacgia[7] ? parseFloat(tacgia[7]) : 0;
                            tongDiem += tacgia[6] ? parseFloat(tacgia[6]) : 0;
                        } catch { }

                    });
                    document.getElementById("tongTien").textContent = formatCurrency(tongTien);
                    document.getElementById("tongTietChuan").textContent = tongTietChuan;
                    document.getElementById("tongDiem").textContent = tongDiem;
                    $(function () {
                        $("#example1").DataTable({
                          "paging": true,
                          "searching": true,
                          "ordering": true,
                          "info": true,
                          "lengthChange": false,
                          "autoWidth": false,
                          "responsive": false, // Đặt về false để sử dụng scrollX hiệu quả
                          "scrollX": true,  // Kích hoạt scroll ngang
                          "scrollCollapse": true, // Tự động thu gọn chiều rộng
                        })
                    });
                });

        }
        getData();
    });


    /*function xemchitiet(iddm) {
        fetch('https://localhost:44364/api/DanhMucXetDuyet/Get-id?IDDanhMuc=' + iddm, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                document.getElementById("idDanhMuc").value = data.idDanhMuc;
                document.getElementById("issn").value = data.issn;
                document.getElementById("eissn").value = data.eissn;
                document.getElementById("tenBaiBao").value = data.tenBaiBao;
                document.getElementById("type").value = data.type;
                document.getElementById("rank").value = data.rank;
                try {
                    document.getElementById("total2").value = data.total;
                }
                catch {

                }
                document.getElementById("dateSubmit").value = data.dateSubmit;
                document.getElementById("ghiChu").value = data.ghiChu;
                document.getElementById("image").src = data.image;

                //hiển thị theo quyền

                document.getElementById("status").value = data.status;
                const kekhaitg = render_tg(data.groupUser);
                const tbody = document.querySelector('#tbtacgia tbody');
                tbody.innerHTML = ``;
                kekhaitg.forEach(function (row) {

                    var tr = document.createElement('tr');
                    tr.innerHTML = "<td width='5%' align='center'>" + row[0] + "</td>" +
                        "<td>" + row[1] + "</td>" +
                        "<td>" + row[2] + "</td>" +
                        "<td>" + row[3] + "</td>" +
                        "<td>" + row[4] + "</td>" +
                        "<td>" + row[5] + "</td>" +
                        "<td>" + row[6] + "</td>" +
                        "<td>" + row[7] + "</td>";

                    tbody.appendChild(tr);

                });
                document.getElementById("link").textContent = data.link;
                const link = document.getElementById("link");
                link.href = data.link;

                // Chuỗi đường dẫn hình ảnh
                var imagePaths = data.image;

                // Phần tử div để chứa hình ảnh
                var imageDiv = document.getElementById("image");

                // Xóa bỏ các hình ảnh trước đó
                imageDiv.innerHTML = "";

                var fileDiv = document.getElementById("file");

                // Xóa bỏ các hình ảnh trước đó
                fileDiv.innerHTML = "";

                // Tách chuỗi đường dẫn thành mảng các đường dẫn
                var imagePathsArray = imagePaths.split(',');

                // Lặp qua từng đường dẫn
                imagePathsArray.forEach(function (imagePath) {
                    // Kiểm tra đuôi file
                    var fileExtension = imagePath.split('.').pop().toLowerCase();
                    var imageExtensions = ['jpg', 'jpeg', 'png', 'gif']; // Các đuôi file hình ảnh hợp lệ

                    if (imageExtensions.includes(fileExtension)) {
                        // Nếu là đường dẫn hình ảnh, tạo phần tử img và gán đường dẫn
                        var imgElement = document.createElement("img");
                        imgElement.src = imagePath;

                        // Thêm thuộc tính vào phần tử img
                        imgElement.setAttribute("alt", "Hình ảnh");
                        imgElement.setAttribute("width", "400px");
                        imgElement.setAttribute("height", "auto");

                        // Thêm phần tử img vào phần tử div
                        imageDiv.appendChild(imgElement);
                    } else {
                        // Nếu là tệp khác, tạo phần tử a và gán đường dẫn
                        var linkElement = document.createElement("a");
                        linkElement.href = imagePath;
                        linkElement.target = "_blank";
                        linkElement.textContent = " " + imagePath;

                        // Thêm sự kiện click cho phần tử a để mở tab mới
                        linkElement.addEventListener("click", function (event) {
                            event.preventDefault(); // Ngăn chặn chuyển hướng trình duyệt
                            window.open(this.href, "_blank"); // Mở tab mới với đường dẫn
                        });

                        // Tạo một phần tử label
                        var labelElement = document.createElement("label");
                        labelElement.textContent = "File: ";

                        // Thêm label và phần tử a vào phần tử div
                        fileDiv.appendChild(labelElement);
                        fileDiv.appendChild(linkElement);
                    }
                });

            })
    }*/
    var global_dmxd = "";
    function xemchitiet(iddm) {
        fetch('https://localhost:44364/api/DanhMucXetDuyet/Get-id?IDDanhMuc=' + iddm, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        }).then(response => response.json())
            .then(data => {
                global_dmxd = data.type;
                articleId = data.idDanhMuc;
                ////alert(data.status);
                if (data.status == "Đang đợi duyệt") {
                    document.getElementById("btn-lvt").disabled = false;
                    document.getElementById("btn-lvtm").disabled = false;
                } else if (data.status == "Từ chối") {
                    document.getElementById("btn-lvt").disabled = false;
                    document.getElementById("btn-lvtm").disabled = false;
                } else {
                    document.getElementById("btn-lvt").remove();
                    document.getElementById("btn-lvtm").remove();
                }

                document.getElementById("iddmxd").value = data.idDanhMuc;
                var input_issn = document.getElementById("input_issn");
                var choose_lh = document.getElementById("choose_lh");
                var trangthaithanhtoan = document.getElementById("trangthaithanhtoan");
                var chonLoaiCongTrinh = document.getElementById("chonLoaiCongTrinh");
                var optionslh = document.querySelector('#loaiHinhKeKhai');
                var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
                document.getElementById("tenSanPhamKHCN").value = data.tenBaiBao;
                sessionStorage.setItem("NguoiKhai", data.userId);
                sessionStorage.setItem("GhiChu", data.ghiChu);
                sessionStorage.setItem("NguoiSua", data.citations);
                sessionStorage.setItem("TrangThaiThanhToan", data.if_2022);
                var dateString = data.dateSubmit;
                var dateParts = dateString.split("T");
                var date = dateParts[0];
                var date1 = new Date(dateString);
                var dateSumbit = document.getElementById("datesubmit");
                date1.setDate(date1.getDate() + 1);
                dateSumbit.value = date1.toISOString().substring(0, 10);
                document.getElementById("sodoi").value = data.link;
                //document.getElementById("myFile").value = data.image;
                // cho file upload cũ
                if (data.image != "") {
                  loadOldUploadedFile(data.image);
                } else {
                  loadUploadedFiles(data.fileList);
                }
                var chonLoaiCongTrinh = document.querySelector('#chonLoaiCongTrinh');
                if (data.issn != "" || data.eissn != "") {
                    document.getElementById("btn_Cissn").checked = true;
                    input_issn.style.display = "flex";
                    choose_lh.style.display = "flex";
                    chonLoaiCongTrinh.style.display = "none";
                    if (data.issn != "") {
                        document.getElementById("traCuuIssn").value = data.issn;
                    } else if (data.eissn != "") {
                        document.getElementById("traCuuIssn").value = data.eissn;
                    }
                    var radios = document.querySelectorAll('input[name="category"]');


                    sessionStorage.setItem("cate", data.category);
                    var categoryedit = sessionStorage.getItem("cate");
                    ////alert(document.getElementsByName("category").value);




                    for (var ra = 0; ra < radios.length; i++) {
                        if (radios[ra].value == data.category) {
                            radios[ra].checked = true;
                            break;
                        }
                    }
                }
                else {
                    document.getElementById("btn_Kissn").checked = true;
                    choose_lh.style.display = "flex";
                    chonLoaiCongTrinh.style.display = "flex";
                }
                document.getElementById("loaiHinhKeKhai").value = data.loaiHinhKeKhai;
                //loadLoaiCongTrinh();
                if (data.loaiHinhKeKhai == "NCM") {

                    chonLoaiCongTrinh.innerHTML = `
                            <div class="form-group row">
                                <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                    <option value="" selected >Chọn loại công trình</option>
                                    <option value="BaiBao">Bài báo</option>
                                    <option value="SPK">Sản phẩm khác</option>
                                </select>
                            </div>`;
                }
                if (document.getElementById("loaiHinhKeKhai").value == "NCM") {
                    ////////alert("a");
                    document.querySelector('#trangthaithanhtoan').innerHTML = `
                    <input type="checkbox" id="tickthanhtoan" name="tickthanhtoan" onclick="testst()" value="Chưa thanh toán"><label for="tickthanhtoan">Sản phẩm xét thanh toán đợt tháng 06/2024</label>`;
                    if (data.if_2022 == "Chưa thanh toán") {
                        document.querySelector('#trangthaithanhtoan').innerHTML = `
                    <input type="checkbox" id="tickthanhtoan" name="tickthanhtoan" onclick="testst()" checked value="Chưa thanh toán"><label for="tickthanhtoan">Sản phẩm xét thanh toán đợt tháng 12/2023</label>`;
                    }
                }
                try {
                    document.getElementById("loaiCongTrinh").value = data.loaiCongTrinh;
                    ////////alert(data.loaiCongTrinh);
                    changeLoaiCongTrinh();

                }
                catch {

                }

                var tgp = 0;
                var tglh = 0;
                var tgc = 1;
                const kekhaitg = render_tg(data.groupUser);
                kekhaitg.forEach(function (row) {
                    if (row[3].includes("Tác giả phụ") || row[3].includes("Báo cáo viên") || row[3].includes("Tác giả chính")) {
                        tgp += 1;
                    }
                    if (row[3].includes("Tác giả liên hệ")) {
                        tglh += 1;
                    }
                });

                document.querySelector('#sltgp').value = tgp - tgc;
                document.querySelector('#sltglh').value = tglh;
                ///////
                var a = ``;
                var sltgc = tgc;
                var sltgp = tgp;
                var sltglh = tglh;
                var valuerank = data.rank;
                var optionslh = document.querySelector('#loaiHinhKeKhai');
                var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
                var sltg = sltgc + sltgp + sltglh;
                let i = 0;

                //toastr.warning(valueloaihinh + valuerank);



                document.querySelector('#tbtacgia2').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                        <th width="2%">STT</th>
                        <th width="15%">Mã nhân viên</th>
                        <th width="15%">Cơ quan công tác</th>
                        <th width="15%">Loại tác giả</th>
                        <th width="10%">Tổng nhận trước thuế</th>
                        <th width="10%">Thực nhận</th>
                        <th width="5%">Điểm</th>
                        <th width="5%">Tiết chuẩn</th>
                        </thead>
                        <tbody id="tablethanhtoan">
                        </tbody>`;
                try {
                    var tien = data.total;

                } catch { }

                kekhaitg.forEach(async function (row) {
                    var vop2 = ``;
                    if (row[2] == " --Chọn cơ quan công tác--") {
                        vop = `<div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" value="${row[1]}" id="coquancongtac-${i}" class="form-control">
                            <option value="0" selected> --Chọn cơ quan công tác--</option>
                            <option value="1" >Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div>`;
                    }
                    if (row[2] == "Cơ quan công tác duy nhất Hutech (100%)") {
                        vop = `<div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" value="${row[1]}" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1" selected>Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div>`;
                    }
                    if (row[2] == "Hutech-Quốc tế (50%)") {
                        vop = `<div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1" >Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5" selected>Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div>`;
                    }
                    if (row[2] == "Quốc tế - Hutech (0%)") {
                        vop = `<div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1" >Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5" >Hutech-Quốc tế (50%)</option>
                            <option value="0" selected>Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div>`;
                    }
                    if (row[2] == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        vop = `<div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1" >Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5" >Hutech-Quốc tế (50%)</option>
                            <option value="0" >Quốc tế - Hutech (0%)</option>
                            <option value="0" selected>Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div>`;
                    }
                    if (row[3].includes("Tác giả liên hệ")) {
                        vop2 = `<option>Tác giả liên hệ</option>`;
                    }
                    if (row[3].includes("Tác giả phụ")) {
                        vop2 = `<option>Tác giả phụ</option>`;
                    }
                    if (row[3].includes("Tác giả chính")) {
                        vop2 = `<option>Tác giả chính</option>`;
                    }
                    try {
                        var selectedValueYc = document.querySelector('input[name="yc"]:checked').value;
                    } catch { }

                    //document.querySelector('#tongtacgia').innerHTML = `<a>Tổng số tác giả: <a id="tongsltg">${sltg}</a></a>`;
                    if (sltgc == 1 && valueloaihinh == "Đề tài" && valuerank.includes("GV")) {
                        if (selectedValueYc.includes("Seminar cấp Khoa, báo cáo chuyên đề cấp đơn vị")) {
                            for (i; i < sltgc; i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}"  class="form-control">
                             <option >Báo cáo viên</option>
                             </select></td></tr>`;
                            }
                            for (i; i < (sltgp + sltgc); i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control">
                             <option >Thành viên</option>
                                                         <option >Báo cáo viên</option>
                             </select>
                             </td>
                             </tr>`;
                            } for (i; i < (sltgc + sltglh + sltgp); i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control">
                             <option >Báo cáo viên</option>

                             </td></tr>`;
                            }

                            try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
                        }
                        else if (selectedValueYc.includes("Giảng viên đang học nghiên cứu sinh trong thời gian quy định, có báo cáo kết quả học tập và nghiên cứu trong năm học")) {
                            for (i; i < sltgc; i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}"  class="form-control">
                             <option >GVHD</option>
                             </select></td></tr>`;
                            }
                            for (i; i < (sltgp + sltgc); i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control">
                             <option >Sinh viên</option>

                             </select>
                             </td>
                             </tr>`;
                            } for (i; i < (sltgc + sltglh + sltgp); i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"  id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control">
                             <option >Đồng GVHD</option>

                             </td></tr>`;
                            }

                            try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
                        } else {
                            for (i; i < sltgc; i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}"  class="form-control">
                             <option >Chủ nhiệm</option>
                             <option >Thành viên</option>
                             </select></td></tr>`;
                            }
                            for (i; i < (sltgp + sltgc); i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"  id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control">
                             <option >Thành viên</option>

                        <option >Chủ nhiệm</option>
                             </select>
                             </td>
                             </tr>`;
                            } for (i; i < sltg; i++) {
                                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" value="${row[i]}"  id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control">
                             <option >Thành viên</option>

                             <option >Chủ nhiệm</option></select>
                             </td></tr>`;
                            }

                            try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
                        }

                    }

                    if (sltgc == 1 && valueloaihinh == "Kê khai khối lượng" && valuerank.includes("GV")) {
                        a += `<tr><td>${i += 1}</td >
                        <td ><input class="form-control" type="text" value="${row[1]}" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i - 1}"   oninput="inpsearch(${i - 1},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i - 1}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac-${i - 1}" onchange="checknullhutech(${i + 1})" id="tg-${i - 1}" class="form-control" disabled>

                            <option>${row[3]}</option>

                             </select></td>

                             </tr>`;
                        document.querySelector('#addtacgia').innerHTML = ``;
                        try { document.querySelector('#addtacgia').innerHTML = a; } catch { }

                    }
                    ///
                    if (sltgc == 1 && valueloaihinh == "Kê khai khối lượng" && valuerank.includes("NCV")) {

                        a += `<tr><td>${i += 1}</td >
                        <td ><input class="form-control" type="text" value="${row[1]}" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i - 1}"   oninput="inpsearch(${i - 1},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i - 1}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac-${i - 1}" onchange="checknullhutech(${i + 1})" id="tg-${i - 1}" class="form-control" disabled>

                             <option>${row[3]}</option>

                             </select></td>

                             </tr>`;
                        try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
                    }
                    ///

                    if (sltgc == 1 && valueloaihinh == "Nghiên cứu mạnh" && valuerank.includes("GV")) {
                        if (valueloaihinh == "Nghiên cứu mạnh") {
                            var tienrow = row[4] / tien * 100;
                            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                    <th width="2%">STT</th>
                    <th width="20%">Mã nhân viên</th>
                    <th width="20%">Cơ quan công tác</th>
                    <th width="10%">Loại tác giả</th>
                    <th width="7%">Đóng góp (%)</th>
                    </thead>

                    <tbody id="addtacgia" onchange="loadtable()">
                    </tbody>`;
                        }
                        a += `<tr><td>${i += 1}</td >
                        <td ><input class="form-control" type="text" value="${row[1]}" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i - 1}"   oninput="inpsearch(${i - 1},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i - 1}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac-${i - 1}" onchange="checknullhutech(${i + 1})" id="tg-${i - 1}" class="form-control" disabled>

                             <option>${row[3]}</option>

                             </select></td>
                             <td ><input class="form-control" type="number" placeholder="Nhập % đóng góp" value="${tienrow}" id="donggop-${i - 1}"></td>
                             </tr>`;
                        document.querySelector('#addtacgia').innerHTML = ``;
                        try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
                        tienrow = 0;

                    }
                    if (sltgc == 1 && valueloaihinh == "Nghiên cứu mạnh" && valuerank.includes("NCV")) {
                        ////alert("a");
                        if (valueloaihinh == "Nghiên cứu mạnh") {
                            var tienrow = row[4] / tien * 100;
                            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                    <th width="2%">STT</th>
                    <th width="20%">Mã nhân viên</th>
                    <th width="20%">Cơ quan công tác</th>
                    <th width="10%">Loại tác giả</th>
                    <th width="7%">Đóng góp (%)</th>
                    </thead>

                    <tbody id="addtacgia" onchange="loadtable()">
                    </tbody>`;
                        }
                        a += `<tr><td>${i += 1}</td >
                        <td ><input class="form-control" type="text" value="${row[1]}" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i - 1}"   oninput="inpsearch(${i - 1},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i - 1}">
                                </dl>
                            </div>
                        </div></td>
                        <td >${vop}</td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac-${i - 1}" onchange="checknullhutech(${i + 1})" id="tg-${i - 1}" class="form-control" disabled>
                           <option>${row[3]}</option>

                             </select></td>
                             <td ><input class="form-control" type="number" placeholder="Nhập % đóng góp" value="${tienrow}" id="donggop-${i - 1}"></td>
                             </tr>`;
                        document.querySelector('#addtacgia').innerHTML = ``;
                        try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
                        tienrow = 0;

                    }

                    else if (sltgc > 1) {
                        toastr.warning("Duy nhất 1 tác giả chính!");
                    }
                    try { document.querySelector('#addtacgia').innerHTML = a; } catch { }

                    /////
                    await Get_issn(renderGet_issn);
                    //document.querySelector('#tbtacgiasl').EditData = false;
                });//

            });
    }



    setInterval(function () { EditData(); }, 1000);
    function EditData() {
        if (global_dmxd != "") {

            var radios2 = document.querySelectorAll('input[name="yc"]');
            for (var i = 0; i < radios2.length; i++) {
                if (radios2[i].value == global_dmxd) {

                    radios2[i].click();
                    global_dmxd = "";
                    break;
                }
            }
        }
    }

    function sleep(milliseconds) {
        var start = new Date().getTime();
        for (var i = 0; i < 1e7; i++) {
            if ((new Date().getTime() - start) > milliseconds) {
                break;
            }
        }
    }
    function changeStatus() {
        var idDanhMuc = document.getElementById("idDanhMuc").value;
        var status = document.getElementById("status").value;
        fetch(`https://localhost:44364/api/DanhMucXetDuyet/${idDanhMuc}`, {
            method: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(status)
        })
            .then(response => response.json())
            .then(data => {
                if (data) {
                    toastr.success('Cập nhật trạng thái thành công!');
                }
            })
            .catch(error => {
                toastr.warning('Có lỗi xảy ra', error);
            });
    }

    function render_kekhaitg(tg) {
        const tgct = tg.split(";");
        return tgct;
    }
    function render_tg(str) {
        const lista = [];
        const tgs = str.split("$");
        tgs.forEach(function (tg) {
            var x = render_kekhaitg(tg);
            lista.push(x);
        });
        return lista;
    }

    function getOneAuthor(str, userId) {
        const tgs = str.split("$");
        var result = null;
        tgs.forEach(function (tg) {
            if (tg.includes(userId)) {
                result = render_kekhaitg(tg);
            }
        });
        return result;
    }
    //Xuất file excel
    function ExportToExcelDeTaiUser(xuat) {
        var timeline = document.getElementById("timeline").value;
        if (!timeline) {
            timeline = "2020-01-01 00:00:00.0000000";
        }
        var url = 'https://localhost:44364/api/DanhMucXetDuyet/ExcelUserid?userid=' + _idUser + '&xuat=' + xuat + '&startTime=' + encodeURIComponent(timeline);

        fetch(url, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })

            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(new Blob([blob]));
                const link = document.createElement('a');
                link.href = url;
                if (xuat == 1) {
                    link.setAttribute('download', 'NCM.xlsx');
                }
                else if (xuat == 2) {
                    link.setAttribute('download', 'KhoaVien.xlsx');
                }
                else if (xuat == 4) {
                    link.setAttribute('download', 'NghienCuuVien.xlsx');
                }
                else {
                    link.setAttribute('download', 'Truong.xlsx');
                }
                document.body.appendChild(link);
                link.click();
                link.parentNode.removeChild(link);
            })
    }
    function deleteItem(id) {
        if (confirm("Xác nhận xóa?")) {
            fetch("https://localhost:44364/api/DanhMucXetDuyet/Delete/" + id, {
                method: 'DELETE',
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(response => {
                    if (response.ok) {
                        toastr.success('Xóa dữ liệu thành công!');
                        window.location.href = '/NguoiDung/DeTai';
                    }
                    else if (response.status == 400) {
                        toastr.warning('Không có quyền xóa với trạng thái hiện tại');
                    } else {
                        toastr.warning('Có lỗi xảy ra');
                    }
                });
        }
    }
    try {
        clear_hinhthuc();
        themtacgia();
    } catch { }

    function checknullhutech(i) {
        try {
            var inp = document.querySelector('#inp-username-id-mail-' + i).value;
            var donggop = document.querySelector('#donggop-' + i);
        } catch { }
        var option = document.querySelector('#coquancongtac-' + i);
        var coquancongtac = option.options[option.selectedIndex].textContent;
        if (inp == "" && coquancongtac == "Cơ quan công tác duy nhất Hutech (100%)") {
            toastr.warning('Vui lòng nhập mã NV HUTECH')
            option.options[0].selected = true;
        } else if (inp == "" && coquancongtac == "Hutech-Quốc tế (50%)") {
            toastr.warning('Vui lòng nhập mã NV HUTECH')
            option.options[0].selected = true;
        }
    }


    //Load tác giả table
    function themtacgia() {
        try {
            var a = ``;
            var sltgc = Number(document.querySelector('#sltgc').value);
            var sltgp = Number(document.querySelector('#sltgp').value);
            var sltglh = Number(document.querySelector('#sltglh').value);
            var valuerank = _ngach;
            var optionslh = document.querySelector('#loaiHinhKeKhai');
            var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
            var selectElement = document.getElementById("loaiCongTrinh");
            var selectedValue = selectElement.value;
            var selectedValueYc = document.querySelector('input[name="yc"]:checked').value;
            ////////alert(valueloaihinh);
            var sltg = sltgc + sltgp + sltglh;
        } catch { }
        let i = 0;
        //toastr.warning(valueloaihinh + valuerank);
        document.querySelector('#tbtacgia2').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
        <th width="2%">STT</th>
        <th width="15%">Mã nhân viên</th>
        <th width="15%">Cơ quan công tác</th>
        <th width="15%">Loại tác giả</th>
        <th width="10%">Tổng nhận trước thuế</th>
        <th width="10%">Thực nhận</th>
        <th width="5%">Điểm</th>
        <th width="5%">Tiết chuẩn</th>
        </thead>
        <tbody id="tablethanhtoan">
        </tbody>`;
        //document.querySelector('#tongtacgia').innerHTML = `<a>Tổng số tác giả: <a id="tongsltg">${sltg}</a></a>`;
        if ((sltgc == 1 && selectedValue == "DeTai" && valuerank.includes("GV")) || (sltgc == 1 && selectedValue == "HDNCKH" && valuerank.includes("GV"))) {
            //////alert(valueloaihinh + "//" + valuerank);
            if (selectedValueYc.includes("Seminar cấp Khoa, báo cáo chuyên đề cấp đơn vị")) {
                for (i = 0; i < sltgc; i++) {
                    a += `<tr><td>${i + 1}</td>
                       <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}"  class="form-control" disabled>
                             <option >Báo cáo viên</option>

                             </select></td></tr>`;
                }
                for (i; i < (sltgp + sltgc); i++) {
                    a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>
                             <option >Báo cáo viên</option>


                             </select>
                             </td>
                             </tr>`;
                } for (i; i < sltg; i++) {
                    a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option >Báo cáo viên</option></select>
                             </td></tr>`;
                }

                try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
            }
            else if (selectedValueYc.includes("Giảng viên đang học nghiên cứu sinh trong thời gian quy định, có báo cáo kết quả học tập và nghiên cứu trong năm học")) {
                for (i = 0; i < sltgc; i++) {
                    a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}"  class="form-control" disabled>
                             <option >GVHD</option>

                             </select></td></tr>`;
                }
                for (i; i < (sltgp + sltgc); i++) {
                    a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>
                             <option >Sinh viên</option>


                             </select>
                             </td>
                             </tr>`;
                } for (i; i < sltg; i++) {
                    a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option >Đồng GVHD</option></select>
                             </td></tr>`;
                }

                try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
            }
            else {
                for (i = 0; i < sltgc; i++) {
                    a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}"  class="form-control" disabled>
                             <option >Chủ nhiệm</option>

                             </select></td></tr>`;
                }
                for (i; i < (sltgp + sltgc); i++) {
                    a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>
                             <option >Thành viên</option>


                             </select>
                             </td>
                             </tr>`;
                } for (i; i < (sltgc + sltglh + sltgp); i++) {
                    a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option >Đồng chủ nhiệm</option></select>
                             </td></tr>`;
                }

                try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
            }

        }
        else if (sltgc == 1 && valueloaihinh == "Kê khai khối lượng" && valuerank.includes("GV")) {
            //////alert(valueloaihinh + "//" + valuerank);

            for (i = 0; i < sltgc; i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>
                             <option >Tác giả chính</option>
                             </select></td></tr>`;
            }
            for (i; i < (sltgp + sltgc); i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option>Tác giả phụ</option>
                             </td>
                             </tr>`;
            } for (i; i < (sltgc + sltglh + sltgp); i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option>Tác giả liên hệ</option>
                             </td></tr>`;
            }

            try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
        }
        ///
        else if (sltgc == 1 && valuerank.includes("NCV") && valueloaihinh == "Kê khai khối lượng") {
            //////alert(valueloaihinh + "//" + valuerank);
            for (i = 0; i < sltgc; i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH"   id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>
                             <option >Tác giả chính</option>
                             </select></td></tr>`;
            }
            for (i; i < (sltgp + sltgc); i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option>Tác giả phụ</option>
                             </td>
                             </tr>`;
            } for (i; i < (sltgc + sltglh + sltgp); i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option>Tác giả liên hệ</option>
                             </td></tr>`;
            }

            try { document.querySelector('#addtacgia').innerHTML = a; } catch { }

        }
        ///
        else if (sltgc == 1 && valueloaihinh == "Nghiên cứu mạnh" && valuerank.includes("GV")) {
            //////alert(valueloaihinh + "//" + valuerank);

            for (i = 0; i < sltgc; i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>
                             <option >Tác giả chính</option>
                             <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                             </select></td></tr>`;
            }
            for (i; i < (sltgp + sltgc); i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option>Tác giả phụ</option>
                             </td>
                             <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                             </tr>`;
            } for (i; i < (sltgc + sltglh + sltgp); i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option>Tác giả liên hệ</option>
                             <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                             </td></tr>`;
            }

            try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
        }
        else if (sltgc == 1 && valueloaihinh == "Nghiên cứu mạnh" && valuerank.includes("NCV")) {
            ////alert(valueloaihinh + "//" + valuerank);

            for (i = 0; i < sltgc; i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>
                             <option >Tác giả chính</option>
                             <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                             </select></td></tr>`;
            }
            for (i; i < (sltgp + sltgc); i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>
                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option>Tác giả phụ</option>
                             </td>
                             <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                             </tr>`;
            } for (i; i < (sltgc + sltglh + sltgp); i++) {
                a += `<tr><td>${i + 1}</td>
                        <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}"   oninput="inpsearch(${i},render_user)" />
                        <div id="themtg" style="display: flex">
                            <div width: 50%">
                                <dl id="dl-user-${i}">
                                </dl>
                            </div>
                        </div></td>
                        <td ><div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="coquancongtac-${i}" class="form-control">
                            <option value="0"> --Chọn cơ quan công tác--</option>

                            <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                            <option value="0.5">Hutech-Quốc tế (50%)</option>
                            <option value="0">Quốc tế - Hutech (0%)</option>
                            <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                        </select>
                    </div></td>
                        <td>
                        <div class="form-group">
                         <select name="coquancongtac" onchange="checknullhutech(${i})" id="tg-${i}" class="form-control" disabled>

                             <option>Tác giả liên hệ</option>
                             <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                             </td></tr>`;
            }

            try { document.querySelector('#addtacgia').innerHTML = a; } catch { }
        }
        else if (sltgc > 1) {
            toastr.warning("Duy nhất 1 tác giả chính!");
        }

    }

    //Hiển thị tác giả
    function render_user(users) {
        var sltgc = Number(document.querySelector('#sltgc').value);
        var sltgp = Number(document.querySelector('#sltgp').value);
        var sltglh = Number(document.querySelector('#sltglh').value);
        var sltg = sltgc + sltgp + sltglh;
        for (let i = 0; i < sltg; i++) {
            try {
                var tg = document.querySelector('#inp-username-id-mail-' + i);
                tg.oninput = function () {
                    var list = document.querySelector('#dl-user-' + i);
                    list.innerHTML = ``;
                    inpsearch(i, render_user);
                    var htmls = users.map(function (user) {
                        return `<dt value="${user.idUser}" style="border-style: groove;"><button onclick="btnadd('${i}','${user.idUser}','${user.hoTen}')" type="button" class="btn btn-success">Thêm tác giả </button>
${user.hoTen} - ${user.donViCongTac}</dt>`;
                    });
                    list.innerHTML = htmls.join('');
                }
            } catch { }
        }
    }
    // Thêm mã tên tác giả
    function btnadd(id, iduser, name) {
        var sltgc = Number(document.querySelector('#sltgc').value);
        var sltgp = Number(document.querySelector('#sltgp').value);
        var sltglh = Number(document.querySelector('#sltglh').value);
        var sltg = sltgc + sltgp + sltglh;

        var tg = document.querySelector('#inp-username-id-mail-' + id);
        tg.value = ``;
        if (tg.value == "") {
            document.querySelector('#dl-user-' + id).innerHTML = ``;
            tg.value = tg.value + iduser + " - " + name;
        }
        try {
            for (let i = 0; i > sltg; i++) {
                var tg1 = document.querySelector('#inp-username-id-mail-' + i);
                for (let j = 1; j > sltg; i++) {
                    var tg2 = document.querySelector('#inp-username-id-mail-' + j);
                    if (tg1 == tg2) {
                        //////alert("Trùng");
                    }
                }
            }
        } catch { }

        document.querySelector('#dl-user-' + id).innerHTML = ``;
        loadtable();
    }
    // Xử lý công thức tính ...

    // Tìm kiếm tác giả
    function inpsearch(idinput, callback) {
        try {
            var valueinp = document.querySelector('#inp-username-id-mail-' + idinput).value;

        } catch { }
        ////////alert(valueinp);
        if (valueinp == "") {
            document.querySelector('#dl-user-' + idinput).innerHTML = ``;
        }
        fetch("https://localhost:44364/api/NguoiDung/Get-user?input=" + valueinp, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })
            .then(function (response) {

                return response.json();
            })
            .then(callback)
    }
    ////////alert(_token);
    // Load table clear
    function clear_hinhthuc() {

        var valuerank = _ngach;
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
        //alert(valuerank + valueloaihinh);
        if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh") {
            //alert("a");
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                    <th width="2%">STT</th>
                    <th width="20%">Mã nhân viên</th>
                    <th width="20%">Cơ quan công tác</th>
                    <th width="10%">Loại tác giả</th>
                    <th width="7%">Đóng góp (%)</th>
                    </thead>

                    <tbody id="addtacgia" onchange="loadtable()">
                    </tbody>`;
            themtacgia();

        }
        else if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                    <th width="2%">STT</th>
                    <th width="20%">Mã nhân viên</th>
                    <th width="20%">Cơ quan công tác</th>
                    <th width="10%">Loại tác giả</th>
                    <th width="7%">Đóng góp (%)</th>
                    </thead>

                    <tbody id="addtacgia" onchange="loadtable()">
                    </tbody>`;
            themtacgia();

        }
        else if (valuerank.includes("GV") && valueloaihinh == "Kê khai khối lượng") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                    <th width="2%">STT</th>
                    <th width="20%">Mã nhân viên</th>
                    <th width="20%">Cơ quan công tác</th>
                    <th width="10%">Loại tác giả</th>
                    </thead>

                    <tbody id="addtacgia" onchange="loadtable()">
                    </tbody>`;
            themtacgia();
        } else if (valuerank.includes("GV") && valueloaihinh == "Đề tài") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                    <th width="2%">STT</th>
                    <th width="20%">Mã nhân viên</th>
                    <th width="20%">Cơ quan công tác</th>
                    <th width="10%">Loại tác giả</th>
                    </thead>

                    <tbody id="addtacgia" onchange="loadtable()">
                    </tbody>`;
            themtacgia();

        }
        else if (valuerank.includes("NCV") && valueloaihinh == "Kê khai khối lượng") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                    <th width="2%">STT</th>
                    <th width="20%">Mã nhân viên</th>
                    <th width="20%">Cơ quan công tác</th>
                    <th width="10%">Loại tác giả</th>
                    </thead>

                    <tbody id="addtacgia" onchange="loadtable()">
                    </tbody>`;
            themtacgia();
        }

    }
    function send(data, a) {
        var linksend = "https://localhost:44364/api/DanhMucXetDuyet/Send";
        var options = {
            method: 'POST',
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data),
        };
        fetch(linksend, options)
            .then(response => {
                if (response.ok) {
                    toastr.success('Đăng ký thành công', '');
                    window.location.href = '/NguoiDung/DeTai';
                    if (a == "lvtm") {

                    } else if (a == "lvt") {
                        window.location.href = '/NguoiDung/DeTai';
                    }
                } else if (response.status == 400) {

                    toastr.warning('Trùng tên bài báo');
                } else {

                    toastr.error('Liên hệ hỗ trợ.', 'Gặp lỗi!')

                }
            });
    }
    function update(data, idmm) {
        var linksend = "https://localhost:44364/api/DanhMucXetDuyet/Update/" + idmm;
        var options = {
            method: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data),
        };
        fetch(linksend, options)
            .then(response => {
                if (response.ok) {
                    toastr.success('Sửa thành công');
                    window.location.href = '/NguoiDung/DeTai';
                } else {
                    toastr.warning('Có lỗi');
                }
            });
    }
    function groupUser() {
        var table = document.getElementById("tbtacgia2");
        var groupUser = "";

        for (let i = 1; i < table.rows.length; i++) {
            const row = table.rows[i];

            for (let j = 0; j < row.cells.length; j++) {

                const cell = row.cells[j].textContent;
                if (cell == "") {
                    groupUser += cell + "Trống;";
                } else {
                    groupUser += cell + ";";
                }
            }

            groupUser = groupUser.slice(0, -1);
            groupUser += "$";
        }
        groupUser = groupUser.slice(0, -1);
        return groupUser;
    }
    ///////// Tính năng mới



    function handleSend(a, x) {
        //2 cái hàm ở trên, mấy cái session với vài chỗ trong cục data
        var trangthai = "";
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
        try {
            var a = document.querySelector('#tickthanhtoan');
            if (valueloaihinh == "Nghiên cứu mạnh" && a.checked == true) {
                trangthai = "Chưa thanh toán";
            } else if (valueloaihinh == "Nghiên cứu mạnh" && a.checked == false) {
                trangthai = "Đã thanh toán";
            } else {
                trangthai = "";
            }
        } catch { }
        /////
        var currentDateTime = new Date();
        currentDateTime.setHours(currentDateTime.getHours() + 7);
        var formattedDateTime = currentDateTime.toISOString().replace("T", " ").replace("Z", "");

        var date = currentDateTime.getDate();
        var month = currentDateTime.getMonth() + 1; // Tháng trong JavaScript đếm từ 0, nên cần +1
        var year = currentDateTime.getFullYear();

        var formattedDate = year + '-' + month.toString().padStart(2, '0') + '-' + date.toString().padStart(2, '0');
        var NguoiKhai = sessionStorage.getItem("NguoiKhai");
        var Khoa = sessionStorage.getItem("Khoa");
        var NguoiSua = sessionStorage.getItem("NguoiSua");
        var TrangthaiEdit = sessionStorage.getItem("TrangThaiThanhToan");
        var iddmxd = document.getElementById("iddmxd").value;
        var loaiHinhKeKhai = document.getElementById("loaiHinhKeKhai").value;
        try {
            var loaiCongtrinh = document.getElementById("loaiCongTrinh").value;
        } catch {
            var loaiCongtrinh = "";
        }
        try {
            var valuetype = document.querySelector('input[name="yc"]:checked').value;
        } catch {
            var valuetype = "";
        }
        var hoten = document.getElementById("xinchao").textContent;
        var soDOI = document.getElementById("sodoi").value;
        var minhchung = selectedFilesArray;
        var sltgc = Number(document.querySelector('#sltgc').value);
        var sltgp = Number(document.querySelector('#sltgp').value);
        var sltglh = Number(document.querySelector('#sltglh').value);
        var sltg = sltgc + sltgp + sltglh;
        var s = 0;
        for (let tiennum = 1; tiennum < sltg + 1; tiennum++) {
            tongtien = Number(document.querySelector('#tbtacgia2').rows[tiennum].cells[4].textContent);
            s += tongtien;
        }
        var date = document.querySelector('#datesubmit').value;
        var valuerank = _ngach;
        var valuetenbaibao = document.querySelector('#tenSanPhamKHCN').value;
        try {
            var valuecategory = document.querySelector('input[id="category-1"]:checked').value;
        } catch
        {
            try {
                var valuecategory = document.querySelector('input[name="category"]:checked').nextSibling.textContent;
            }
            catch {
                var valuecategory = document.querySelector('input[name="yc"]:checked').value;
            }
        }
        try { var valuelbname = document.querySelector('#lbname').textContent; } catch { var valuelbname = "" }
        try { var valuelbissn = document.querySelector('#lbissn').textContent; } catch {
            try { var valuelbissn = document.querySelector('#traCuuIssn').value; } catch { var valuelbissn = "" }
        }
        var total = document.querySelector('#totaltien').textContent;
        try { var valuelbeissn = document.querySelector('#lbeissn').textContent; } catch { var valuelbeissn = "" }
        var tg = groupUser();
        var ghichu = sessionStorage.getItem("GhiChu");
        ////alert(ghichu);
        ////alert(Khoa + " - " + hoten);
        ////////alert(loaiCongtrinh);
        if (iddmxd == "") {
            var data = {

                loaiHinhKeKhai: loaiHinhKeKhai,
                loaiCongtrinh: loaiCongtrinh,
                journal_name: valuelbname,
                issn: valuelbissn,
                eissn: valuelbeissn,
                category: valuecategory,
                citations: "",//Tên  người sửa
                if_2022: trangthai,
                jci: Khoa + " - " + hoten,
                percentageOAGold: "",
                userId: _idUser,
                rank: valuerank,
                imageTenBB: "",
                image: "",
                fileList: minhchung,
                link: soDOI,
                tenBaiBao: valuetenbaibao,
                type: valuetype,
                groupUser: tg,
                status: "Đang đợi duyệt",
                quantity: sltg.toString(),
                total: s.toString(),
                ghiChu: "",
                dateSubmit: date,
                dateSubmit_now: formattedDate
            }
        } else {
            var data = {
                idDanhMuc: iddmxd,
                loaiHinhKeKhai: loaiHinhKeKhai,
                loaiCongtrinh: loaiCongtrinh,
                journal_name: valuelbname,
                issn: valuelbissn,
                eissn: valuelbeissn,
                category: valuecategory,
                citations: NguoiSua + _idUser + "; ",
                if_2022: trangthai,
                jci: Khoa + " - " + hoten,
                percentageOAGold: "",
                userId: NguoiKhai,
                rank: valuerank,
                imageTenBB: "",
                image: "",
                fileList: minhchung,
                link: soDOI,
                tenBaiBao: valuetenbaibao,
                type: valuetype,
                groupUser: tg,
                status: "Đang đợi duyệt",
                quantity: sltg.toString(),
                total: s.toString(),
                ghiChu: ghichu.toString(),
                dateSubmit: date,
                dateSubmit_now: formattedDate

            }
        }

        if (articleId == "") {
            send(data, a);
        } else {
            update(data, iddmxd);
        }

    }

    // Hàm k cần enter khi tra mã
    async function clickinp() {
        var isIssn = document.getElementById("isIssn");
        isIssn.innerHTML = ``;
        await Get_issn(renderGet_issn);
    }

    function formatCurrency(amount) {
        var formatter = new Intl.NumberFormat('vi-VN', {
            style: 'currency',
            currency: 'VND'
        });

        return formatter.format(amount);
    }
    // Chặn thoát
    function closeModal() {
        $('#modal-xl-create').modal('hide');
  }
</script>
<script src="~/Scripts/toastr.js"></script>
