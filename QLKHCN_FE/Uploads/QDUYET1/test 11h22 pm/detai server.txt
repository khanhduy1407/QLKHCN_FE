@{
    ViewBag.Title = "Đề Tài";
    Layout = "~/Views/Shared/_LayoutUserPage.cshtml";
}

<style>
    input[readonly] {
        background-color: #f8f8f8; /* Màu nền chỉ đọc */
        cursor: not-allowed; /* Biểu tượng con trỏ chỉ đọc */
    }
</style>
<div class="all">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">SẢN PHẨM KHOA HỌC CÔNG NGHỆ</h3>
        </div>

        <!-- /.card-header -->
        <div class="card-header">
            <div class="col-md-12 d-flex justify-content-between">
                @*<input class="btn btn-success btn-sm " id="signdt" type="submit" value="KÊ KHAI KHỐI LƯỢNG NCKH" onclick="location.href='/Article/Index'">*@
                <button type="button" class="btn btn btn-success" data-toggle="modal" data-target="#modal-xl-create">THÊM MỚI</button>
                <div class="btn-group">
                    <button type="button" class="btn btn btn-warning dropdown-toggle dropdown-icon" data-toggle="dropdown" aria-expanded="false">
                        <span>EXPORT EXCEL</span>
                    </button>

                    <div class="dropdown-menu" role="menu" style="">
                        <a class="dropdown-item" onclick="ExportToExcelDeTaiUser(1)" href="#">Nhóm Nghiên Cứu Mạnh</a>
                        <a class="dropdown-item" onclick="ExportToExcelDeTaiUser(2)" href="#">Khoa/Viện</a>
                        <a class="dropdown-item" onclick="ExportToExcelDeTaiUser(3)" href="#">Trường</a>
                        <a class="dropdown-item" onclick="ExportToExcelDeTaiUser(4)" href="#">Nghiên Cứu Viên</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <p class="text-danger mb-0 "></p>
        </div>

        <div class="card-body">
            <table id="example1" class="table table-bordered table-striped ">
                <thead style="background-color: #007bff; color: white">
                    <tr>
                        <th>ID</th>
                        <th>STT</th>
                        <th>Tên công trình</th>
                        <th>Tên tạp chí/NXB</th>
                        <th>Đóng góp</th>
                        <th>Tiền</th>
                        <th>Tiết chuẩn</th>
                        <th>Điểm</th>
                        <th>Trạng thái</th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="5" style="text-align:right">
                            Tổng
                        </td>
                        <td id="tongTien"></td>
                        <td id="tongTietChuan"></td>
                        <td id="tongDiem"></td>
                        <td colspan="3"></td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <!-- /.card-body -->
    </div>
</div>
<div class="modal fade" id="modal-xl" data-backdrop="static">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-body">
                <ul class="nav nav-tabs" id="custom-content-above-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="custom-content-above-home-tab" data-toggle="pill" href="#custom-content-above-home" role="tab" aria-controls="custom-content-above-home" aria-selected="true">Thông tin</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="custom-content-above-profile-tab" data-toggle="pill" href="#custom-content-above-profile" role="tab" aria-controls="custom-content-above-profile" aria-selected="false">Tác giả</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="custom-content-above-messages-tab" data-toggle="pill" href="#custom-content-above-messages" role="tab" aria-controls="custom-content-above-messages" aria-selected="false">Minh Chứng</a>
                    </li>
                </ul>
                <div class="tab-content" id="custom-content-above-tabContent">
                    <div class="tab-pane fade show active" id="custom-content-above-home" role="tabpanel" aria-labelledby="custom-content-above-home-tab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">THÔNG TIN ĐĂNG KÝ BÀI BÁO</h3>
                            </div>
                            <!-- /.card-header -->
                            <!-- form start -->
                            <form>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-6">
                                            <input type="hidden" class="form-control" id="idDanhMuc">
                                            <div class="form-group">
                                                <label for="tenBaiBao">Tên bài báo</label>
                                                <input type="text" class="form-control" disabled id="tenBaiBao">
                                            </div>
                                            <div class="form-group">
                                                <label for="type">type</label>
                                                <input type="text" class="form-control" disabled id="type">
                                            </div>
                                            <div class="form-group">
                                                <label for="issn">issn</label>
                                                <input type="text" class="form-control" disabled id="issn">
                                            </div>
                                            <div class="form-group">
                                                <label for="eissn">eissn</label>
                                                <input type="text" class="form-control" disabled id="eissn">
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label for="rank">rank</label>
                                                <select class="custom-select" id="rank" disabled>
                                                    <option value="GV">Giảng viên</option>
                                                    <option value="NCV">Nghiên cứu viên</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label for="total">total</label>
                                                <input type="text" class="form-control" disabled id="total2">
                                            </div>
                                            <div class="form-group">
                                                <label for="dateSubmit">Ngày gửi</label>
                                                <input type="datetime" class="form-control" id="dateSubmit" disabled>
                                            </div>
                                            <div class="form-group" id="status-quyen">
                                                <label for="status">Status</label>
                                                <input type="text" class="form-control" disabled id="status">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-12">
                                            <div class="form-group">
                                                <label for="ghiChu">Ghi chú</label>
                                                <textarea type="text" class="form-control" disabled id="ghiChu"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- /.card-body -->
                            </form>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="custom-content-above-profile" role="tabpanel" aria-labelledby="custom-content-above-profile-tab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">KÊ KHAI TÁC GIẢ</h3>
                            </div>
                            <!-- /.card-header -->
                            <div class="card-body">
                                <table id="tbtacgia" class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>Stt</th>
                                            <th>MaNV - Họ tên</th>
                                            <th>Cơ quan công tác</th>
                                            <th>Loại tác giả</th>
                                            <th>Tổng nhận trước thuế</th>
                                            <th>Thực nhận</th>
                                            <th>Điểm</th>
                                            <th>Tiết chuẩn</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                            <!-- /.card-body -->
                        </div>
                    </div>
                    <div class="tab-pane fade" id="custom-content-above-messages" role="tabpanel" aria-labelledby="custom-content-above-messages-tab">
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title">MINH CHỨNG</h3>
                            </div>
                            <!-- /.card-header -->
                            <!-- form start -->
                            <form>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label>Số DOI: </label>
                                        <a href="#" target="_blank" id="link">#</a>
                                    </div>

                                    <div class="form-group">
                                        <label for="image">Ảnh: </label>
                                        <div id="image"></div>
                                        <div id="file"></div>
                                        @*<img id="image" class="img-fluid mb-2" src="#" alt="Minh chứng">*@
                                    </div>
                                </div>
                                <!-- /.card-body -->
                            </form>
                        </div>
                    </div>
                </div>
                <!-- /.card -->
            </div>
            <div class="modal-footer justify-content-between">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<div class="modal fade" id="modal-xl-create">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-body">
                <div class="card card-default">
                    <div class="card-header">
                        <h3 class="card-title">KÊ KHAI KHỐI LƯỢNG NGHIÊN CỨU KHOA HỌC</h3>
                    </div>
                    <div class="card-body p-0">
                        <div class="bs-stepper" id="myStepper">
                            <div class="bs-stepper-header" role="tablist">
                                <!-- your steps here -->
                                <div class="step" data-target="#logins-part">
                                    <button type="button" class="step-trigger" role="tab" aria-controls="logins-part" id="logins-part-trigger">
                                        <span class="bs-stepper-circle">1</span>
                                        <span class="bs-stepper-label">Thông tin sản phẩm</span>
                                    </button>
                                </div>
                                <div class="line"></div>
                                <div class="step" data-target="#information-part">
                                    <button type="button" class="step-trigger" role="tab" aria-controls="information-part" id="information-part-trigger">
                                        <span class="bs-stepper-circle">2</span>
                                        <span class="bs-stepper-label">Nhập thông tin tác giả</span>
                                    </button>
                                </div>
                            </div>
                            <div class="bs-stepper-content">
                                <!-- your steps content here -->
                                <div id="logins-part" class="content" role="tabpanel" aria-labelledby="logins-part-trigger">
                                    <div class="form-group row">
                                        <label class="col-form-label" for="tenSanPhamKHCN">Tên sản phẩm KHCN*:</label>
                                        <input type="text" class="form-control col" id="tenSanPhamKHCN" placeholder="Tạp chí, bài báo, sách, kỷ yếu..." style="margin-left:2%">
                                    </div>
                                    <div class="row">
                                        <div class="form-group col row">
                                            <label class="col-form-label" for="ngayCongBo">Ngày công bố*</label>
                                            <input id="datesubmit" type="date" placeholder="Ngày đăng bài" class="form-control col" style="margin-left:6%" />
                                        </div>
                                        <div class="form-group col row" style="margin-left:2%">
                                            <label class="col-form-label" for="sodoi">Số DOI:</label>
                                            <input type="text" class="form-control col" id="sodoi" placeholder="Nhập số DOI" style="margin-left:6%">
                                        </div>
                                        <div class="form-group col row" style="margin-left:2%">
                                            <input type="text" class="form-control col-7" id="myFile" name="myFile" readonly />
                                            <input type="button" class="form-control col-5" value="Tải minh chứng" onclick="BrowseServer('myFile')" />
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="form-group col-10 row">
                                            <div class="form-check col">
                                                <input class="form-check-input" type="radio" id="btn_Cissn" name="radioIssn" value="Cissn" onclick="click_radioIssn()">
                                                <label for="btn_Cissn" class="form-check-label">Bài báo thuộc WoS, Scopus và HĐCDGSNN</label>
                                            </div>
                                            <div class="form-check col">
                                                <input class="form-check-input" type="radio" id="btn_Kissn" name="radioIssn" value="Kissn" onclick="click_radioIssn()">
                                                <label for="btn_Kissn" class="form-check-label">Các loại sản phẩm khác (sách, kỷ yếu, giải thưởng, seminar...)</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group row" id="input_issn" style="display:none">
                                        <label class="col-form-label" for="traCuuIssn">Tra cứu danh mục tạp chí*</label>
                                        <input type="text" class="form-control col" id="traCuuIssn" placeholder="Nhập mã ISSN và nhấn Enter để tra cứu" style="margin-left:2%">
                                    </div>
                                    <div id="isIssn" style="display:none">
                                    </div>

                                    <div class="row" id="choose_lh" style="display:none">
                                        <div class="form-group col row">
                                            <label class="col-form-label" for="traCuuIssn">Chọn loại hình kê khai</label>
                                            <select class="custom-select col-4" id="loaiHinhKeKhai" style="margin-left:4%">
                                                <option value="KKKL" selected>Kê khai khối lượng</option>
                                                <option value="NCM">Nghiên cứu mạnh</option>
                                                <option value="DT">Đề tài</option>
                                            </select>
                                        </div>
                                        <div class="col" id="chonLoaiCongTrinh" style="display:none">
                                        </div>
                                    </div>

                                    <div id="noIssn" style="display:none">
                                    </div>
                                    <div id="ketqua" style="display:none">
                                    </div>
                                    <div class="row" style="display: flex; justify-content: flex-end;">
                                        <button class="btn btn-success" onclick="check_result()">TIẾP TỤC</button>
                                    </div>
                                </div>
                                <div id="information-part" class="content" role="tabpanel" aria-labelledby="information-part-trigger">
                                    <div class="row">
                                        <div class="form-group col-3 row">
                                            <label class="col-form-label" for="sltgc">Tác giả đầu</label>
                                            <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng tác giả chính" id="sltgc" disabled value="1" min="1" max="1" oninput="clear_hinhthuc()" />
                                        </div>
                                        <div class="form-group col row" style="margin-left:2%">
                                            <label class="col-form-label" for="sltgp">Số lượng tác giả phụ</label>
                                            <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng tác giả phụ" id="sltgp" min="1" oninput="clear_hinhthuc()" />
                                        </div>
                                        <div class="form-group col row" style="margin-left:2%">
                                            <label class="col-form-label" for="sltglh">Số lượng tác giả liên hệ</label>
                                            <input class="form-control col" style="margin-left:6%" type="number" placeholder="Số lượng tác giả liên hệ" id="sltglh" min="1" oninput="clear_hinhthuc()" />
                                        </div>
                                    </div>

                                    <div class="form-group col-2" id="tongtacgia">
                                    </div>
                                    <div class="card">
                                        <div class="card-header">
                                            <h3 class="card-title">THÔNG TIN TÁC GIẢ</h3>
                                        </div>
                                        @*<style>
                                                table, th, td {
                                                    border: 1px solid black;
                                                }

                                                th {
                                                    background-color: #17a2b8;
                                                    color: white;
                                                }
                                            </style>*@
                                        <table class="table table-bordered table-striped" style="width:100%" id="tbtacgiasl">
                                        </table>
                                        <table class="table table-bordered table-striped" style="width:100%" id="tbtacgia2">
                                            <tbody id="addtacgia" onchange="loadtable()">
                                            </tbody>
                                        </table>
                                    </div>

                                    <button class="btn btn-success" onclick="stepper.previous()">VỀ TRƯỚC</button>
                                    <!--<input class="btn btn-info" id="inpsearchs" type="submit" value="Xác nhận gửi" onclick="handleSend()" style="margin-left:2%">-->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /.card-body -->
                </div>
                <div class="modal-footer justify-content-between">
					<a class="btn btn-outline-danger" href="@Url.Action("DeTai","NguoiDung")">THOÁT </a>
                    <button type="button" class="btn btn btn-primary" style="margin-left:-62%" onclick="handleSend('lvt')">LƯU VÀ THOÁT</button>
                        <button type="button" class="btn btn btn-primary"   onclick="luuVaThemMoi()">LƯU VÀ THÊM MỚI</button>
                    </div>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
</div>

<script>
    function luuVaThemMoi() {
        handleSend("lvtm");
        document.getElementById("tenSanPhamKHCN").value = "";
        document.getElementById('datesubmit').value = document.getElementById('datesubmit').defaultValue;
        document.getElementById("sodoi").value = "";
        document.getElementById("myFile").value = "";
        document.getElementById('btn_Cissn').checked = false;
        document.getElementById('btn_Kissn').checked = false;
        document.querySelector('#isIssn').innerHTML = ``;
        document.querySelector('#noIssn').innerHTML = ``;
        document.querySelector('#ketqua').innerHTML = ``;
        document.querySelector('#traCuuIssn').value = "";
        var input_issn = document.getElementById("input_issn");
        var choose_lh = document.querySelector('#choose_lh');
        var chonLoaiCongTrinh = document.querySelector('#chonLoaiCongTrinh');
        input_issn.style.display = "none";
        choose_lh.style.display = "none";
        chonLoaiCongTrinh.style.display = "none";
        stepper.previous();
    }
    function check_result() {
        var date = document.querySelector('#datesubmit').value;
        var tenspkhcn = document.querySelector('#tenSanPhamKHCN').value;
        var link = document.querySelector('#sodoi').value;
        var linkimage = document.querySelector('#myFile').value;
        try {
            var valuecategory = document.querySelector('input[id="category-1"]:checked').value;
        } catch
        {
            try {
                var valuecategory = document.querySelector('input[name="category"]:checked').value;
            }
            catch {
                try {
                    var valuecategory = document.querySelector('input[name="yc"]:checked').value;

                } catch {
                    var valuecategory = "";
                }
            }
        }
        try {
            var kinhphi = document.querySelector('#totaltien').textContent;

        } catch {
            var kinhphi = "";
        }
        if (tenspkhcn == "") {
            return alert("Vui lòng nhập tên sản phẩm!");

        }
        if (date == "") {
            return alert("Vui lòng chọn ngày công bố sản phẩm!");

        }
        if (linkimage == "") {
            return alert("Vui lòng nhập minh chứng!");

        }
        if (valuecategory == "") {
            return alert("Vui lòng tra cứu hoặc chọn loại hình sản phẩm!");

        }else {
            stepper.next()
        }
    }
    function click_radioIssn() {
        document.querySelector('#isIssn').innerHTML = ``;
        document.querySelector('#noIssn').innerHTML = ``;
        document.querySelector('#ketqua').innerHTML = ``;
        document.querySelector('#traCuuIssn').value = "";
        var input_issn = document.getElementById("input_issn");
        var choose_lh = document.querySelector('#choose_lh');
        var chonLoaiCongTrinh = document.querySelector('#chonLoaiCongTrinh');
        var issn = document.querySelector('input[name="radioIssn"]:checked').value;
        if (issn == "Cissn") {
            input_issn.style.display = "flex";
            choose_lh.style.display = "flex";
            chonLoaiCongTrinh.style.display = "none";

        } if (issn == "Kissn") {
            input_issn.style.display = "none";
            choose_lh.style.display = "flex";
            chonLoaiCongTrinh.style.display = "flex";
        }
    }

    document.addEventListener('DOMContentLoaded', function () {        
        // BS-Stepper Init
        window.stepper = new Stepper(document.querySelector('.bs-stepper'))
        // Khi modal mở
        $('#modal-xl-create').on('shown.bs.modal', function () {
            // hiện thị chọn loại hình kê khai

            var selectLoaiHinhKeKhai = document.getElementById("loaiHinhKeKhai");
            var rank = _ngach;
            var options = selectLoaiHinhKeKhai.options;
            for (var i = 0; i < options.length; i++) {
                var option = options[i];
                if (rank === "GV") {
                    option.style.display = "block";
                } else if (rank === "NCV" && option.value !== "DT") {
                    option.style.display = "block";
                } else {
                    option.style.display = "none";
                }
            }
        });
    })
    //xử lý tìm issn
    function Get_issn(callback) {
        var inputSearch = document.getElementById("traCuuIssn").value;
        if (inputSearch == "") {
            /*alert("empty");*/
        } else {
            fetch("https://localhost:5001/api/DanhMuc/Get-issn?issn=" + inputSearch, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (response) {
                    if (response.status == 404) {
                        fetch("https://localhost:5001/api/DanhMuc/Get-eissn?eissn=" + inputSearch, {
                            headers: {
                                'Authorization': 'Bearer ' + _token,
                                'Content-Type': 'application/json'
                            }
                        }).then(function (res) {
                            if (res.status == 404) {
                                fetch("https://localhost:5001/api/DanhMucScimago/Get-issn?issn=" + inputSearch, {
                                    headers: {
                                        'Authorization': 'Bearer ' + _token,
                                        'Content-Type': 'application/json'
                                    }
                                })
                                    .then(function (res2) {
                                        if (res2.status == 404) {
                                            fetch("https://localhost:5001/api/DanhMucScimago/Get-eissn?eissn=" + inputSearch, {
                                                headers: {
                                                    'Authorization': 'Bearer ' + _token,
                                                    'Content-Type': 'application/json'
                                                }
                                            })
                                                .then(function (res3) {
                                                    if (res3.status == 404) {
                                                        fetch("https://localhost:5001/api/DanhMucTrongNuoc/Get-DanhMucTrongNuoc?issn=" + inputSearch, {
                                                            headers: {
                                                                'Authorization': 'Bearer ' + _token,
                                                                'Content-Type': 'application/json'
                                                            }
                                                        })
                                                            .then(function (res4) {
                                                                if (res4.status == 404) {
                                                                    alert("Không tim thấy sản phẩm trong ISI, Scopus, HĐCDGSNN!");
                                                                    document.querySelector('#ketqua').innerHTML = ``;
                                                                    document.querySelector('#btn_Kissn').checked = true;
                                                                    click_radioIssn();
                                                                } else {
                                                                    return res4.json();

                                                                }
                                                            })
                                                            .then(callback)
                                                    }
                                                    else {
                                                        return res3.json();
                                                    }

                                                })
                                                .then(callback)
                                        }
                                        else {
                                            return res2.json();
                                        }
                                    })
                                    .then(callback)
                            }
                            else {
                                return res.json();
                            }

                        }).then(callback)

                    }
                    else {
                        return response.json();
                    }
                })
                .then(callback)
        }
    }
    function renderGet_issn(issns) {

        if (issns == undefined) {

        }
        else {
            var htmls = issns.map(function (issn) {
                if (issn != null) {

                }
                if (issn.hoidongnganh != undefined) {
                    var diem = Number(issn.diem);
                    var isIssn = document.getElementById("isIssn");
                    isIssn.style.display = "block";
                    isIssn.style.pointerEvents = "unset";
                    return `
                                            <input onclick="render_kinhphi('${diem}')" type="radio" class="radio-result" id="category-${issn.id}" name="category" value="${diem}">
                                            <label for="category-${issn.id}">${issn.tentapchi} (${issn.hoidongnganh})</label></br>
                                            `;
                }
                else {
                    if (issn.category_6 == null) {
                        if (issn.category_5 == null) {
                            if (issn.category_4 == null) {
                                if (issn.category_3 == null) {
                                    if (issn.category_2 == null) {
                                        return `
                                                        <label>Tên danh mục: <label id="lbname">${issn.journal_name}</label></label>
                                                        <label>Issn: <label id="lbissn">${issn.issn}</label></label>
                                                        <label>Eissn: <label  id="lbeissn">${issn.eissn}</label></label><br />
                                                        <input type="radio" class="radio-result" id="category-1" name="category" value="${issn.category_1}" checked="true">
                                                        <label for="category-1">${issn.category_1}</label>
                                                        `;
                                    }
                                    return `
                                                    <label>Tên danh mục: <label id="lbname">${issn.journal_name}</label></label>
                                                    <label>Issn: <label id="lbissn">${issn.issn}</label></label>
                                                    <label>Eissn: <label  id="lbeissn">${issn.eissn}</label></label><br />
                                                    <input type="radio" class="radio-result" id="category-1" name="category" value="${issn.category_1}" checked="true">
                                                    <label for="category-1">${issn.category_1}</label><br>
                                                    <input type="radio" class="radio-result" id="category-2" name="category" value="${issn.category_2}">
                                                    <label for="category-2">${issn.category_2}</label>
                                                    `;
                                }
                                return `
                                                <label>Tên danh mục: <label id="lbname">${issn.journal_name}</label></label>
                                                <label>Issn: <label id="lbissn">${issn.issn}</label></label>
                                                <label>Eissn: <label id="lbeissn">${issn.eissn}</label></label><br />
                                                <input type="radio" class="radio-result" id="category-1" name="category" value="${issn.category_1}" checked="true">
                                                <label for="category-1">${issn.category_1}</label><br />
                                                <input type="radio" class="radio-result" id="category-2" name="category" value="${issn.category_2}">
                                                <label for="category-2">${issn.category_2}</label><br />
                                                <input type="radio" class="radio-result" id="category-3" name="category" value="${issn.category_3}">
                                                <label for="category-3">${issn.category_3}</label><br />
                                                `;
                            }
                            return `
                                            <label>Tên danh mục: <label id="lbname">${issn.journal_name}</label></label>
                                            <label>Issn: <label id="lbissn" >${issn.issn}</label></label>
                                            <label>Eissn: <label  id="lbeissn" >${issn.eissn}</label></label><br />
                                            <input type="radio" class="radio-result" id="category-1" name="category" value="${issn.category_1}" checked="true">
                                            <label for="category-1">${issn.category_1}</label><br />
                                            <input type="radio" class="radio-result" id="category-2" name="category" value="${issn.category_2}">
                                            <label for="category-2">${issn.category_2}</label><br />
                                            <input type="radio" class="radio-result" id="category-3" name="category" value="${issn.category_3}">
                                            <label for="category-3">${issn.category_3}</label><br />
                                            <input type="radio" class="radio-result" id="category-4" name="category" value="${issn.category_4}">
                                            <label for="category-4">${issn.category_4}</label>
                                            `;
                        }
                        return `
                                        <label>Tên danh mục: <label id="lbname">${issn.journal_name}</label></label>
                                        <label>Issn: <label id="lbissn">${issn.issn}</label></label>
                                        <label>Eissn: <label id="lbeissn">${issn.eissn}</label></label><br />
                                        <input type="radio" class="radio-result" id="category-1" name="category" value="${issn.category_1}" checked="true">
                                        <label for="category-1">${issn.category_1}</label><br />
                                        <input type="radio" class="radio-result" id="category-2" name="category" value="${issn.category_2}">
                                        <label for="category-2">${issn.category_2}</label><br />
                                        <input type="radio" class="radio-result" id="category-3" name="category" value="${issn.category_3}">
                                        <label for="category-3">${issn.category_3}</label><br />
                                        <input type="radio" class="radio-result" id="category-4" name="category" value="${issn.category_4}">
                                        <label for="category-4">${issn.category_4}</label>
                                        <input type="radio" class="radio-result" id="category-5" name="category" value="${issn.category_5}">
                                        <label for="category-5">${issn.category_5}</label>
                                        `;
                    } else {
                        return `
                                        <label>Tên danh mục: <label id="lbname">${issn.journal_name}</label></label>
                                        <label>Issn: <label id="lbissn">${issn.issn}</label></label>
                                        <label>Eissn: <label id="lbeissn">${issn.eissn}</label></label><br />
                                        <input type="radio" class="radio-result" id="category-1" name="category" value="${issn.category_1}" checked="true">
                                        <label for="category-1">${issn.category_1}</label><br />
                                        <input type="radio" class="radio-result" id="category-2" name="category" value="${issn.category_2}">
                                        <label for="category-2">${issn.category_2}</label><br />
                                        <input type="radio" class="radio-result" id="category-3" name="category" value="${issn.category_3}">
                                        <label for="category-3">${issn.category_3}</label><br />
                                        <input type="radio" class="radio-result" id="category-4" name="category" value="${issn.category_4}" ">
                                        <label for="category-4">${issn.category_4}</label><br />
                                        <input type="radio" class="radio-result" id="category-5" name="category" value="${issn.category_5}">
                                        <label for="category-5">${issn.category_5}</label><br />
                                        <input type="radio" class="radio-result" id="category-6" name="category" value="${issn.category_6}">
                                        <label for="category-5">${issn.category_6}</label><br />
                                        `;
                    }
                    var isIssn = document.getElementById("isIssn");
                    isIssn.style.display = "block";
                    isIssn.style.pointerEvents = "none";
                }
            });
            var isIssn = document.getElementById("isIssn");
            isIssn.style.display = "block";
            isIssn.innerHTML = htmls.join('');
        }
        try {
            var q = document.querySelector('input[name="category"]:checked').value;
            render_kinhphi(q);
        } catch { }
    }
    var input = document.getElementById("traCuuIssn");
    input.addEventListener("keypress", function (event) {
        if (event.key === "Enter") {
            var isIssn = document.getElementById("isIssn");
            isIssn.innerHTML = ``;
            Get_issn(renderGet_issn);
        }
    });

    //
    /*var radios = document.getElementsByName("category");
    for (var i = 0; i < radios.length; i++) {
        radios[i].addEventListener("change", function () {
            render_kinhphi(Event.value);
        });
    }*/
    function render_kinhphi(q) {

        var noIssn = document.getElementById("noIssn");
        var chonLoaiCongTrinh = document.getElementById("chonLoaiCongTrinh");
        noIssn.style.display = "none";

        var ketqua = document.getElementById("ketqua");
        ketqua.innerHTML = ``;
        var valueloaihinh = document.getElementById("loaiHinhKeKhai").value;
        if (valueloaihinh == "KKKL") {
            if (q.includes("Q1")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">120</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">30</label>`;
            } else if (q.includes("Q2")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">110</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">27.5</label>`;
            } else if (q.includes("Q3")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">100</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">25</label>`;
            } else if (q.includes("Q4")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">90</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">22.5</label>`;
            } else if (q == "Q1" || q == "Q2" || q == "Q3") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:  </label ><label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">60</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            } else if (q == "Q4") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">0</label>`;
            } else {
                ketqua.style.display = "block";
                ketqua.innerHTML = `
                            <label>Kinh phí bài báo:</label> <label id="totaltien">0</label>
                            <label>Tiết chuẩn:</label> <label id="tietchuan">${q * 60}</label>
                            <label>Điểm hoàn thành:</label><label id="diem">${q * 15}</label>`;
            }
        }
        if (valueloaihinh == "NCM") {
            if (q.includes("Q1")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label>Kinh phí bài báo:</label><label id="totaltien">100000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">30</label>`;
            } else if (q.includes("Q2")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">80000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">27.5</label>`;
            } else if (q.includes("Q3")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">60000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">25</label>`;
            } else if (q.includes("Q4")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label ><label id="totaltien">40000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">22.5</label>`;
            } else if (q == "Q1" || q == "Q2" || q == "Q3") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">24000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            } else if (q == "Q4") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">0</label>`;
            } else {
                var tien = 0;
                if (1 == 1) {
                    tien = 15000000;
                } else if (q < 1) {
                    tien = 10000000;
                } else {
                    tien = 18000000;
                }
                ketqua.style.display = "block";
                ketqua.innerHTML = `
                            <label>Kinh phí bài báo:</label> <label id="totaltien">${tien}</label>
                            <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                            <label>Điểm hoàn thành:</label><label id="diem">${q * 15}</label>`;
            }
            
        }
        if (valueloaihinh == "DT") {
            if (q.includes("Q1")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label>Kinh phí bài báo:</label><label id="totaltien">100000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">30</label>`;
            } else if (q.includes("Q2")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">80000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">27.5</label>`;
            } else if (q.includes("Q3")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">60000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">25</label>`;
            } else if (q.includes("Q4")) {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo: </label ><label id="totaltien">40000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">22.5</label>`;
            } else if (q == "Q1" || q == "Q2" || q == "Q3") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">24000000</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">15</label>`;
            } else if (q == "Q4") {
                ketqua.style.display = "block";
                ketqua.innerHTML = ` <label> Kinh phí bài báo:</label > <label id="totaltien">0</label>
                                        <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm hoàn thành:</label><label id="diem">0</label>`;
            } else {
                var tien = 0;
                if (1 == 1) {
                    tien = 15000000;
                } else if (q < 1) {
                    tien = 10000000;
                } else {
                    tien = 18000000;
                }
                ketqua.style.display = "block";
                ketqua.innerHTML = `
                            <label>Kinh phí bài báo:</label> <label id="totaltien">${tien}</label>
                            <label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                            <label>Điểm hoàn thành:</label><label id="diem">${q * 15}</label>`;
            }

        }

    }

    //hiển thị chọn loại công trình
    var selectLoaiHinhKeKhai = document.getElementById("loaiHinhKeKhai");
    var chonLoaiCongTrinh = document.getElementById("chonLoaiCongTrinh");
    loadLoaiCongTrinh({ target: selectLoaiHinhKeKhai })
    selectLoaiHinhKeKhai.addEventListener("change", loadLoaiCongTrinh);
    function loadLoaiCongTrinh(event) {
        document.getElementById("ketqua").innerHTML = ``;
        try {
            clear_hinhthuc();
            themtacgia();
        } catch { }
        var inputIssn = document.getElementById("traCuuIssn").value;
        if (inputIssn != null) {
            try {
                var lbname = document.getElementById("lbname").textContent;
            } catch {
                var lbname = "";
            }
            if (lbname == "") {
                try {
                    var selectTrongNuoc = document.querySelector('input[name="category"]:checked').value;                   
                    render_kinhphi(selectTrongNuoc);
                }
                catch { }

            } else {
                try {
                    Get_issn(renderGet_issn);
                } catch {

                }

            }

        }
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
        try {
            var category = (document.querySelector('input[id="category-1"]:checked').value);
            if (valueloaihinh == "Kê khai khối lượng") {
                if (category.includes("Q1")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">120</label>
                                    <label>Điểm:</label><label id="diem">30</label>
                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;
                }
                if (category.includes("Q2")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">110</label>
                                    <label>Điểm:</label><label id="diem">27.5</label>
                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category.includes("Q3")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">100</label>
                                    <label>Điểm:</label><label id="diem">25</label>                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category.includes("Q4")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">90</label>
                                    <label>Điểm:</label><label id="diem">22.5</label>                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category == "Q1" || category == "Q2" || category == "Q3") {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">60</label>
                                    <label>Điểm:</label><label id="diem">15</label>                                    <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
            }
        } catch { }

        document.getElementById("noIssn").innerHTML = ``;
        //document.getElementById("ketqua").innerHTML = ``;
        var lhkk = event.target.value;
        var rank = _ngach;
        if (rank === "GV") {
            if (lhkk === "KKKL") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="Sach">Sách</option>
                                        <option value="DeTai">Đề tài NCKH/ Seminar</option>
                                        <option value="TapChi">Hội nghị/ Tạp chí</option>
                                        <option value="HDNCKH">Hướng dẫn sinh viên</option>
                                        <option value="SHTT">Sở hữu trí tuệ</option>
                                        <option value="NgheThuat">Sản phẩm nghệ thuật</option>
                                    </select>
                                </div>`;
            } else if (lhkk === "NCM") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="BaiBao">Bài báo</option>
                                        <option value="SPK">Sản phẩm khác</option>
                                    </select>
                                </div>`;
            }
            else if (lhkk === "DT") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="BaiBaoQT">Bài báo quốc tế</option>
                                        <option value="BaiBao_CSP">Bài báo trong nước</option>
                                        <option value="SPUD">Sản phẩm ứng dụng</option>
                                    </select>
                                </div>`;
            }

        } else if (rank === "NCV") {
            if (lhkk === "KKKL") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="BaiBao">Bài báo</option>
                                        <option value="Sach">Sách/chương sách</option>
                                        <option value="SPK">Sản phẩm khác</option>
                                    </select>
                                </div>`;
            } else if (lhkk === "NCM") {
                chonLoaiCongTrinh.innerHTML = `
                                <div class="form-group row">
                                    <label class="col-form-label" for="loaiCongTrinh">Chọn loại công trình</label>
                                    <select onchange="changeLoaiCongTrinh()" class="custom-select col-6" id="loaiCongTrinh" style="margin-left:4%">
                                        <option value="" selected >Chọn loại công trình</option>
                                        <option value="BaiBao">Bài báo</option>
                                        <option value="SPK">Sản phẩm khác</option>
                                    </select>
                                </div>`;
            }
        }
        //render_kinhphi();
    }

    //chọn loại công trình

    function changeLoaiCongTrinh() {
        document.getElementById("ketqua").innerHTML = ``;
        var selectLoaiCongTrinh = document.getElementById("loaiCongTrinh");
        var loaiCongTrinh = selectLoaiCongTrinh.value;
        var valuerank = _ngach;
        var valueloaihinh = document.getElementById("loaiHinhKeKhai").value;
        if (valuerank.includes("NCV") && valueloaihinh == "NCM") {
            Get_thanhtoanncv(loaiCongTrinh, render_spkhcn);
        }
        if (valuerank.includes("NCV") && valueloaihinh == "KKKL") {
            Get_thanhtoanncv(loaiCongTrinh, render_spkhcn);
        }
        if (valuerank.includes("GV") && valueloaihinh == "NCM") {
            Get_thanhtoanncv(loaiCongTrinh, render_spkhcn);
        }
        else if (valuerank.includes("GV") && valueloaihinh == "KKKL") {
            Get_spkhcn(loaiCongTrinh, render_spkhcn);
        }
        else if (valuerank.includes("GV") && valueloaihinh == "HDNCKH") {
            Get_spkhcn(loaiCongTrinh, render_spkhcn);
        }
        else if (valuerank.includes("GV") && valueloaihinh == "DT") {

        }

    }

    //kê khai khối lượng gv
    var apiQDGV = "https://localhost:5001/api/QuyDoiGV/Get-spkhcn?spkhcn=";
    function Get_spkhcn(a, callback) {
        fetch(apiQDGV + a, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })
            .then(function (response) {
                return response.json();
            })
            .then(callback)
    }
    function render_spkhcn(khcns) {
        var checkbox = document.getElementById("noIssn");
        checkbox.style.display = 'block';
        checkbox.innerHTML = "";
        var valuerank = _ngach;
        var valueloaihinh = document.getElementById("loaiHinhKeKhai").value;

        if (valuerank.includes("GV") && valueloaihinh == "DT") {
            loadloaibaibao();
        }
        if (valuerank != "GV") {
            if (valueloaihinh == "NCM") {
                var htmls = khcns.map(function (khcn) {
                    return `<div class="custom-control custom-radio">
                                    <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.moTaLoaiSanPham}" onclick="checkcheckncv(${khcn.id}, render_checkncv(0, ${khcn.diem}))">
                                    <label for="${khcn.id}" class="custom-control-label">${khcn.moTaLoaiSanPham}</label>
                                </div>`;
                });
            } else {
                var htmls = khcns.map(function (khcn) {
                    return `<div class="custom-control custom-radio">
                                    <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.moTaLoaiSanPham}" onclick="checkcheckncv(${khcn.id}, render_checkncv(${khcn.tietChuan}, ${khcn.diem}))">
                                    <label for="${khcn.id}" class="custom-control-label">${khcn.moTaLoaiSanPham}</label>
                                </div>`;
                });
            }

        } else {
            if (valueloaihinh == "NCM") {
                var htmls = khcns.map(function (khcn) {
                    return `<div class="custom-control custom-radio">
                                        <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.moTaLoaiSanPham}" onclick="checkcheckncv(${khcn.id}, render_checkncv(0, ${khcn.diem}))">
                                        <label for="${khcn.id}" class="custom-control-label">${khcn.moTaLoaiSanPham}</label>
                                    </div>`;
                });
            } else {
                var htmls = khcns.map(function (khcn) {
                    return `<div class="custom-control custom-radio">
                                        <input class="custom-control-input" type="radio" id="${khcn.id}" name="yc" value="${khcn.moTaLoaiSanPham}" onclick="checkcheckncv(${khcn.id}, render_checkncv(${khcn.tietChuan}, ${khcn.diem}))">
                                        <label for="${khcn.id}" class="custom-control-label">${khcn.moTaLoaiSanPham}</label>
                                    </div>`;
                });
            }
        }
        checkbox.innerHTML = htmls.join('');
    }

    //kê khai khối lượng ncv
    function Get_thanhtoanncv(a, callback) {
        var valuerank = _ngach;
        var apiQDNCV = "https://localhost:5001/api/QuyDoiNCV/Get-spkhcn?spkhcn=";
        if (valuerank != "GV") {
            fetch(apiQDNCV + a, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (response) {
                    return response.json();
                })
                .then(callback)
        } else {
            fetch(apiQDNCV + a, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(function (response) {
                    return response.json();
                })
                .then(callback)
        }
    }
    //
    linkapiID2 = "https://localhost:5001/api/QuyDoiGV/Get-id?id=";
    function checkcheckncv(a, callback) {
        fetch(linkapiID2 + a, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })
            .then(function (res) {
                return res.json();
            })
            .then(callback);
    }

    function render_checkncv(tietchuan, diem, lsps) {
        /*show_yc();*/
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
        try {
            var category = document.querySelector('input[id="category-1"]').value;
        } catch { }
        try {
            if (valueloaihinh == "Kê khai khối lượng") {
                var ketqua = document.getElementById("ketqua");
                ketqua.style.display = 'block';
                ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">${tietchuan}</label>
                                    <label>Điểm:</label><label id="diem">${diem}</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;
                if (category.includes("Q1")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">120</label>
                                        <label>Điểm:</label><label id="diem">30</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;
                }
                if (category.includes("Q2")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">110</label>
                                        <label>Điểm:</label><label id="diem">27.5</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category.includes("Q3")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">100</label>
                                        <label>Điểm:</label><label id="diem">25</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;

                }
                if (category.includes("Q4")) {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">90</label>
                                       <label>Điểm:</label><label id="diem">22.5</label>
                                       <label>Kinh phí:</label><label id="totaltien">0</label>`;
                }
                if (category == "Q1" || category == "Q2" || category == "Q3") {
                    var ketqua = document.getElementById("ketqua");
                    ketqua.style.display = 'block';
                    ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">60</label>
                                        <label>Điểm:</label><label id="diem">15</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;
                } else {
                }
            }
            else if (valueloaihinh == "Nghiên cứu mạnh") {
                var ketqua = document.getElementById("ketqua");
                ketqua.style.display = 'block';
                ketqua.innerHTML = `<label>Tiết chuẩn:</label> <label id="tietchuan">0</label>
                                        <label>Điểm:</label><label id="diem">${diem}</label>
                                        <label>Kinh phí:</label><label id="totaltien">0</label>`;          
            }
        } catch { }

    }
    var userId = _idUser;
    function BrowseServer(field) {
        var finder = new CKFinder();
        finder.selectActionFunction = function (fileUrl) {
            var userDirectory = "/Uploads/" + userId + "/"; // Thư mục lưu trữ riêng cho người dùng
            var fileUrlWithUserDir = userDirectory + fileUrl.substring(fileUrl.lastIndexOf("/") + 1); // Đường dẫn đầy đủ của tệp tin trong thư mục người dùng
            document.getElementById(field).value = decodeURIComponent(fileUrlWithUserDir).replace(/\%20/g, ' ');
            // Gửi đường dẫn tệp tin và userId lên server để lưu trữ
            SaveFile(fileUrl, userId);
        };
        finder.popup();
    }

    function SaveFile(fileUrl, userId) {
        var data = {
            fileUrl: fileUrl,
            userId: userId
        };

        $.ajax({
            url: '/Article/SaveFile',
            type: 'POST',
            data: JSON.stringify(data),
            contentType: 'application/json',
            success: function (result) {
                if (result.success) {
                    // Xử lý khi lưu trữ tệp tin thành công
                    alert('Tải lên thành công.');
                } else {
                    // Xử lý khi lưu trữ tệp tin thất bại
                    alert('Tải lên thất bại.');
                }
            },
            error: function () {
                // Xử lý khi có lỗi xảy ra
                alert('Đã xảy ra lỗi khi gửi yêu cầu lưu trữ tệp tin.');
            }
        });
    }
</script>
<script src="~/Content/Js/upfile.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        
        function getData() {
            fetch('https://localhost:5001/api/DanhMucXetDuyet/Get-by-userid?userid=' + _idUser, {
                headers: {
                    'Authorization': 'Bearer ' + _token,
                    'Content-Type': 'application/json'
                }
            })
                .then(response => response.json())
                .then(data => {
                    var tongTien = 0;
                    var tongTietChuan = 0;
                    var tongDiem = 0;
                    var stt = 1;
                    const tbody = document.querySelector('#example1 tbody');
                    data.forEach(function (row) {
                        if (row.status == "Đang đợi duyệt") {
                            txtcolor = "rgba(77, 77, 79, 1)";
                            bgcolor = "rgba(77, 77, 79, 0.07)";
                        } else if (row.status == "Duyệt lần 1") {
                            txtcolor = "rgba(27, 162, 180, 1)";
                            bgcolor = "rgba(27, 162, 180, 0.07)";
                        } else if (row.status == "Duyệt lần 2") {
                            txtcolor = "rgba(16, 117, 187, 1)";
                            bgcolor = "rgba(16, 117, 187, 0.07)";
                        } else if (row.status == "Từ chối") {
                            txtcolor = "rgba(200, 16, 47, 1)";
                            bgcolor = "rgba(200, 16, 47, 0.07)";
                        } else {
                            txtcolor = "rgba(42, 148, 70, 1)";
                            bgcolor = "rgba(42, 148, 70, 0.07)";
                        };
                        var grtg = row.groupUser;
                        var tacgia = getOneAuthor(grtg, _idUser);

                        var tr = document.createElement('tr');
                        tr.innerHTML = "<td width='5%' align='center'>" + row.idDanhMuc + "</td>" +
                            "<td>" + stt + "</td>" +
                            "<td>" + row.tenBaiBao + "</td>" +
                            "<td>" + row.journal_name + "</td>" +
                            "<td>" + tacgia[3] + "</td>" +
                            "<td>" + tacgia[4] + "</td>" +
                            "<td>" + tacgia[7] + "</td>" +
                            "<td>" + tacgia[6] + "</td>" +
                            "<td><span class='badge' style='color:" + txtcolor + "!important; background-color:" + bgcolor + "!important;'>" + row.status + "</span></td>" +
                            "<td width='3%'><a type='button' data-toggle='modal' data-target='#modal-xl' onclick='xemchitiet(" + row.idDanhMuc + ")'><i class='fas fa-edit' style='color: #3276b1;'></i></a></td>" +
                            "<td width='3%'><a type='button' onclick='deleteItem(" + row.idDanhMuc + ")'><i class='fas fa-trash-alt' style='color: #c82333;'></i></a></td>";
                        tbody.appendChild(tr);

                        stt += 1;
                        tongTien += tacgia[4] ? parseFloat(tacgia[4]) : 0;
                        tongTietChuan += tacgia[7] ? parseFloat(tacgia[7]) : 0;
                        tongDiem += tacgia[6] ? parseFloat(tacgia[6]) : 0;
                    });
                    document.getElementById("tongTien").textContent = tongTien;
                    document.getElementById("tongTietChuan").textContent = tongTietChuan;
                    document.getElementById("tongDiem").textContent = tongDiem;
                    $(function () {
                        $("#example1").DataTable({
                            "paging": true,
                            "searching": true,
                            "ordering": true,
                            "info": true,
                            "responsive": true, "lengthChange": false, "autoWidth": false
                        })
                    });
                });

        }
        getData();
    });

    function xemchitiet(iddm) {
        fetch('https://localhost:5001/api/DanhMucXetDuyet/Get-id?IDDanhMuc=' + iddm, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                document.getElementById("idDanhMuc").value = data.idDanhMuc;
                document.getElementById("issn").value = data.issn;
                document.getElementById("eissn").value = data.eissn;
                document.getElementById("tenBaiBao").value = data.tenBaiBao;
                document.getElementById("type").value = data.type;
                document.getElementById("rank").value = data.rank;
                try {
                    document.getElementById("total2").value = data.total;
                }
                catch {

                }
                document.getElementById("dateSubmit").value = data.dateSubmit;
                document.getElementById("ghiChu").value = data.ghiChu;
                document.getElementById("image").src = data.image;

                //hiển thị theo quyền

                document.getElementById("status").value = data.status;
                const kekhaitg = render_tg(data.groupUser);
                const tbody = document.querySelector('#tbtacgia tbody');
                tbody.innerHTML = ``;
                kekhaitg.forEach(function (row) {

                    var tr = document.createElement('tr');
                    tr.innerHTML = "<td width='5%' align='center'>" + row[0] + "</td>" +
                        "<td>" + row[1] + "</td>" +
                        "<td>" + row[2] + "</td>" +
                        "<td>" + row[3] + "</td>" +
                        "<td>" + row[4] + "</td>" +
                        "<td>" + row[5] + "</td>" +
                        "<td>" + row[6] + "</td>" +
                        "<td>" + row[7] + "</td>";

                    tbody.appendChild(tr);

                });
                document.getElementById("link").textContent = data.link;
                const link = document.getElementById("link");
                link.href = data.link;

                // Chuỗi đường dẫn hình ảnh
                var imagePaths = data.image;

                // Phần tử div để chứa hình ảnh
                var imageDiv = document.getElementById("image");

                // Xóa bỏ các hình ảnh trước đó
                imageDiv.innerHTML = "";

                var fileDiv = document.getElementById("file");

                // Xóa bỏ các hình ảnh trước đó
                fileDiv.innerHTML = "";

                // Tách chuỗi đường dẫn thành mảng các đường dẫn
                var imagePathsArray = imagePaths.split(',');

                // Lặp qua từng đường dẫn
                imagePathsArray.forEach(function (imagePath) {
                    // Kiểm tra đuôi file
                    var fileExtension = imagePath.split('.').pop().toLowerCase();
                    var imageExtensions = ['jpg', 'jpeg', 'png', 'gif']; // Các đuôi file hình ảnh hợp lệ

                    if (imageExtensions.includes(fileExtension)) {
                        // Nếu là đường dẫn hình ảnh, tạo phần tử img và gán đường dẫn
                        var imgElement = document.createElement("img");
                        imgElement.src = imagePath;

                        // Thêm thuộc tính vào phần tử img
                        imgElement.setAttribute("alt", "Hình ảnh");
                        imgElement.setAttribute("width", "400px");
                        imgElement.setAttribute("height", "auto");

                        // Thêm phần tử img vào phần tử div
                        imageDiv.appendChild(imgElement);
                    } else {
                        // Nếu là tệp khác, tạo phần tử a và gán đường dẫn
                        var linkElement = document.createElement("a");
                        linkElement.href = imagePath;
                        linkElement.target = "_blank";
                        linkElement.textContent = " " + imagePath;

                        // Thêm sự kiện click cho phần tử a để mở tab mới
                        linkElement.addEventListener("click", function (event) {
                            event.preventDefault(); // Ngăn chặn chuyển hướng trình duyệt
                            window.open(this.href, "_blank"); // Mở tab mới với đường dẫn
                        });

                        // Tạo một phần tử label
                        var labelElement = document.createElement("label");
                        labelElement.textContent = "File: ";

                        // Thêm label và phần tử a vào phần tử div
                        fileDiv.appendChild(labelElement);
                        fileDiv.appendChild(linkElement);
                    }
                });

            })
    }
    function changeStatus() {
        var idDanhMuc = document.getElementById("idDanhMuc").value;
        var status = document.getElementById("status").value;
        fetch(`https://localhost:5001/api/DanhMucXetDuyet/${idDanhMuc}`, {
            method: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(status)
        })
            .then(response => response.json())
            .then(data => {
                if (data) {
                    alert('Cập nhật trạng thái thành công!');
                }
            })
            .catch(error => {
                alert('Có lỗi xảy ra', error);
            });
    }

    function render_kekhaitg(tg) {
        const tgct = tg.split(";");
        return tgct;
    }
    function render_tg(str) {
        const lista = [];
        const tgs = str.split("$");
        tgs.forEach(function (tg) {
            var x = render_kekhaitg(tg);
            lista.push(x);
        });
        return lista;
    }

    function getOneAuthor(str, userId) {
        const tgs = str.split("$");
        var result = null;
        tgs.forEach(function (tg) {
            if (tg.includes(userId)) {
                result = render_kekhaitg(tg);
            }
        });
        return result;
    }
    //Xuất file excel
    function ExportToExcelDeTaiUser(xuat) {
        fetch('https://localhost:5001/api/DanhMucXetDuyet/ExcelUserid?userid=' + _idUser + '&xuat=' + xuat, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })

            .then(response => response.blob())
            .then(blob => {
                const url = window.URL.createObjectURL(new Blob([blob]));
                const link = document.createElement('a');
                link.href = url;
                if (xuat == 1) {
                    link.setAttribute('download', 'NCM.xlsx');
                }
                else if (xuat == 2) {
                    link.setAttribute('download', 'KhoaVien.xlsx');
                }
                else if (xuat == 4) {
                    link.setAttribute('download', 'NghienCuuVien.xlsx');
                }
                else {
                    link.setAttribute('download', 'Truong.xlsx');
                }
                document.body.appendChild(link);
                link.click();
                link.parentNode.removeChild(link);
            })
    }
    clear_hinhthuc();
    themtacgia();
    //Load tác giả table
    function themtacgia() {
        var a = ``;
        var sltgc = Number(document.querySelector('#sltgc').value);
        var sltgp = Number(document.querySelector('#sltgp').value);
        var sltglh = Number(document.querySelector('#sltglh').value);       
        var valuerank = _ngach;
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
        var sltg = sltgc + sltgp + sltglh;
        let i = 0;
        //alert(valueloaihinh + valuerank);
        document.querySelector('#tbtacgia2').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
            <th width="2%">STT</th>
            <th width="15%">Mã nhân viên</th>
            <th width="15%">Cơ quan công tác</th>
            <th width="15%">Loại tác giả</th>
            <th width="10%">Tổng nhận trước thuế</th>
            <th width="10%">Thực nhận</th>
            <th width="5%">Điểm</th>
            <th width="5%">Tiết chuẩn</th>
            </thead>
            <tbody id="tablethanhtoan">
            </tbody>`;
        //document.querySelector('#tongtacgia').innerHTML = `<a>Tổng số tác giả: <a id="tongsltg">${sltg}</a></a>`;
        if (sltgc == 1 && valueloaihinh == "Đề tài" && valuerank.includes("GV")) {
            for (i; i < sltgc; i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>
                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control">
                                 <option >Chủ nhiệm</option>
                                 <option >Thành viên</option>
                                 </select></td></tr>`;
            }
            for (i; i < (sltgp + sltgc); i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>
                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control">
                                 <option >Thành viên</option>

                            <option >Chủ nhiệm</option>
                                 </select>
                                 </td>
                                 </tr>`;
            } for (i; i < sltg; i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>

                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control">
                                 <option >Thành viên</option>

                                 <option >Chủ nhiệm</option></select>
                                 </td></tr>`;
            }

            document.querySelector('#addtacgia').innerHTML = a;
        }
        if (sltgc == 1 && valueloaihinh == "Kê khai khối lượng" && valuerank.includes("GV")) {

            for (i; i < sltgc; i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>

                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>
                                 <option >Tác giả chính</option>
                                 </select></td></tr>`;
            }
            for (i; i < (sltgp + sltgc); i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>
                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>

                                 <option>Tác giả phụ</option>
                                 </td>
                                 </tr>`;
            } for (i; i < sltg; i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>

                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>

                                 <option>Tác giả liên hệ</option>
                                 </td></tr>`;
            }

            document.querySelector('#addtacgia').innerHTML = a;
        }
        ///
        if (sltgc == 1 && valueloaihinh == "Kê khai khối lượng" && valuerank.includes("NCV")) {

            for (i; i < sltgc; i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>

                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>
                                 <option >Tác giả chính</option>
                                 </select></td></tr>`;
            }
            for (i; i < (sltgp + sltgc); i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>
                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>

                                 <option>Tác giả phụ</option>
                                 </td>
                                 </tr>`;
            } for (i; i < sltg; i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>

                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>

                                 <option>Tác giả liên hệ</option>
                                 </td></tr>`;
            }

            document.querySelector('#addtacgia').innerHTML = a;
        }
        ///
        if (sltgc == 1 && valueloaihinh == "Nghiên cứu mạnh" && valuerank.includes("GV") || valuerank.includes("NCV")) {

            for (i; i < sltgc; i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>

                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>
                                 <option >Tác giả chính</option>
                                 <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                                 </select></td></tr>`;
            }
            for (i; i < (sltgp + sltgc); i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>
                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>

                                 <option>Tác giả phụ</option>
                                 </td>
                                 <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                                 </tr>`;
            } for (i; i < sltg; i++) {
                a += `<tr><td>${i + 1}</td>
                            <td ><input class="form-control" type="text" placeholder="Nhập Mã GV/Tên tác giả phụ thuộc HUTECH" id="inp-username-id-mail-${i}" oninput="inpsearch(${i},render_user)" />
                            <div id="themtg" style="display: flex">
                                <div width: 50%">
                                    <dl id="dl-user-${i}">
                                    </dl>
                                </div>
                            </div></td>
                            <td ><div class="form-group">
                            <select name="coquancongtac" id="coquancongtac-${i}" class="form-control">
                                <option value="0"> --Chọn cơ quan công tác--</option>

                                <option value="1">Cơ quan công tác duy nhất Hutech (100%)</option>
                                <option value="0.5">Hutech-Quốc tế (50%)</option>
                                <option value="0">Quốc tế - Hutech (0%)</option>
                                <option value="0">Cơ quan công tác trong nước - ngoài Hutech (0%)</option>
                            </select>
                        </div></td>
                            <td>
                            <div class="form-group">
                            <select name="coquancongtac" id="tg-${i}" class="form-control" disabled>

                                 <option>Tác giả liên hệ</option>
                                 <td><input class="form-control" type="number" placeholder="Nhập % đóng góp" id="donggop-${i}" /></td>
                                 </td></tr>`;
            }

            document.querySelector('#addtacgia').innerHTML = a;
        }

        else if (sltgc > 1) {
            alert("Duy nhất 1 tác giả chính!");
        }

    }
    //Hiển thị tác giả
    function render_user(users) {
        var sltgc = Number(document.querySelector('#sltgc').value);
        var sltgp = Number(document.querySelector('#sltgp').value);
        var sltglh = Number(document.querySelector('#sltglh').value);
        var sltg = sltgc + sltgp + sltglh;
        for (let i = 0; i < sltg; i++) {
            var tg = document.querySelector('#inp-username-id-mail-' + i);
            tg.oninput = function () {
                var list = document.querySelector('#dl-user-' + i);
                list.innerHTML = ``;
                inpsearch(i, render_user);
                var htmls = users.map(function (user) {
                    return `<dt value="${user.idUser}" style="border-style: groove;"><button onclick="btnadd('${i}','${user.idUser}','${user.hoTen}')" type="button" class="btn btn-success">Thêm tác giả </button>
${user.hoTen} - ${user.donViCongTac}</dt>`;
                });
                list.innerHTML = htmls.join('');
            }
        }
    }
    // Thêm mã tên tác giả
    function btnadd(id, iduser, name) {
        var tg = document.querySelector('#inp-username-id-mail-' + id);
        tg.value = ``;
        if (tg.value == "") {
            document.querySelector('#dl-user-' + id).innerHTML = ``;
            tg.value = tg.value + iduser + " - " + name;
        }

        document.querySelector('#dl-user-' + id).innerHTML = ``;
    }
    // Xử lý công thức tính ...
    function loadtable() {
        var sltgc = Number(document.querySelector('#sltgc').value);
        var sltgp = Number(document.querySelector('#sltgp').value);
        var sltglh = Number(document.querySelector('#sltglh').value);

        var sltg = sltgc + sltgp + sltglh;
        try {
            var tietchuan = Number(document.querySelector('#tietchuan').textContent);

        } catch {
            alert("Chọn hình thức thanh toán!");
        }
        var diem = Number(document.querySelector('#diem').textContent);
        var table = document.getElementById("tablethanhtoan");
        var trtable = ``;
        try {
            var optionshdsv = document.querySelector('#loaiCongTrinh');
            var hdsv = optionshdsv.options[optionshdsv.selectedIndex].value;
        } catch { }
        try {
            var total = Number(document.querySelector('#totaltien').textContent);

        } catch {
            var total = 0;
        }
        var tongdonggop = 0;
        var valuerank = _ngach;
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
        for (let j = 0; j < sltg; j++) {
            try {
                var donggop = Number(document.querySelector('#donggop-' + j).value);

            } catch { }
            tongdonggop += donggop;
            if (tongdonggop > 100) {

                try { document.querySelector('#donggop-' + j).value = 0; } catch { }
            }

        }
        if (tongdonggop > 100) {
            alert('Đóng góp quá 100%!');
        } else {
            if (valuerank.includes("GV") && valueloaihinh == "Kê khai khối lượng") {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltgc == 1 && sltgp > 0 && sltglh == 0) {
                    if (sltgc == 1 && sltgp > 0 && sltglh == 0) {
                        for (let i = 0; i < sltg; i++) {
                            var coquan = table.rows[0].cells[2].textContent;
                            try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }
                            if (sltg > 1) {
                                if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `0`;
                                    table.rows[0].cells[7].innerHTML = `0`;
                                    if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;

                                        }

                                    } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                } if (coquan == "Hutech-Quốc tế (50%)") {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[0].cells[7].innerHTML = `${tietchuan / 2 * 0.8}`;
                                    }
                                    if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[0].cells[4].innerHTML = `0`;
                                    table.rows[0].cells[5].innerHTML = `0`;
                                    table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[0].cells[7].innerHTML = `${tietchuan * 0.8}`;
                                    }
                                    if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                        if (hdsv == "HDSV") {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                        } else {
                                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.2 / sltgp}`;
                                        }
                                    } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[i].cells[4].innerHTML = `0`;
                                        table.rows[i].cells[5].innerHTML = `0`;
                                        table.rows[i].cells[6].innerHTML = `0`;
                                        table.rows[i].cells[7].innerHTML = `0`;
                                    }
                                }
                            }
                        }

                    }
                }
                if (sltgc == 1 && sltgp == 0 && sltglh > 0) {
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[0].cells[2].textContent;
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }
                        if (sltg > 1) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan / 2 * 0.5}`;
                                }
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[0].cells[7].innerHTML = `${tietchuan * 0.5}`;
                                }
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                    if (hdsv == "HDSV") {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                    } else {
                                        table.rows[i].cells[7].innerHTML = `${tietchuan / 2 * 0.5 / sltglh}`;
                                    }
                                } if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                    table.rows[i].cells[4].innerHTML = `0`;
                                    table.rows[i].cells[5].innerHTML = `0`;
                                    table.rows[i].cells[6].innerHTML = `0`;
                                    table.rows[i].cells[7].innerHTML = `0`;
                                }
                            }
                        }
                    }
                }
                else if (sltg > 2 && (sltgc + sltglh) > 1 && sltgp > 0) {
                    for (let i = 0; i < sltg; i++) {
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }

                        var coquan = table.rows[i].cells[2].textContent;
                        var optionstg1 = document.querySelector('#tg-' + i);
                        var texttg1 = optionstg1.options[optionstg1.selectedIndex].textContent;

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            table.rows[i].cells[6].innerHTML = `0`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        } else if (coquan == "Hutech-Quốc tế (50%)") {
                            if (texttg1 == "Tác giả chính") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${(((tietchuan * 0.8) / (sltgc + sltglh))) / 2}`;
                                }

                            } else if (texttg1 == "Tác giả phụ") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${(tietchuan * 0.2) / 2 / sltgp}`;
                                }
                            } else if (texttg1 == "Tác giả liên hệ") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${(tietchuan * 0.8) / 2 / (sltgc + sltglh)}`;
                                }
                            }

                        } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            if (texttg1 == "Tác giả chính") {

                                table.rows[i].cells[4].innerHTML = `${(((total * 0.75) / (sltgc + sltglh)))}`;
                                table.rows[i].cells[5].innerHTML = `${(((total * 0.75) / (sltgc + sltglh))) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${(((tietchuan * 0.8) / (sltgc + sltglh)))}`;
                                }

                            } else if (texttg1 == "Tác giả phụ") {
                                table.rows[i].cells[4].innerHTML = `${total * 0.25 / sltgp}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.25) / sltgp) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`; if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan * 0.2 / sltgp}`;
                                }
                            } else if (texttg1 == "Tác giả liên hệ") {
                                table.rows[i].cells[4].innerHTML = `${((total * 0.75) / (sltgc + sltglh))}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.75) / (sltgc + sltglh)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                if (hdsv == "HDSV") {
                                    table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                                } else {
                                    table.rows[i].cells[7].innerHTML = `${((tietchuan * 0.8) / (sltgc + sltglh))}`;
                                }
                            }
                        }

                    }
                }

                if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        if (hdsv == "HDSV") {
                            table.rows[i].cells[7].innerHTML = `${tietchuan / 2 / sltg}`;
                        } else {
                            table.rows[0].cells[7].innerHTML = `${tietchuan / 2}`;
                        }
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        if (hdsv == "HDSV") {
                            table.rows[i].cells[7].innerHTML = `${tietchuan / sltg}`;
                        } else {
                            table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                        }
                    }
                }
            }
            if (valuerank.includes("NCV") && valueloaihinh == "Kê khai khối lượng") {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltg == 2) {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }
                        }
                    }
                }
                else if (sltg > 2 && (sltgc + sltglh) < sltg) {
                    for (let i = 0; i < sltg; i++) {
                        try { var donggop = Number(document.querySelector('#donggop-' + i).value); } catch { }

                        var coquan = table.rows[i].cells[2].textContent;
                        var optionstg1 = document.querySelector('#tg-' + i);
                        var texttg1 = optionstg1.options[optionstg1.selectedIndex].textContent;

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            table.rows[i].cells[6].innerHTML = `0`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        } else if (coquan == "Hutech-Quốc tế (50%)") {
                            if (texttg1 == "Tác giả chính") {
                                table.rows[i].cells[4].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) / 2}`;
                                table.rows[i].cells[5].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) / 2 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;

                            } else if (texttg1 == "Tác giả phụ") {
                                table.rows[i].cells[4].innerHTML = `${(total * 0.2) / 2 / sltgp}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.2) / 2 / sltgp) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            } else if (texttg1 == "Tác giả liên hệ") {
                                table.rows[i].cells[4].innerHTML = `${(total * 0.8) / 2 / (sltgc + sltglh)}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.8) / 2 / (sltgc + sltglh)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }

                        } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            if (texttg1 == "Tác giả chính") {

                                table.rows[i].cells[4].innerHTML = `${(((total * 0.8) / (sltgc + sltglh)))}`;
                                table.rows[i].cells[5].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;

                            } else if (texttg1 == "Tác giả phụ") {
                                table.rows[i].cells[4].innerHTML = `${total * 0.2 / sltgp}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.2) / sltgp) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            } else if (texttg1 == "Tác giả liên hệ") {
                                table.rows[i].cells[4].innerHTML = `${((total * 0.8) / (sltgc + sltglh))}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.8) / (sltgc + sltglh)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }
                        }

                    }
                }

                if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }
            ////// 1 tác giả chính, 1 tác giả liên hệ , 1 phụ
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc == 1 && sltglh == 1 && sltgp == 1 && sltg == 3) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                                    <td>${i + 1}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    /// tgc 0%
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[sltg - 1].cells[2].textContent != "Hutech-Quốc tế (50%)") {

                            // tgc 0, tglh 0, tgp 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 8 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 8 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;

                            }
                            // tgc 0, tglh 0, tgp 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            // tgc 0, tglh 0, tgp 0
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `0`;
                                table.rows[2].cells[5].innerHTML = `0`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            // tgc 0 tgp 50 tglh 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 100 thlh 50
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 0 thlh 50
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 0 tgp 50 thlh 100
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 100 thlh 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 0 thlh 100
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                    }
                    //tgc 50
                    if (texttgc == "Hutech-Quốc tế (50%)") {

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            // tgc 50, tglh 0, tgp 50
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `0`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            // tgc 50, tglh 0, tgp 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            // tgc 0, tglh 0, tgp 0
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            // tgc 0 tgp 50 tglh 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 100 thlh 50
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 0 thlh 50
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 0 tgp 50 thlh 100
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            }
                            //tgc 0 tgp 100 thlh 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 0 thlh 100
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                    }
                    //////tgc 100
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {

                        var donggop = document.querySelector('#donggop-' + i).value;
                        var donggoptgc = document.querySelector('#donggop-0').value;
                        table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[i].cells[7].innerHTML = `0`;
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[2].cells[7].innerHTML = `0`;
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            // tgc 100, tglh 0, tgp 50
                            table.rows[2].cells[6].innerHTML = `0`;
                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 100 tgp 50 thlh 100
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                        }
                        //// kiểm tra cơ quan tác giả phụ
                        if (table.rows[sltg - 2].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            table.rows[1].cells[6].innerHTML = `0`;
                        }
                        if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                        }
                        if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, 1 tác giả liên hệ
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc == 1 && sltglh == 1 && sltgp == 0 && sltg == 2) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                                    <td>${i + 1}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;

                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[1].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, >1 tác giả liên hệ
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 2 && sltgc == 1 && sltgp == 0 && sltglh > 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total/2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total/2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total/2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total/2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;

                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 3 && sltgc == 1 && sltgp == 1 && sltglh > 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;

                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////// có 1 tác giả chính
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg == 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }

                for (let i = 0; i < sltg; i++) {

                    if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        table.rows[0].cells[4].innerHTML = `${((total))}`;
                        table.rows[0].cells[5].innerHTML = `${(((total))) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } else if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${((total / 2))}`;
                        table.rows[0].cells[5].innerHTML = `${(((total / 2))) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    }

                }

            }
            ///// 1 chính, 1 phụ hoặc 1 chính 1 liên hệ

            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltg == 2 && sltgc == 1 && sltgp == 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltg == 2) {
                    for (let i = 0; i < sltg; i++) {

                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        var optionscongtac = document.querySelector('#coquancongtac-' + 0);
                        var coquan = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[0].cells[4].innerHTML = `${((total)) * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total)) * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `${((total)) * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total)) * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                            } else if (table.rows[1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[0].cells[4].innerHTML = `${((total / 2)) * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total / 2)) * (donggop / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `${((total / 2)) * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total / 2)) * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                            } else if (table.rows[1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;

                            }

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[i].cells[4].innerHTML = `${((total / 2)) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${(((total / 2)) * (donggop / 100)) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            var donggoptgc = Number(document.querySelector('#donggop-0').value);

                            if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[4].innerHTML = `${((total)) * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total)) * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${((total)) * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total)) * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }

                        } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${((total)) * (donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }

                }
            }
            ///// nhiều hơn 3 tác giả: 1 chính, 1 phụ, 1 liên hệ

            ////
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc > 0 && sltglh == 1 && sltgp > 1 && sltg > 2) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                    for (let j = 0; j < sltg; j++) {
                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let k = 0; k < sltg; k++) {
                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                } else {
                                    table.rows[k].cells[6].innerHTML = `0`;
                                }
                                table.rows[k].cells[7].innerHTML = `0`;
                            }
                            break;
                        }
                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var coquanhutech = 0;
                            for (let g = (j + 1); g < sltg; g++) {
                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    coquanhutech += 1;
                                }
                            }
                            if (coquanhutech < 1) {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                        } else {
                            for (let j = 1; j < (sltg - sltglh); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 2; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let k = 0; k < sltg; k++) {

                                                table.rows[k].cells[4].innerHTML = `0`;
                                                table.rows[k].cells[5].innerHTML = `0`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                        }
                                    }
                                    break;
                                }

                            }
                        }
                    }
                }
                ////////////
                if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                    if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        for (let j = 0; j < sltg; j++) {
                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var coquanhutech = 0;
                                for (let g = (j + 1); g < sltg; g++) {
                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        coquanhutech += 1;
                                    }
                                }
                                if (coquanhutech < 1) {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                            } else {
                                for (let j = 1; j < (sltg - sltglh); j++) {
                                    if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                    if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        var coquanhutech = 0;
                                        for (let g = (j); g < sltg; g++) {
                                            if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                coquanhutech += 1;
                                            }
                                        }
                                        if (coquanhutech < 1) {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                    } else {
                                        for (let j = 2; j < (sltg - sltglh); j++) {
                                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                var coquanhutech = 0;
                                                for (let g = (j); g < sltg; g++) {
                                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                        coquanhutech += 1;
                                                    }
                                                }
                                                if (coquanhutech < 1) {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                            } else {
                                                for (let k = 0; k < sltg; k++) {

                                                    table.rows[k].cells[4].innerHTML = `0`;
                                                    table.rows[k].cells[5].innerHTML = `0`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                        if (table.rows[0].cells[sltg - 1].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let j = 0; j < sltg; j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j + 1); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 1; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let j = 2; j < (sltg - sltglh); j++) {
                                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    var coquanhutech = 0;
                                                    for (let g = (j); g < sltg; g++) {
                                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                            coquanhutech += 1;
                                                        }
                                                    }
                                                    if (coquanhutech < 1) {
                                                        for (let k = 0; k < sltg; k++) {
                                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                            } else {
                                                                table.rows[k].cells[6].innerHTML = `0`;
                                                            }
                                                            table.rows[k].cells[7].innerHTML = `0`;
                                                        }
                                                        break;
                                                    }
                                                } else {
                                                    for (let k = 0; k < sltg; k++) {

                                                        table.rows[k].cells[4].innerHTML = `0`;
                                                        table.rows[k].cells[5].innerHTML = `0`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                }
                                            }
                                            break;
                                        }

                                    }
                                }
                            }
                        }
                    }
                }

                ////////////
                if (table.rows[0].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[0].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                    if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        for (let j = 0; j < sltg; j++) {
                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var coquanhutech = 0;
                                for (let g = (j + 1); g < sltg; g++) {
                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        coquanhutech += 1;
                                    }
                                }
                                if (coquanhutech < 1) {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                            } else {
                                for (let j = 1; j < (sltg - sltglh); j++) {
                                    if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                    if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        var coquanhutech = 0;
                                        for (let g = (j); g < sltg; g++) {
                                            if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                coquanhutech += 1;
                                            }
                                        }
                                        if (coquanhutech < 1) {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                    } else {
                                        for (let j = 2; j < (sltg - sltglh); j++) {
                                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                var coquanhutech = 0;
                                                for (let g = (j); g < sltg; g++) {
                                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                        coquanhutech += 1;
                                                    }
                                                }
                                                if (coquanhutech < 1) {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                            } else {
                                                for (let k = 0; k < sltg; k++) {

                                                    table.rows[k].cells[4].innerHTML = `0`;
                                                    table.rows[k].cells[5].innerHTML = `0`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                        if (table.rows[0].cells[sltg - 1].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let j = 0; j < sltg; j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j + 1); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 1; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let j = 2; j < (sltg - sltglh); j++) {
                                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    var coquanhutech = 0;
                                                    for (let g = (j); g < sltg; g++) {
                                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                            coquanhutech += 1;
                                                        }
                                                    }
                                                    if (coquanhutech < 1) {
                                                        for (let k = 0; k < sltg; k++) {
                                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                            } else {
                                                                table.rows[k].cells[6].innerHTML = `0`;
                                                            }
                                                            table.rows[k].cells[7].innerHTML = `0`;
                                                        }
                                                        break;
                                                    }
                                                } else {
                                                    for (let k = 0; k < sltg; k++) {

                                                        table.rows[k].cells[4].innerHTML = `0`;
                                                        table.rows[k].cells[5].innerHTML = `0`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                }
                                            }
                                            break;
                                        }

                                    }
                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                        var hutech = 0;
                        var qt = 0;
                        var ngoai = 0;
                        for (let k = 1; k < sltg; k++) {
                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                hutech += 1;
                            }
                            if (table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                qt += 1;

                            } else {
                                ngoai += 1;
                            }

                        }
                        if (hutech > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[n].cells[5].innerHTML = `${total / 4 * donggop / 100 * 0.9}`;
                                table.rows[n].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        } else if (hutech == 0 && qt > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[n].cells[5].innerHTML = `${total / 8 * donggop / 100 * 0.9}`;
                                table.rows[n].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        } else if (hutech == 0 && qt == 0 && ngoai > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `0`;
                                table.rows[n].cells[5].innerHTML = `0`;
                                table.rows[n].cells[6].innerHTML = `0`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        }
                    }

                }
                ////////////
                else if (sltgc > 2 && sltgp > 0 && sltglh > 0) {
                    var tsltlh = 0;
                    var tglh = 0;
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var coquantgc = table.rows[0].cells[2].textContent;
                        if (coquantgc == "Hutech-Quốc tế (50%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tsltlh += 1;
                                }
                                if (tsltlh > 1 || tsltlh == 1) {
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                break;
                            }
                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)" || table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }
                        }
                        ////////
                        else if (coquantgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquantgc == "Quốc tế - Hutech (0%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 1000}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;

                                break;
                            }

                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            } if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tglh += 1;
                                }
                                if (tglh < 1) {
                                    if (table.rows[i].cells[2].textContent == "Tác giả phụ" && table.rows[i].cells[3].textContent == "Tác giả phụ") {

                                    }
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }

                                break;
                            }

                        }
                        ///////
                        else if (coquantgc == "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }
                else if (sltg == 2 && valuerank != "Nghiên cứu mạnh") {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg) * (donggop / 100)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }
                    }
                }

                else if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }

            ///////////////////
            if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc > 0 && sltglh > 1 && sltgp > 1 && sltg > 4) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                    for (let j = 0; j < sltg; j++) {
                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let k = 0; k < sltg; k++) {
                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                table.rows[k].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[k].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                } else {
                                    table.rows[k].cells[6].innerHTML = `0`;
                                }
                                table.rows[k].cells[7].innerHTML = `0`;
                            }
                            break;
                        }
                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var coquanhutech = 0;
                            for (let g = (j + 1); g < sltg; g++) {
                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    coquanhutech += 1;
                                }
                            }
                            if (coquanhutech < 1) {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                        } else {
                            for (let j = 1; j < (sltg - sltglh); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 2; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let k = 0; k < sltg; k++) {

                                                table.rows[k].cells[4].innerHTML = `0`;
                                                table.rows[k].cells[5].innerHTML = `0`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                        }
                                    }
                                    break;
                                }

                            }
                        }
                    }
                }
                ////////////
                if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                    for (let j = 0; j < sltg; j++) {
                        for (let k = 0; k < sltg; k++) {
                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[k].cells[6].innerHTML = `0`;
                            }
                            table.rows[k].cells[7].innerHTML = `0`;
                        }
                    }
                }

                ////////////
                if (table.rows[0].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[0].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                    var tglh100 = 0;
                    var tglh50 = 0;
                    var tglh0 = 0;
                    for (let i = (sltg - sltglh); i < sltg; i++) {
                        if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            tglh100 += 1;
                        } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            tglh50 += 1;
                        } if (table.rows[i].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[i].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                            tglh0 += 1;
                        }
                    }
                    if (tglh100 > 0) {
                        for (let j = 0; j < sltg; j++) {
                            var donggop = document.querySelector('#donggop-' + j).value;
                            table.rows[j].cells[4].innerHTML = `${total / sltglh * donggop / 100}`;
                            table.rows[j].cells[5].innerHTML = `${total / sltglh * donggop / 100 * 0.9}`;
                            if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                table.rows[j].cells[6].innerHTML = `0`;

                            } else {
                                table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                            }
                            table.rows[j].cells[7].innerHTML = `0`;
                        }
                    } if (tglh50 > 0 && tglh100 == 0) {
                        for (let j = 0; j < sltg; j++) {
                            var donggop = document.querySelector('#donggop-' + j).value;
                            table.rows[j].cells[4].innerHTML = `${total / 2 / sltglh * donggop / 100}`;
                            table.rows[j].cells[5].innerHTML = `${total / 2 / sltglh * donggop / 100 * 0.9}`;
                            if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                table.rows[j].cells[6].innerHTML = `0`;

                            } else {
                                table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                            }
                            table.rows[j].cells[7].innerHTML = `0`;
                        }
                    } if (tglh0 > 0 && tglh100 == 0 && tglh50 == 0) {
                        var tgp100 = 0;
                        var tgp50 = 0;
                        var tgp0 = 0;
                        for (let i = 1; i < (sltg - sltglh); i++) {
                            if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                tgp100 += 1;
                            } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                tgp50 += 1;
                            } if (table.rows[i].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[i].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                tgp0 += 1;
                            }
                        } if (tgp100 > 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `${total * 0.25 * donggop / 100}`;
                                table.rows[j].cells[5].innerHTML = `${total * 0.25 * donggop / 100 * 0.9}`;
                                if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                    table.rows[j].cells[6].innerHTML = `0`;

                                } else {
                                    table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                                }
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        } if (tgp50 == 0 && tglh50 > 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `${total * 0.25 / 2 * donggop / 100}`;
                                table.rows[j].cells[5].innerHTML = `${total * 0.25 / 2 * donggop / 100 * 0.9}`;
                                if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                    table.rows[j].cells[6].innerHTML = `0`;

                                } else {
                                    table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                                }
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        } if (tgp0 > 0 && tgp100 == 0 && tgp50 == 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `0`;
                                table.rows[j].cells[5].innerHTML = `0`;
                                table.rows[j].cells[6].innerHTML = `0`;
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        }

                    }

                }
                ////////////
                else if (sltgc > 2 && sltgp > 0 && sltglh > 0) {
                    var tsltlh = 0;
                    var tglh = 0;
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var coquantgc = table.rows[0].cells[2].textContent;
                        if (coquantgc == "Hutech-Quốc tế (50%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tsltlh += 1;
                                }
                                if (tsltlh > 1 || tsltlh == 1) {
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                break;
                            }
                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)" || table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }
                        }
                        ////////
                        else if (coquantgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquantgc == "Quốc tế - Hutech (0%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 1000}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;

                                break;
                            }

                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            } if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tglh += 1;
                                }
                                if (tglh < 1) {
                                    if (table.rows[i].cells[2].textContent == "Tác giả phụ" && table.rows[i].cells[3].textContent == "Tác giả phụ") {

                                    }
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }

                                break;
                            }

                        }
                        ///////
                        else if (coquantgc == "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }
                else if (sltg == 2 && valuerank != "Nghiên cứu mạnh") {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg) * (donggop / 100)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }
                    }
                }

                else if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }
            ///4
            if (valuerank.includes("GV") && valueloaihinh == "Đề tài") {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltg == 2) {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }
                        }
                    }
                }
                else if (sltg > 2 && (sltgc + sltglh) < sltg) {
                    for (let i = 0; i < sltg; i++) {

                        var coquan = table.rows[i].cells[2].textContent;
                        var optionstg1 = document.querySelector('#tg-' + i);
                        var texttg1 = optionstg1.options[optionstg1.selectedIndex].textContent;

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            table.rows[i].cells[6].innerHTML = `0`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        } else if (coquan == "Hutech-Quốc tế (50%)") {
                            if (texttg1 == "Chủ nhiệm") {
                                table.rows[i].cells[4].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) / 2}`;
                                table.rows[i].cells[5].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) / 2 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;

                            } else if (texttg1 == "Thành viên") {
                                table.rows[i].cells[4].innerHTML = `${(total * 0.2) / 2 / sltgp}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.2) / 2 / sltgp) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }

                        } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            if (texttg1 == "Chủ nhiệm") {

                                table.rows[i].cells[4].innerHTML = `${(((total * 0.8) / (sltgc + sltglh)))}`;
                                table.rows[i].cells[5].innerHTML = `${(((total * 0.8) / (sltgc + sltglh))) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;

                            } else if (texttg1 == "Thành viên") {
                                table.rows[i].cells[4].innerHTML = `${((total * 0.2) / sltgp)}`;
                                table.rows[i].cells[5].innerHTML = `${((total * 0.2) / sltgp) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `${tietchuan}`;
                            }
                        }

                    }
                }

                if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }
            //////////////////
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc == 1 && sltglh == 1 && sltgp == 1 && sltg == 3) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                                    <td>${i + 1}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    /// tgc 0%
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[sltg - 1].cells[2].textContent != "Hutech-Quốc tế (50%)") {

                            // tgc 0, tglh 0, tgp 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 8 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 8 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 8 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;

                            }
                            // tgc 0, tglh 0, tgp 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 4 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            // tgc 0, tglh 0, tgp 0
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `0`;
                                table.rows[2].cells[5].innerHTML = `0`;
                                table.rows[2].cells[6].innerHTML = `0`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            // tgc 0 tgp 50 tglh 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 100 thlh 50
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 0 thlh 50
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 0 tgp 50 thlh 100
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 100 thlh 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }
                            //tgc 0 tgp 0 thlh 100
                            else {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                                table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[2].cells[7].innerHTML = `0`;
                            }

                        }
                    }
                    //tgc 50
                    if (texttgc == "Hutech-Quốc tế (50%)") {

                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            // tgc 50, tglh 0, tgp 50
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `0`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            // tgc 50, tglh 0, tgp 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            // tgc 0, tglh 0, tgp 0
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            // tgc 0 tgp 50 tglh 50
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 100 thlh 50
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 0 thlh 50
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 0 tgp 50 thlh 100
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[2].cells[7].innerHTML = `0`;
                            if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            }
                            //tgc 0 tgp 100 thlh 100
                            else if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            }
                            //tgc 0 tgp 0 thlh 100
                            else {
                                table.rows[1].cells[6].innerHTML = `0`;

                            }

                        }
                    }
                    //////tgc 100
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {

                        var donggop = document.querySelector('#donggop-' + i).value;
                        var donggoptgc = document.querySelector('#donggop-0').value;
                        table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[i].cells[7].innerHTML = `0`;
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        table.rows[2].cells[4].innerHTML = `${total * donggop / 100}`;
                        table.rows[2].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                        table.rows[2].cells[7].innerHTML = `0`;
                        //tglh 0%
                        if (table.rows[sltg - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            // tgc 100, tglh 0, tgp 50
                            table.rows[2].cells[6].innerHTML = `0`;
                        }
                        //tglh 50
                        if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                        }
                        //tglh 100
                        if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            //tgc 100 tgp 50 thlh 100
                            table.rows[2].cells[6].innerHTML = `${diem / 2}`;
                        }
                        //// kiểm tra cơ quan tác giả phụ
                        if (table.rows[sltg - 2].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                            table.rows[1].cells[6].innerHTML = `0`;
                        }
                        if (table.rows[sltg - 2].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                        }
                        if (table.rows[sltg - 2].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, 1 tác giả liên hệ
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc == 1 && sltglh == 1 && sltgp == 0 && sltg == 2) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                                    <td>${i + 1}</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;

                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            table.rows[1].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[1].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;

                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;

                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////// 1 tác giả chính, >1 tác giả liên hệ
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 2 && sltgc == 1 && sltgp == 0 && sltglh > 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total/2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total/2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total/2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total/2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;

                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg > 3 && sltgc == 1 && sltgp == 1 && sltglh > 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                for (let i = 1; i < sltg; i++) {
                    var coquantgc = table.rows[0].cells[2].textContent;
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    var optionstgc = document.querySelector('#coquancongtac-0');
                    var texttgc = optionstgc.options[optionstgc.selectedIndex].textContent;
                    var coquan = table.rows[i].cells[2].textContent;
                    if (texttgc == "Quốc tế - Hutech (0%)" || texttgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {

                            table.rows[i].cells[4].innerHTML = `0`;
                            table.rows[i].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[6].innerHTML = `0`;

                            table.rows[0].cells[4].innerHTML = `0`;
                            table.rows[0].cells[5].innerHTML = `0`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9} `;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `0`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                        }
                    } if (texttgc == "Hutech-Quốc tế (50%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        }
                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[1].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[1].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[1].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[1].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total / 2 * donggoptgc / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[0].cells[6].innerHTML = `${diem}`;
                            }
                            table.rows[0].cells[7].innerHTML = `0`;
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total / 2 * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem}`;

                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                    if (texttgc == "Cơ quan công tác duy nhất Hutech (100%)") {
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);
                        table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                        table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                        if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${(total * donggoptgc / 100) * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;

                        } if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `0`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            document.querySelector('#donggop-' + i).disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                            table.rows[i].cells[5].innerHTML = `${(total * donggop / 100) * 0.9}`;
                            if (sltglh > 1) {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            }
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }
                }
            }
            ////// có 1 tác giả chính
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg == 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }

                for (let i = 0; i < sltg; i++) {

                    if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        table.rows[0].cells[4].innerHTML = `${((total))}`;
                        table.rows[0].cells[5].innerHTML = `${(((total))) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } else if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${((total / 2))}`;
                        table.rows[0].cells[5].innerHTML = `${(((total / 2))) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;
                    }

                }

            }
            ///// 1 chính, 1 phụ hoặc 1 chính 1 liên hệ

            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltg == 2 && sltgc == 1 && sltgp == 1) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (sltg == 2) {
                    for (let i = 0; i < sltg; i++) {

                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        var optionscongtac = document.querySelector('#coquancongtac-' + 0);
                        var coquan = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                        var donggoptgc = Number(document.querySelector('#donggop-0').value);

                        if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                            if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[0].cells[4].innerHTML = `${((total)) * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total)) * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `${((total)) * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total)) * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                            } else if (table.rows[1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[0].cells[4].innerHTML = `${((total / 2)) * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total / 2)) * (donggop / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `${((total / 2)) * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total / 2)) * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                            } else if (table.rows[1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                table.rows[0].cells[4].innerHTML = `0`;
                                table.rows[0].cells[5].innerHTML = `0`;
                                table.rows[0].cells[6].innerHTML = `0`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                table.rows[1].cells[4].innerHTML = `0`;
                                table.rows[1].cells[5].innerHTML = `0`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;

                            }

                        } if (coquan == "Hutech-Quốc tế (50%)") {
                            table.rows[i].cells[4].innerHTML = `${((total / 2)) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${(((total / 2)) * (donggop / 100)) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                            var donggoptgc = Number(document.querySelector('#donggop-0').value);

                            if (table.rows[1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[1].cells[4].innerHTML = `${((total)) * (donggop / 100)}`;
                                table.rows[1].cells[5].innerHTML = `${(((total)) * (donggop / 100)) * 0.9}`;
                                table.rows[1].cells[6].innerHTML = `0`;
                                table.rows[1].cells[7].innerHTML = `0`;
                                table.rows[0].cells[4].innerHTML = `${((total)) * (donggoptgc / 100)}`;
                                table.rows[0].cells[5].innerHTML = `${(((total)) * (donggoptgc / 100)) * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }

                        } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                            table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                            table.rows[i].cells[5].innerHTML = `${((total)) * (donggop / 100) * 0.9}`;
                            table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[i].cells[7].innerHTML = `0`;
                        }
                    }

                }
            }
            ///// nhiều hơn 3 tác giả: 1 chính, 1 phụ, 1 liên hệ

            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc > 0 && sltglh == 1 && sltgp > 1 && sltg > 2) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                    for (let j = 0; j < sltg; j++) {
                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let k = 0; k < sltg; k++) {
                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                } else {
                                    table.rows[k].cells[6].innerHTML = `0`;
                                }
                                table.rows[k].cells[7].innerHTML = `0`;
                            }
                            break;
                        }
                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var coquanhutech = 0;
                            for (let g = (j + 1); g < sltg; g++) {
                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    coquanhutech += 1;
                                }
                            }
                            if (coquanhutech < 1) {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                        } else {
                            for (let j = 1; j < (sltg - sltglh); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 2; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let k = 0; k < sltg; k++) {

                                                table.rows[k].cells[4].innerHTML = `0`;
                                                table.rows[k].cells[5].innerHTML = `0`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                        }
                                    }
                                    break;
                                }

                            }
                        }
                    }
                }
                ////////////
                if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                    if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        for (let j = 0; j < sltg; j++) {
                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var coquanhutech = 0;
                                for (let g = (j + 1); g < sltg; g++) {
                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        coquanhutech += 1;
                                    }
                                }
                                if (coquanhutech < 1) {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                            } else {
                                for (let j = 1; j < (sltg - sltglh); j++) {
                                    if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                    if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        var coquanhutech = 0;
                                        for (let g = (j); g < sltg; g++) {
                                            if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                coquanhutech += 1;
                                            }
                                        }
                                        if (coquanhutech < 1) {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                    } else {
                                        for (let j = 2; j < (sltg - sltglh); j++) {
                                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                var coquanhutech = 0;
                                                for (let g = (j); g < sltg; g++) {
                                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                        coquanhutech += 1;
                                                    }
                                                }
                                                if (coquanhutech < 1) {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                            } else {
                                                for (let k = 0; k < sltg; k++) {

                                                    table.rows[k].cells[4].innerHTML = `0`;
                                                    table.rows[k].cells[5].innerHTML = `0`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                        if (table.rows[0].cells[sltg - 1].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let j = 0; j < sltg; j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j + 1); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 1; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let j = 2; j < (sltg - sltglh); j++) {
                                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    var coquanhutech = 0;
                                                    for (let g = (j); g < sltg; g++) {
                                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                            coquanhutech += 1;
                                                        }
                                                    }
                                                    if (coquanhutech < 1) {
                                                        for (let k = 0; k < sltg; k++) {
                                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                            } else {
                                                                table.rows[k].cells[6].innerHTML = `0`;
                                                            }
                                                            table.rows[k].cells[7].innerHTML = `0`;
                                                        }
                                                        break;
                                                    }
                                                } else {
                                                    for (let k = 0; k < sltg; k++) {

                                                        table.rows[k].cells[4].innerHTML = `0`;
                                                        table.rows[k].cells[5].innerHTML = `0`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                }
                                            }
                                            break;
                                        }

                                    }
                                }
                            }
                        }
                    }
                }

                ////////////
                if (table.rows[0].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[0].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                    if (table.rows[sltg - 1].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                        for (let j = 0; j < sltg; j++) {
                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var coquanhutech = 0;
                                for (let g = (j + 1); g < sltg; g++) {
                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        coquanhutech += 1;
                                    }
                                }
                                if (coquanhutech < 1) {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                            } else {
                                for (let j = 1; j < (sltg - sltglh); j++) {
                                    if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                    if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        var coquanhutech = 0;
                                        for (let g = (j); g < sltg; g++) {
                                            if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                coquanhutech += 1;
                                            }
                                        }
                                        if (coquanhutech < 1) {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                    } else {
                                        for (let j = 2; j < (sltg - sltglh); j++) {
                                            if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                            if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                var coquanhutech = 0;
                                                for (let g = (j); g < sltg; g++) {
                                                    if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                        coquanhutech += 1;
                                                    }
                                                }
                                                if (coquanhutech < 1) {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                            } else {
                                                for (let k = 0; k < sltg; k++) {

                                                    table.rows[k].cells[4].innerHTML = `0`;
                                                    table.rows[k].cells[5].innerHTML = `0`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                            }
                                        }
                                        break;
                                    }

                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                        if (table.rows[0].cells[sltg - 1].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let j = 0; j < sltg; j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j + 1); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 1; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let j = 2; j < (sltg - sltglh); j++) {
                                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    for (let k = 0; k < sltg; k++) {
                                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                        table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                        table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                    break;
                                                }
                                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    var coquanhutech = 0;
                                                    for (let g = (j); g < sltg; g++) {
                                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                            coquanhutech += 1;
                                                        }
                                                    }
                                                    if (coquanhutech < 1) {
                                                        for (let k = 0; k < sltg; k++) {
                                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                            } else {
                                                                table.rows[k].cells[6].innerHTML = `0`;
                                                            }
                                                            table.rows[k].cells[7].innerHTML = `0`;
                                                        }
                                                        break;
                                                    }
                                                } else {
                                                    for (let k = 0; k < sltg; k++) {

                                                        table.rows[k].cells[4].innerHTML = `0`;
                                                        table.rows[k].cells[5].innerHTML = `0`;
                                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        } else {
                                                            table.rows[k].cells[6].innerHTML = `0`;
                                                        }
                                                        table.rows[k].cells[7].innerHTML = `0`;
                                                    }
                                                }
                                            }
                                            break;
                                        }

                                    }
                                }
                            }
                        }
                    }
                    if (table.rows[sltg - 1].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[sltg - 1].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                        var hutech = 0;
                        var qt = 0;
                        var ngoai = 0;
                        for (let k = 1; k < sltg; k++) {
                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                hutech += 1;
                            }
                            if (table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                qt += 1;

                            } else {
                                ngoai += 1;
                            }

                        }
                        if (hutech > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `${total / 4 * donggop / 100}`;
                                table.rows[n].cells[5].innerHTML = `${total / 4 * donggop / 100 * 0.9}`;
                                table.rows[n].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        } else if (hutech == 0 && qt > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `${total / 8 * donggop / 100}`;
                                table.rows[n].cells[5].innerHTML = `${total / 8 * donggop / 100 * 0.9}`;
                                table.rows[n].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        } else if (hutech == 0 && qt == 0 && ngoai > 0) {
                            for (let n = 0; n < sltg; n++) {
                                var donggop = document.querySelector('#donggop-' + n).value;
                                table.rows[n].cells[4].innerHTML = `0`;
                                table.rows[n].cells[5].innerHTML = `0`;
                                table.rows[n].cells[6].innerHTML = `0`;
                                table.rows[n].cells[7].innerHTML = `0`;
                            }
                        }
                    }

                }
                ////////////
                else if (sltgc > 2 && sltgp > 0 && sltglh > 0) {
                    var tsltlh = 0;
                    var tglh = 0;
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var coquantgc = table.rows[0].cells[2].textContent;
                        if (coquantgc == "Hutech-Quốc tế (50%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tsltlh += 1;
                                }
                                if (tsltlh > 1 || tsltlh == 1) {
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                break;
                            }
                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)" || table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }
                        }
                        ////////
                        else if (coquantgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquantgc == "Quốc tế - Hutech (0%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 1000}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;

                                break;
                            }

                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            } if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tglh += 1;
                                }
                                if (tglh < 1) {
                                    if (table.rows[i].cells[2].textContent == "Tác giả phụ" && table.rows[i].cells[3].textContent == "Tác giả phụ") {

                                    }
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }

                                break;
                            }

                        }
                        ///////
                        else if (coquantgc == "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }
                else if (sltg == 2 && valuerank != "Nghiên cứu mạnh") {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg) * (donggop / 100)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }
                    }
                }

                else if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }

            ///////////////////
            if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh" && sltgc > 0 && sltglh > 1 && sltgp > 1 && sltg > 4) {
                for (let i = 0; i < sltg; i++) {
                    trtable += `<tr>
                        <td>${i + 1}</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>`;
                }
                table.innerHTML = trtable;
                for (let i = 0; i < sltg; i++) {
                    var tacgia = document.querySelector('#inp-username-id-mail-' + i).value;
                    table.rows[i].cells[1].innerHTML = tacgia;
                }
                for (let i = 0; i < sltg; i++) {
                    var optionscongtac = document.querySelector('#coquancongtac-' + i);
                    var textcongtac = optionscongtac.options[optionscongtac.selectedIndex].textContent;
                    table.rows[i].cells[2].innerHTML = textcongtac;
                } for (let i = 0; i < sltg; i++) {
                    var optionstg = document.querySelector('#tg-' + i);
                    var texttg = optionstg.options[optionstg.selectedIndex].textContent;
                    table.rows[i].cells[3].innerHTML = texttg;
                }
                if (table.rows[0].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                    for (let j = 0; j < sltg; j++) {
                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            for (let k = 0; k < sltg; k++) {
                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                table.rows[k].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[k].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                } else {
                                    table.rows[k].cells[6].innerHTML = `0`;
                                }
                                table.rows[k].cells[7].innerHTML = `0`;
                            }
                            break;
                        }
                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            var coquanhutech = 0;
                            for (let g = (j + 1); g < sltg; g++) {
                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    coquanhutech += 1;
                                }
                            }
                            if (coquanhutech < 1) {
                                for (let k = 0; k < sltg; k++) {
                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                    table.rows[k].cells[4].innerHTML = `${total / 2 / sltglh * donggoptgc / 100}`;
                                    table.rows[k].cells[5].innerHTML = `${total / 2 / sltglh * donggoptgc / 100 * 0.9}`;
                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                    } else {
                                        table.rows[k].cells[6].innerHTML = `0`;
                                    }
                                    table.rows[k].cells[7].innerHTML = `0`;
                                }
                                break;
                            }
                        } else {
                            for (let j = 1; j < (sltg - sltglh); j++) {
                                if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    for (let k = 0; k < sltg; k++) {
                                        var donggoptgc = document.querySelector('#donggop-' + k).value;
                                        table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                        table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                        if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                        } else {
                                            table.rows[k].cells[6].innerHTML = `0`;
                                        }
                                        table.rows[k].cells[7].innerHTML = `0`;
                                    }
                                    break;
                                }
                                if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                    var coquanhutech = 0;
                                    for (let g = (j); g < sltg; g++) {
                                        if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            coquanhutech += 1;
                                        }
                                    }
                                    if (coquanhutech < 1) {
                                        for (let k = 0; k < sltg; k++) {
                                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                                            table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                            table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                            } else {
                                                table.rows[k].cells[6].innerHTML = `0`;
                                            }
                                            table.rows[k].cells[7].innerHTML = `0`;
                                        }
                                        break;
                                    }
                                } else {
                                    for (let j = 2; j < (sltg - sltglh); j++) {
                                        if (table.rows[j].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                            for (let k = 0; k < sltg; k++) {
                                                var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                table.rows[k].cells[4].innerHTML = `${total / 4 * donggoptgc / 100}`;
                                                table.rows[k].cells[5].innerHTML = `${total / 4 * donggoptgc / 100 * 0.9}`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                            break;
                                        }
                                        if (table.rows[j].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                            var coquanhutech = 0;
                                            for (let g = (j); g < sltg; g++) {
                                                if (table.rows[g].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                                    coquanhutech += 1;
                                                }
                                            }
                                            if (coquanhutech < 1) {
                                                for (let k = 0; k < sltg; k++) {
                                                    var donggoptgc = document.querySelector('#donggop-' + k).value;
                                                    table.rows[k].cells[4].innerHTML = `${total / 4 / 2 * donggoptgc / 100}`;
                                                    table.rows[k].cells[5].innerHTML = `${total / 4 / 2 * donggoptgc / 100 * 0.9}`;
                                                    if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                        table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                                                    } else {
                                                        table.rows[k].cells[6].innerHTML = `0`;
                                                    }
                                                    table.rows[k].cells[7].innerHTML = `0`;
                                                }
                                                break;
                                            }
                                        } else {
                                            for (let k = 0; k < sltg; k++) {

                                                table.rows[k].cells[4].innerHTML = `0`;
                                                table.rows[k].cells[5].innerHTML = `0`;
                                                if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                } else {
                                                    table.rows[k].cells[6].innerHTML = `0`;
                                                }
                                                table.rows[k].cells[7].innerHTML = `0`;
                                            }
                                        }
                                    }
                                    break;
                                }

                            }
                        }
                    }
                }
                ////////////
                if (table.rows[0].cells[2].textContent == "Hutech-Quốc tế (50%)") {

                    for (let j = 0; j < sltg; j++) {
                        for (let k = 0; k < sltg; k++) {
                            var donggoptgc = document.querySelector('#donggop-' + k).value;
                            table.rows[k].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                            table.rows[k].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                            if (table.rows[k].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[k].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                table.rows[k].cells[6].innerHTML = `${diem / 2}`;
                            } else {
                                table.rows[k].cells[6].innerHTML = `0`;
                            }
                            table.rows[k].cells[7].innerHTML = `0`;
                        }
                    }
                }

                ////////////
                if (table.rows[0].cells[2].textContent != "Hutech-Quốc tế (50%)" && table.rows[0].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)") {
                    var tglh100 = 0;
                    var tglh50 = 0;
                    var tglh0 = 0;
                    for (let i = (sltg - sltglh); i < sltg; i++) {
                        if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                            tglh100 += 1;
                        } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                            tglh50 += 1;
                        } if (table.rows[i].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[i].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                            tglh0 += 1;
                        }
                    }
                    if (tglh100 > 0) {
                        for (let j = 0; j < sltg; j++) {
                            var donggop = document.querySelector('#donggop-' + j).value;
                            table.rows[j].cells[4].innerHTML = `${total / sltglh * donggop / 100}`;
                            table.rows[j].cells[5].innerHTML = `${total / sltglh * donggop / 100 * 0.9}`;
                            if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                table.rows[j].cells[6].innerHTML = `0`;

                            } else {
                                table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                            }
                            table.rows[j].cells[7].innerHTML = `0`;
                        }
                    } if (tglh50 > 0 && tglh100 == 0) {
                        for (let j = 0; j < sltg; j++) {
                            var donggop = document.querySelector('#donggop-' + j).value;
                            table.rows[j].cells[4].innerHTML = `${total / 2 / sltglh * donggop / 100}`;
                            table.rows[j].cells[5].innerHTML = `${total / 2 / sltglh * donggop / 100 * 0.9}`;
                            if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                table.rows[j].cells[6].innerHTML = `0`;

                            } else {
                                table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                            }
                            table.rows[j].cells[7].innerHTML = `0`;
                        }
                    } if (tglh0 > 0 && tglh100 == 0 && tglh50 == 0) {
                        var tgp100 = 0;
                        var tgp50 = 0;
                        var tgp0 = 0;
                        for (let i = 1; i < (sltg - sltglh); i++) {
                            if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                tgp100 += 1;
                            } if (table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                tgp50 += 1;
                            } if (table.rows[i].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[i].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                tgp0 += 1;
                            }
                        } if (tgp100 > 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `${total * 0.25 * donggop / 100}`;
                                table.rows[j].cells[5].innerHTML = `${total * 0.25 * donggop / 100 * 0.9}`;
                                if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                    table.rows[j].cells[6].innerHTML = `0`;

                                } else {
                                    table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                                }
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        } if (tgp50 == 0 && tglh50 > 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `${total * 0.25 / 2 * donggop / 100}`;
                                table.rows[j].cells[5].innerHTML = `${total * 0.25 / 2 * donggop / 100 * 0.9}`;
                                if (table.rows[j].cells[2].textContent != "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[j].cells[2].textContent != "Hutech-Quốc tế (50%)") {
                                    table.rows[j].cells[6].innerHTML = `0`;

                                } else {
                                    table.rows[j].cells[6].innerHTML = `${diem / 2}`;

                                }
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        } if (tgp0 > 0 && tgp100 == 0 && tgp50 == 0) {
                            for (let j = 0; j < sltg; j++) {
                                var donggop = document.querySelector('#donggop-' + j).value;
                                table.rows[j].cells[4].innerHTML = `0`;
                                table.rows[j].cells[5].innerHTML = `0`;
                                table.rows[j].cells[6].innerHTML = `0`;
                                table.rows[j].cells[7].innerHTML = `0`;
                            }
                        }

                    }

                }
                ////////////
                else if (sltgc > 2 && sltgp > 0 && sltglh > 0) {
                    var tsltlh = 0;
                    var tglh = 0;
                    for (let i = 1; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var coquantgc = table.rows[0].cells[2].textContent;
                        if (coquantgc == "Hutech-Quốc tế (50%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tsltlh += 1;
                                }
                                if (tsltlh > 1 || tsltlh == 1) {
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                                break;
                            }
                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)" || table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            }
                        }
                        ////////
                        else if (coquantgc == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquantgc == "Quốc tế - Hutech (0%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 1000}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;

                                break;
                            }

                            else if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                table.rows[i].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                table.rows[i].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                                for (let j = 1; j < (sltgp + 1); j++) {
                                    var donggop = document.querySelector('#donggop-' + j).value;

                                    if (table.rows[j].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[j].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `0`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[j].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }
                                for (let k = (sltgc + sltgp + 1); k < (sltg + 1); k++) {
                                    var donggop = document.querySelector('#donggop-' + (k - 1)).value;
                                    if (table.rows[k - 1].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[k - 1].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `0`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    } else {
                                        table.rows[k - 1].cells[4].innerHTML = `${total / 2 * donggop / 100}`;
                                        table.rows[k - 1].cells[5].innerHTML = `${total / 2 * donggop / 100 * 0.9}`;
                                        table.rows[k - 1].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[k - 1].cells[7].innerHTML = `0`;
                                    }
                                }
                                var donggoptgc = document.querySelector('#donggop-0').value;
                                table.rows[0].cells[4].innerHTML = `${total / 2 * donggoptgc / 100}`;
                                table.rows[0].cells[5].innerHTML = `${total / 2 * donggoptgc / 100 * 0.9}`;
                                table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[0].cells[7].innerHTML = `0`;
                            } if (table.rows[i].cells[3].textContent == "Tác giả liên hệ" && table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)" || table.rows[i].cells[2].textContent == "Hutech-Quốc tế (50%)") {
                                var donggop = document.querySelector('#donggop-' + i).value;
                                if (table.rows[i].cells[2].textContent == "Cơ quan công tác duy nhất Hutech (100%)") {
                                    tglh += 1;
                                }
                                if (tglh < 1) {
                                    if (table.rows[i].cells[2].textContent == "Tác giả phụ" && table.rows[i].cells[3].textContent == "Tác giả phụ") {

                                    }
                                    for (let j = 0; j < sltg; j++) {
                                        var donggop = document.querySelector('#donggop-' + j).value;
                                        table.rows[j].cells[4].innerHTML = `${total * donggop / 100}`;
                                        table.rows[j].cells[5].innerHTML = `${total * donggop / 100 * 0.9}`;
                                        table.rows[j].cells[6].innerHTML = `${diem / 2}`;
                                        table.rows[j].cells[7].innerHTML = `0`;
                                    }
                                }

                                break;
                            }

                        }
                        ///////
                        else if (coquantgc == "Cơ quan công tác duy nhất Hutech (100%)" && table.rows[0].cells[3].textContent == "Tác giả chính") {
                            document.querySelector('#donggop-0').disabled = false;
                            var donggop = document.querySelector('#donggop-' + i).value;
                            var donggoptgc = document.querySelector('#donggop-0').value;
                            table.rows[0].cells[4].innerHTML = `${total * donggoptgc / 100}`;
                            table.rows[0].cells[5].innerHTML = `${total * donggoptgc / 100 * 0.9}`;
                            table.rows[0].cells[6].innerHTML = `${diem / 2}`;
                            table.rows[0].cells[7].innerHTML = `0`;
                            if (table.rows[i].cells[2].textContent == "Quốc tế - Hutech (0%)" || table.rows[i].cells[2].textContent == "Cơ quan công tác trong nước - ngoài Hutech (0%)") {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else {
                                table.rows[i].cells[4].innerHTML = `${(total) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(total) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }

                    }
                }
                else if (sltg == 2 && valuerank != "Nghiên cứu mạnh") {
                    for (let i = 0; i < sltg; i++) {
                        var coquan = table.rows[i].cells[2].textContent;
                        var donggop = Number(document.querySelector('#donggop-' + i).value);
                        if (sltg == 2) {
                            if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                                table.rows[i].cells[4].innerHTML = `0`;
                                table.rows[i].cells[5].innerHTML = `0`;
                                table.rows[i].cells[6].innerHTML = `0`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } if (coquan == "Hutech-Quốc tế (50%)") {
                                table.rows[i].cells[4].innerHTML = `${((total / 2) / sltg) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${(((total / 2) / sltg) * (donggop / 100)) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            } else if (coquan == "Cơ quan công tác duy nhất Hutech (100%)") {
                                table.rows[i].cells[4].innerHTML = `${(total / 2) * (donggop / 100)}`;
                                table.rows[i].cells[5].innerHTML = `${((total / 2)) * (donggop / 100) * 0.9}`;
                                table.rows[i].cells[6].innerHTML = `${diem / 2}`;
                                table.rows[i].cells[7].innerHTML = `0`;
                            }
                        }
                    }
                }

                else if (sltgc == 1 && sltg == 1) {
                    var coquan = table.rows[0].cells[2].textContent;
                    try {
                        var donggop = Number(document.querySelector('#donggop-0').value);

                    } catch { }

                    if (coquan == "Quốc tế - Hutech (0%)" || coquan == "Cơ quan công tác trong nước - ngoài Hutech (0%)" || coquan == " --Chọn cơ quan công tác--") {
                        table.rows[0].cells[4].innerHTML = `0`;
                        table.rows[0].cells[5].innerHTML = `0`;
                        table.rows[0].cells[6].innerHTML = `0`;
                        table.rows[0].cells[7].innerHTML = `0`;

                    } else if (coquan == "Hutech-Quốc tế (50%)") {
                        table.rows[0].cells[4].innerHTML = `${total / 2}`;
                        table.rows[0].cells[5].innerHTML = `${(total / 2) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    } else {
                        table.rows[0].cells[4].innerHTML = `${total}`;
                        table.rows[0].cells[5].innerHTML = `${(total) * 0.9}`;
                        table.rows[0].cells[6].innerHTML = `${diem}`;
                        table.rows[0].cells[7].innerHTML = `${tietchuan}`;
                    }
                }
            }
            ////////
        }
    }
    // Tìm kiếm tác giả
    function inpsearch(idinput, callback) {
        var valueinp = document.querySelector('#inp-username-id-mail-' + idinput).value;
        if (valueinp == "") {
            document.querySelector('#dl-user-' + idinput).innerHTML = ``;
        }
        fetch("https://localhost:5001/api/NguoiDung/Get-user?input=" + valueinp, {
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            }
        })
            .then(function (response) {

                return response.json();
            })
            .then(callback)
    }
    // Load table clear
    function clear_hinhthuc() {

        var valuerank = _ngach;
        var optionslh = document.querySelector('#loaiHinhKeKhai');
        var valueloaihinh = optionslh.options[optionslh.selectedIndex].textContent;
        if (valuerank.includes("NCV") && valueloaihinh == "Nghiên cứu mạnh") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                        <th width="2%">STT</th>
                        <th width="20%">Mã nhân viên</th>
                        <th width="20%">Cơ quan công tác</th>
                        <th width="10%">Loại tác giả</th>
                        <th width="7%">Đóng góp (%)</th>
                        </thead>

                        <tbody id="addtacgia" onchange="loadtable()">
                        </tbody>`;
            themtacgia();

        }
        if (valuerank.includes("GV") && valueloaihinh == "Nghiên cứu mạnh") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                        <th width="2%">STT</th>
                        <th width="20%">Mã nhân viên</th>
                        <th width="20%">Cơ quan công tác</th>
                        <th width="10%">Loại tác giả</th>
                        <th width="7%">Đóng góp (%)</th>
                        </thead>

                        <tbody id="addtacgia" onchange="loadtable()">
                        </tbody>`;
            themtacgia();

        }
        if (valuerank.includes("GV") && valueloaihinh == "Kê khai khối lượng") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                        <th width="2%">STT</th>
                        <th width="20%">Mã nhân viên</th>
                        <th width="20%">Cơ quan công tác</th>
                        <th width="10%">Loại tác giả</th>
                        </thead>

                        <tbody id="addtacgia" onchange="loadtable()">
                        </tbody>`;
            themtacgia();
        } if (valuerank.includes("GV") && valueloaihinh == "Đề tài") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                        <th width="2%">STT</th>
                        <th width="20%">Mã nhân viên</th>
                        <th width="20%">Cơ quan công tác</th>
                        <th width="10%">Loại tác giả</th>
                        </thead>

                        <tbody id="addtacgia" onchange="loadtable()">
                        </tbody>`;
            themtacgia();

        }
        if (valuerank == "NCV1" && valueloaihinh == "Kê khai khối lượng") {
            document.querySelector('#tbtacgiasl').innerHTML = `<thead style="background-color: #17a2b8;color: white;">
                        <th width="2%">STT</th>
                        <th width="20%">Mã nhân viên</th>
                        <th width="20%">Cơ quan công tác</th>
                        <th width="10%">Loại tác giả</th>
                        </thead>

                        <tbody id="addtacgia" onchange="loadtable()">
                        </tbody>`;
            themtacgia();
        }

    }
    function send(data, a) {
        var linksend = "https://localhost:5001/api/DanhMucXetDuyet/Send";
        var options = {
            method: 'POST',
            headers: {
                'Authorization': 'Bearer ' + _token,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data),
        };
        fetch(linksend, options)
            .then(response => {
                if (response.ok) {
                    alert('Đăng ký thành công');
                    if (a == "lvtm") {

                    } else if (a == "lvt") {
                        window.location.href = '/NguoiDung/DeTai';
                    }        
                } else if(response.status==400) {
					
					alert('Trùng tên bài báo');
				} else{
				
                    alert('Có lỗi');
                }
            });
    }
    function groupUser() {
        var table = document.getElementById("tbtacgia2");
        var groupUser = "";

        for (let i = 1; i < table.rows.length; i++) {
            const row = table.rows[i];

            for (let j = 0; j < row.cells.length; j++) {
                const cell = row.cells[j];
                groupUser += cell.textContent + ";";
            }

            groupUser = groupUser.slice(0, -1);
            groupUser += "$";
        }
        groupUser = groupUser.slice(0, -1);
        return groupUser;
    }

    
    function handleSend(a) {
        var soDOI = document.getElementById("sodoi").value;
        var textElement = document.getElementById("myFile").value;
        var minhchung = textElement;
        var sltgc = Number(document.querySelector('#sltgc').value);
        var sltgp = Number(document.querySelector('#sltgp').value);
        var sltglh = Number(document.querySelector('#sltglh').value);
        var sltg = sltgc + sltgp + sltglh;
        var date = document.querySelector('#datesubmit').value;
        var valuerank = _ngach;
        var valuetenbaibao = document.querySelector('#tenSanPhamKHCN').value;
        try {
            var valuecategory = document.querySelector('input[id="category-1"]:checked').value;
        } catch
        {
            try {
                var valuecategory = document.querySelector('input[name="category"]:checked').value;
            }
            catch {
                var valuecategory = document.querySelector('input[name="yc"]:checked').value;          
            }
        }
        try { var valuelbname = document.querySelector('#lbname').textContent; } catch { var valuelbname = "" }
        try { var valuelbissn = document.querySelector('#lbissn').textContent; } catch { var valuelbissn = "" }
        var total = document.querySelector('#totaltien').textContent;
        try { var valuelbeissn = document.querySelector('#lbeissn').textContent; } catch { var valuelbeissn = "" }
        var tg = groupUser();
        var data = {

            journal_name: valuelbname,
            issn: valuelbissn,
            eissn: valuelbeissn,
            category: valuecategory,
            citations: "",
            if_2022: "",
            jci: "",
            percentageOAGold: "",
            userId: _idUser,
            rank: valuerank,
            imageTenBB: "",
            image: minhchung,
            link: soDOI,
            tenBaiBao: valuetenbaibao,
            type: valuecategory,
            groupUser: tg,
            status: "Đang đợi duyệt",
            quantity: sltg.toString(),
            total: total,
            ghiChu: "",
            dateSubmit: date
        }
        send(data, a);
    }
	var userId = _idUser;
function cleanFileName(fileName) {
    // Các kí tự đặc biệt không được phép trong tên file
    var forbiddenChars = /[/\\?%*:|"<>~,]/g;

    // Thay thế các kí tự đặc biệt bằng kí tự rỗng
    var cleanedFileName = fileName.replace(forbiddenChars, '');

    return cleanedFileName;
}
function BrowseServer(field) {
    var finder = new CKFinder();
    finder.selectActionFunction = function (fileUrl) {
        var valuetenbaibao = document.querySelector('#tenSanPhamKHCN').value;
        var cleanedFileName = cleanFileName(valuetenbaibao);
        var userDirectory = "/Uploads/" + userId + "/" + cleanedFileName + "/";
        var fileUrlWithUserDir = userDirectory + fileUrl.substring(fileUrl.lastIndexOf("/") + 1);
        var currentValue = document.getElementById(field).value;
        var decodedFileUrl = decodeURIComponent(fileUrlWithUserDir).replace(/\%20/g, ' ');

        var selectedFiles = currentValue.split(','); // Chuyển giá trị hiện tại thành mảng các đường dẫn đã chọn
        console.log(selectedFiles);
        console.log(decodedFileUrl);

        // Kiểm tra xem đường dẫn đã tồn tại trong mảng hay chưa
        if (selectedFiles.includes(decodedFileUrl)) {
            alert("Minh chứng đã tồn tại!");
            return;
        }

        // Kiểm tra nếu trường giá trị hiện tại đã có giá trị
        if (currentValue.length > 0) {
            // Thêm dấu phẩy và đường dẫn mới vào giá trị hiện tại
            document.getElementById(field).value = currentValue + ',' + decodedFileUrl;
        } else {
            // Trường giá trị hiện tại chưa có giá trị, gán đường dẫn mới trực tiếp
            document.getElementById(field).value = decodedFileUrl;
        }

        // Gửi đường dẫn tệp tin và userId lên server để lưu trữ
        SaveFile(fileUrl, userId, cleanedFileName);
    };
    finder.popup();
}


function SaveFile(fileUrl, userId, valuetenbaibao) {
    var data = {
        fileUrl: fileUrl,
        userId: userId,
        valuetenbaibao: valuetenbaibao,
    };

    $.ajax({
        url: '/Article/SaveFile',
        type: 'POST',
        data: JSON.stringify(data),
        contentType: 'application/json',
        success: function (result) {
            if (result.success) {
                // Xử lý khi lưu trữ tệp tin thành công
                alert('Cập nhập minh chứng thành công.');
            } else {
                // Xử lý khi lưu trữ tệp tin thất bại
                alert('Cập nhập minh chứng thất bại.');
            }
        },
        error: function () {
            // Xử lý khi có lỗi xảy ra
            alert('Đã xảy ra lỗi khi gửi yêu cầu lưu trữ tệp tin.');
        }
    });
}
</script>